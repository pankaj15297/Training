Database Assignment:

Questions
1. The following relations keep track of airline flight information:

Flights(flno: integer, from: string, to: string, distance: integer, departs:time,arrives: time, price: integer)

Aircraft(aid: integer, aname: string, cruisingrange: integer)

Certified(eid: integer, aid: integer)

Employees(eid: integer, ename: string, salary: integer)


Note that the Employees relation describes pilots and other kinds of employeesaswell; every pilot is certified for some aircraft, and only pilots are certified tofly.Write each of the following queries in SQL.


a. Find the names of aircraft such that all pilots certified to operate them earnmore than $80,000.

b. For each pilot who is certified for more than three aircraft, find the eid and themaximum cruisingrange of the aircraft for which she or he is certified.

c. Find the names of pilots whose salary is less than the price of the cheapestroute from Los Angeles to Honolulu.

d. For all aircraft with cruisingrange over 1000 miles, find the name of theaircraft and the average salary of all pilots certified for this aircraft.

e. Find the names of pilots certified for some Boeing aircraft.

f. Find the aids of all aircraft that can be used on routes from Los Angeles toChicago.

g. Identify the routes that can be piloted by every pilot who makes more than$100,000.

h. Print the enames of pilots who can operate planes with cruisingrange greaterthan 3000 miles but are not certified on any Boeing aircraft.

i. A customer wants to travel from Madison to New York with no more than twochanges of flight. List the choice of departure times from Madison if thecustomer wants to arrive in New York by 6 p.m.

j. Compute the difference between the average salary of a pilot and the averagesalary of all employees (including pilots).

k. Print the name and salary of every nonpilot whose salary is more than theaverage salary for pilots.

l. Print the names of employees who are certified only on aircrafts with cruisingrange longer than 1000 miles.

m. Print the names of employees who are certified only on aircrafts with cruisingrange longer than 1000 miles, but on at least two such aircrafts.

n. Print the names of employees who are certified only on aircrafts with cruisingrange longer than 1000 miles and who are certified on some Boeing aircraft.



==========================================================================================


CREATE TABLE Flights(flno INT PRIMARY KEY, "from" VARCHAR NOT NULL, "to" VARCHAR NOT NULL, distance INT NOT NULL, departs TIME NOT NULL, arrives TIME NOT NULL, price INT NOT NULL);
CREATE TABLE

\d Flights;


            Table "public.flights"
  Column  |          Type          | Modifiers 
----------+------------------------+-----------
 flno     | integer                | not null
 from     | character varying      | not null
 to       | character varying      | not null
 distance | integer                | not null
 departs  | time without time zone | not null
 arrives  | time without time zone | not null
 price    | integer                | not null
Indexes:
    "flights_pkey" PRIMARY KEY, btree (flno)





CREATE TABLE Employees (eid INT PRIMARY KEY, ename VARCHAR NOT NULL, salary INT NOT NULL);
CREATE TABLE

\d Employees;


        Table "public.employees"
 Column |       Type        | Modifiers 
--------+-------------------+-----------
 eid    | integer           | not null
 ename  | character varying | not null
 salary | integer           | not null
Indexes:
    "employees_pkey" PRIMARY KEY, btree (eid)
Referenced by:
    TABLE "certified" CONSTRAINT "certified_eid_fkey" FOREIGN KEY (eid) REFERENCES employees(eid)





CREATE TABLE Aircraft(aid INT PRIMARY KEY, aname VARCHAR NOT NULL, cruisingrange INT NOT NULL);
CREATE TABLE


\d Aircraft;


            Table "public.aircraft"
    Column     |       Type        | Modifiers 
---------------+-------------------+-----------
 aid           | integer           | not null
 aname         | character varying | not null
 cruisingrange | integer           | not null
Indexes:
    "aircraft_pkey" PRIMARY KEY, btree (aid)





CREATE TABLE Certified (eid INT, aid INT, FOREIGN KEY(eid) REFERENCES Employees(eid), FOREIGN KEY(aid) REFERENCES Aircraft(aid));
CREATE TABLE

\d Certified;


   Table "public.certified"
 Column |  Type   | Modifiers 
--------+---------+-----------
 eid    | integer | 
 aid    | integer | 
Foreign-key constraints:
    "certified_aid_fkey" FOREIGN KEY (aid) REFERENCES aircraft(aid)
    "certified_eid_fkey" FOREIGN KEY (eid) REFERENCES employees(eid)






SELECT * FROM Flights;

 flno  |  from  |     to     | distance | departs  | arrives  | price 
-------+--------+------------+----------+----------+----------+-------
 20001 | Delhi  | Mumbai     |     1700 | 01:10:00 | 02:50:00 |  5000
 20002 | Delhi  | Patna      |     1000 | 05:10:00 | 05:55:00 |  3000
 20003 | Patna  | Banglore   |     3000 | 09:30:00 | 12:00:00 |  7000
 20004 | Patna  | Chandigarh |     1200 | 06:30:00 | 08:00:00 |  2500
 20005 | Delhi  | Chandigarh |      300 | 01:30:00 | 02:00:00 |  2000
 20006 | Delhi  | London     |    30000 | 01:30:00 | 12:00:00 | 75000
 20007 | Delhi  | New Yark   |    30000 | 01:30:00 | 12:00:00 | 75000
 20008 | London | New Yark   |    30000 | 01:30:00 | 12:00:00 | 75000
(8 rows)



SELECT * FROM Employees;

 eid  |  ename   | salary 
------+----------+--------
  101 | Pankaj   | 100000
  102 | Pavan    |  10000
  103 | Chhavi   |  80000
  104 | Saurabh  |  70000
  105 | Ashutosh |  65000
  106 | Aman     |  95000
  107 | Moti     |  55000
  108 | Ramesh   |  80000
  109 | Bharti   |  40000
 1010 | Naveen   |  80000
 1011 | Praveen  |  80000
 1012 | Sager    |  85000
 1013 | Raju     |  56000
 1014 | Ashutosh |  65000
 1015 | Ashu     |  36000
 1016 | Manish   |  75000
 1017 | Aders    |  45000
(17 rows)



SELECT * FROM Aircraft;

  aid  |      aname      | cruisingrange 
-------+-----------------+---------------
 50001 | GoAir           |          5000
 50002 | IndiGo          |         10000
 50003 | SpiceJet        |         20000
 50004 | Vistara         |         15000
 50005 | Star Air        |         15000
 50006 | TruJet          |         12000
 50007 | Zoom AIr        |          5000
 50008 | Pawan Hans      |           500
 50009 | Deccan Charters |           900
(9 rows)



SELECT * FROM Certified;

 eid  |  aid  
------+-------
  101 | 50001
  101 | 50002
  101 | 50003
  101 | 50004
  101 | 50005
  101 | 50006
  101 | 50007
  101 | 50003
  102 | 50003
  103 | 50003
  104 | 50003
  105 | 50003
  106 | 50003
  107 | 50003
  108 | 50003
  109 | 50003
 1010 | 50003
 1011 | 50003
 1012 | 50003
 1013 | 50003
 1010 | 50002
  108 | 50002
  108 | 50006
  108 | 50005
(24 rows)





======================================Answer======================================




a) SELECT DISTINCT A.aname FROM Aircraft A WHERE A.aid IN (SELECT C.aid FROM Certified C, Employees E WHERE C.eid = E.eid AND NOT EXISTS ( SELECT * FROM Employees E1 WHERE E1.eid = E.eid AND E1.salary < 80000 ));

  aname   
----------
 SpiceJet
 Zoom AIr
 Vistara
 TruJet
 Star Air
 GoAir
 IndiGo
(7 rows)


b) SELECT C.eid, MAX (A.cruisingrange) FROM Certified C, Aircraft A WHERE C.aid = A.aid GROUP BY C.eid HAVING COUNT (*) > 3;

 eid |  max  
-----+-------
 101 | 20000
 108 | 20000
(2 rows)


c) SELECT DISTINCT E.ename FROM Employees E WHERE E.salary < ( SELECT MIN (F.price) FROM Flights F WHERE F.from = 'Delhi' AND F.to = 'London' );

  ename   
----------
 Raju
 Pavan
 Saurabh
 Moti
 Ashu
 Ashutosh
 Aders
 Bharti
(8 rows)


e) SELECT DISTINCT E.ename FROM Employees E, Certified C, Aircraft A WHERE E.eid = C.eid AND C.aid = A.aid AND A.aname LIKE 'Vis%';

 ename  
--------
 Pankaj
(1 row)


f) SELECT A.aid FROM Aircraft A WHERE A.cruisingrange > ( SELECT MIN (F.distance) FROM Flights F WHERE F.from = 'Patna' AND F.to = 'Chandigarh' );

  aid  
-------
 50001
 50002
 50003
 50004
 50005
 50006
 50007
(7 rows)




