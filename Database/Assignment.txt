Database Assignment:

Questions
1. The following relations keep track of airline flight information:

Flights(flno: integer, from: string, to: string, distance: integer, departs:time,arrives: time, price: integer)

Aircraft(aid: integer, aname: string, cruisingrange: integer)

Certified(eid: integer, aid: integer)

Employees(eid: integer, ename: string, salary: integer)


Note that the Employees relation describes pilots and other kinds of employeesaswell; every pilot is certified for some aircraft, and only pilots are certified tofly.Write each of the following queries in SQL.


a. Find the names of aircraft such that all pilots certified to operate them earnmore than $80,000.

b. For each pilot who is certified for more than three aircraft, find the eid and themaximum cruisingrange of the aircraft for which she or he is certified.

c. Find the names of pilots whose salary is less than the price of the cheapestroute from Los Angeles to Honolulu.

d. For all aircraft with cruisingrange over 1000 miles, find the name of theaircraft and the average salary of all pilots certified for this aircraft.

e. Find the names of pilots certified for some Boeing aircraft.

f. Find the aids of all aircraft that can be used on routes from Los Angeles toChicago.

g. Identify the routes that can be piloted by every pilot who makes more than$100,000.

h. Print the enames of pilots who can operate planes with cruisingrange greaterthan 3000 miles but are not certified on any Boeing aircraft.

i. A customer wants to travel from Madison to New York with no more than twochanges of flight. List the choice of departure times from Madison if thecustomer wants to arrive in New York by 6 p.m.

j. Compute the difference between the average salary of a pilot and the averagesalary of all employees (including pilots).

k. Print the name and salary of every nonpilot whose salary is more than theaverage salary for pilots.

l. Print the names of employees who are certified only on aircrafts with cruisingrange longer than 1000 miles.

m. Print the names of employees who are certified only on aircrafts with cruisingrange longer than 1000 miles, but on at least two such aircrafts.

n. Print the names of employees who are certified only on aircrafts with cruisingrange longer than 1000 miles and who are certified on some Boeing aircraft.



==========================================================================================


CREATE TABLE Flights(flno INT PRIMARY KEY, "from" VARCHAR NOT NULL, "to" VARCHAR NOT NULL, distance INT NOT NULL, departs TIME NOT NULL, arrives TIME NOT NULL, price INT NOT NULL);
CREATE TABLE

\d Flights;


            Table "public.flights"
  Column  |          Type          | Modifiers 
----------+------------------------+-----------
 flno     | integer                | not null
 from     | character varying      | not null
 to       | character varying      | not null
 distance | integer                | not null
 departs  | time without time zone | not null
 arrives  | time without time zone | not null
 price    | integer                | not null
Indexes:
    "flights_pkey" PRIMARY KEY, btree (flno)





CREATE TABLE Employees (eid INT PRIMARY KEY, ename VARCHAR NOT NULL, salary INT NOT NULL);
CREATE TABLE

\d Employees;


        Table "public.employees"
 Column |       Type        | Modifiers 
--------+-------------------+-----------
 eid    | integer           | not null
 ename  | character varying | not null
 salary | integer           | not null
Indexes:
    "employees_pkey" PRIMARY KEY, btree (eid)
Referenced by:
    TABLE "certified" CONSTRAINT "certified_eid_fkey" FOREIGN KEY (eid) REFERENCES employees(eid)





CREATE TABLE Aircraft(aid INT PRIMARY KEY, aname VARCHAR NOT NULL, cruisingrange INT NOT NULL);
CREATE TABLE


\d Aircraft;


            Table "public.aircraft"
    Column     |       Type        | Modifiers 
---------------+-------------------+-----------
 aid           | integer           | not null
 aname         | character varying | not null
 cruisingrange | integer           | not null
Indexes:
    "aircraft_pkey" PRIMARY KEY, btree (aid)





CREATE TABLE Certified (eid INT, aid INT, FOREIGN KEY(eid) REFERENCES Employees(eid), FOREIGN KEY(aid) REFERENCES Aircraft(aid));
CREATE TABLE

\d Certified;


   Table "public.certified"
 Column |  Type   | Modifiers 
--------+---------+-----------
 eid    | integer | 
 aid    | integer | 
Foreign-key constraints:
    "certified_aid_fkey" FOREIGN KEY (aid) REFERENCES aircraft(aid)
    "certified_eid_fkey" FOREIGN KEY (eid) REFERENCES employees(eid)






SELECT * FROM Flights;

 flno  |  from  |     to     | distance | departs  | arrives  | price 
-------+--------+------------+----------+----------+----------+-------
 20001 | Delhi  | Mumbai     |     1700 | 01:10:00 | 02:50:00 |  5000
 20002 | Delhi  | Patna      |     1000 | 05:10:00 | 05:55:00 |  3000
 20003 | Patna  | Banglore   |     3000 | 09:30:00 | 12:00:00 |  7000
 20004 | Patna  | Chandigarh |     1200 | 06:30:00 | 08:00:00 |  2500
 20005 | Delhi  | Chandigarh |      300 | 01:30:00 | 02:00:00 |  2000
 20006 | Delhi  | London     |    30000 | 01:30:00 | 12:00:00 | 75000
 20007 | Delhi  | New Yark   |    30000 | 01:30:00 | 12:00:00 | 75000
 20008 | London | New Yark   |    30000 | 01:30:00 | 12:00:00 | 75000
(8 rows)



SELECT * FROM Employees;

 eid  |  ename   | salary 
------+----------+--------
  101 | Pankaj   | 100000
  102 | Pavan    |  10000
  103 | Chhavi   |  80000
  104 | Saurabh  |  70000
  105 | Ashutosh |  65000
  106 | Aman     |  95000
  107 | Moti     |  55000
  108 | Ramesh   |  80000
  109 | Bharti   |  40000
 1010 | Naveen   |  80000
 1011 | Praveen  |  80000
 1012 | Sager    |  85000
 1013 | Raju     |  56000
 1014 | Ashutosh |  65000
 1015 | Ashu     |  36000
 1016 | Manish   |  75000
 1017 | Aders    |  45000
(17 rows)



SELECT * FROM Aircraft;

  aid  |      aname      | cruisingrange 
-------+-----------------+---------------
 50001 | GoAir           |          5000
 50002 | IndiGo          |         10000
 50003 | SpiceJet        |         20000
 50004 | Vistara         |         15000
 50005 | Star Air        |         15000
 50006 | TruJet          |         12000
 50007 | Zoom AIr        |          5000
 50008 | Pawan Hans      |           500
 50009 | Deccan Charters |           900
(9 rows)



SELECT * FROM Certified;

 eid  |  aid  
------+-------
  101 | 50001
  101 | 50002
  101 | 50003
  101 | 50004
  101 | 50005
  101 | 50006
  101 | 50007
  101 | 50003
  102 | 50003
  103 | 50003
  104 | 50003
  105 | 50003
  106 | 50003
  107 | 50003
  108 | 50003
  109 | 50003
 1010 | 50003
 1011 | 50003
 1012 | 50003
 1013 | 50003
 1010 | 50002
  108 | 50002
  108 | 50006
  108 | 50005
(24 rows)





======================================Answer======================================




a) SELECT DISTINCT A.aname FROM Aircraft A WHERE A.aid IN (SELECT C.aid FROM Certified C, Employees E WHERE C.eid = E.eid AND NOT EXISTS ( SELECT * FROM Employees E1 WHERE E1.eid = E.eid AND E1.salary < 80000 ));

									OR

SELECT DISTINCT A.aname FROM Aircraft A JOIN Certified C ON A.aid = C.aid JOIN Employees E ON C.eid = E.eid WHERE E.salary > 80000;


  aname   
----------
 SpiceJet
 Zoom AIr
 Vistara
 TruJet
 Star Air
 GoAir
 IndiGo
(7 rows)


b) SELECT C.eid, MAX (A.cruisingrange) FROM Certified C, Aircraft A WHERE C.aid = A.aid GROUP BY C.eid HAVING COUNT (*) > 3;

									OR

SELECT C.eid, MAX(A.cruisingrange) FROM Aircraft A JOIN Certified C ON A.aid = C.aid JOIN Employees E ON C.eid = E.eid GROUP BY C.eid HAVING COUNT(C.eid) > 3;


 eid |  max  
-----+-------
 101 | 20000
 108 | 20000
(2 rows)


c) SELECT DISTINCT E.ename FROM Employees E WHERE E.salary < ( SELECT MIN (F.price) FROM Flights F WHERE F.from = 'Delhi' AND F.to = 'London' );

										OR

SELECT DISTINCT E.ename FROM Employees E WHERE E.salary < ( SELECT MIN (F.price) FROM Flights F WHERE F.from = 'Delhi' AND F.to = 'London' );


  ename   
----------
 Raju
 Pavan
 Saurabh
 Moti
 Ashu
 Ashutosh
 Aders
 Bharti
(8 rows)



d) SELECT A.aname, AVG(E.salary) FROM Employees E JOIN Certified C ON E.eid = C.eid JOIN Aircraft A ON C.aid = A.aid WHERE A.cruisingrange > 1000 GROUP BY A.aname;


  aname   |         avg         
----------+---------------------
 SpiceJet |  71142.857142857143
 IndiGo   |  86666.666666666667
 Zoom AIr | 100000.000000000000
 Vistara  | 100000.000000000000
 TruJet   |  90000.000000000000
 Star Air |  90000.000000000000
 GoAir    | 100000.000000000000
(7 rows)




e) SELECT DISTINCT E.ename FROM Employees E, Certified C, Aircraft A WHERE E.eid = C.eid AND C.aid = A.aid AND A.aname LIKE 'Vistara%';

										OR

SELECT DISTINCT E.ename FROM Employees E JOIN Certified C ON E.eid = C.eid JOIN Aircraft A ON C.aid = A.aid WHERE A.aname LIKE 'Vistara%';


 ename  
--------
 Pankaj
(1 row)


f) SELECT A.aid FROM Aircraft A WHERE A.cruisingrange > ( SELECT MIN (F.distance) FROM Flights F WHERE F.from = 'Patna' AND F.to = 'Chandigarh' );

  aid  
-------
 50001
 50002
 50003
 50004
 50005
 50006
 50007
(7 rows)



i) SELECT departs FROM Flights WHERE "from" IN (SELECT "from" FROM Flights WHERE "to" IN 
(SELECT "from" FROM Flights WHERE "to" = 'New Yark')) AND arrives < '18:00:00';

											OR

SELECT departs FROM Flights WHERE "from" = ANY (SELECT "from" FROM Flights 
WHERE "to" = ANY (SELECT "from" FROM Flights WHERE "to" = 'New Yark')) 
AND arrives < '18:00:00';											

 departs  
----------
 01:10:00
 05:10:00
 01:30:00
 01:30:00
 01:30:00
(5 rows)



j) SELECT(SELECT AVG(salary) FROM Employees WHERE eid IN (SELECT DISTINCT eid FROM Certified))-(SELECT AVG(salary) FROM Employees) AS diff;


       diff        
-------------------
 3217.194570135747
(1 row)


										OR

SELECT(SELECT AVG(salary) FROM Employees)-(SELECT AVG(salary) FROM Employees WHERE eid 
IN (SELECT DISTINCT eid FROM Certified)) AS diff;

        diff        
--------------------
 -3217.194570135747



k) SELECT ename, salary FROM Employees WHERE salary > (SELECT AVG(salary) FROM Employees WHERE eid IN (SELECT DISTINCT eid FROM Certified)) AND eid NOT IN (SELECT DISTINCT eid FROM Certified);

 ename  | salary 
--------+--------
 Manish |  75000
(1 row)




l) SELECT DISTINCT E.ename FROM Employees E, Certified C, Aircraft A WHERE C.aid = A.aid AND E.eid = C.eid GROUP BY E.eid, E.ename HAVING EVERY (A.cruisingrange > 1000) ;

										OR

SELECT DISTINCT E.ename FROM Employees E JOIN Certified C ON E.eid = C.eid  JOIN Aircraft A ON C.aid = A.aid WHERE cruisingrange > 1000;


  ename   
----------
 Naveen
 Pavan
 Raju
 Ashutosh
 Aman
 Bharti
 Saurabh
 Ramesh
 Chhavi
 Pankaj
 Moti
 Sager
 Praveen
(13 rows)


m) SELECT E.ename FROM Employees E, Certified C, Aircraft A WHERE C.aid = A.aid AND 
E.eid = C.eid GROUP BY E.eid, E.ename HAVING EVERY (A.cruisingrange > 1000) AND 
COUNT (*) > 1;

										OR

SELECT E.ename FROM Employees E JOIN Certified C ON E.eid = C.eid JOIN Aircraft A 
ON C.aid = A.aid GROUP BY E.ename, E.eid HAVING EVERY (cruisingrange > 1000) AND 
COUNT(a.aid) > 1;

                                        OR

SELECT E.ename FROM Employees E JOIN Certified C ON E.eid = C.eid JOIN Aircraft A 
ON C.aid = A.aid WHERE cruisingrange > 1000 GROUP BY E.ename HAVING 
COUNT(a.aid) > 1;                                        


 ename  
--------
 Naveen
 Ramesh
 Pankaj
(3 rows)



n) SELECT E.ename FROM Employees E JOIN Certified C ON E.eid = C.eid JOIN Aircraft A 
ON C.aid = A.aid WHERE cruisingrange > 1000 AND A.aname LIKE 'Vistara%';


 ename  
--------
 Pankaj
(1 row)

































====================================================================================




beryl@beryl-Latitude-E5520:~/Training/Ruby$ cd 
beryl@beryl-Latitude-E5520:~$ su postgres
Password: 
su: Authentication failure
beryl@beryl-Latitude-E5520:~$ su postgres
Password: 
postgres@beryl-Latitude-E5520:/home/beryl$ psql fly
Password: 
psql (9.5.19)
Type "help" for help.

fly=# Select * from customers join order;
ERROR:  syntax error at or near "order"
LINE 1: Select * from customers join order;
                                     ^
fly=# Select * from customers join orders;
ERROR:  syntax error at or near ";"
LINE 1: Select * from customers join orders;
                                           ^
fly=# Select * from customers join orders on ;
ERROR:  syntax error at or near ";"
LINE 1: Select * from customers join orders on ;
                                               ^
fly=# \c Store
You are now connected to database "Store" as user "postgres".
Store=# SELECT customerid, unit, productid, fname, name FROM customer INNER JOIN products ON customerid = unit;
ERROR:  relation "customer" does not exist
LINE 1: ...ECT customerid, unit, productid, fname, name FROM customer I...
                                                             ^
Store=# SELECT customerid, unit, productid, fname, name FROM customers INNER JOIN products ON customerid = unit;
 customerid | unit | productid | fname  |  name  
------------+------+-----------+--------+--------
          2 |    2 |         1 | Pavan  | Mobile
          2 |    2 |         2 | Pavan  | Laptop
          5 |    5 |         3 | Naveen | Laptop
         10 |   10 |         4 | Sager  | Mobile
         10 |   10 |         5 | Sager  | shoe
          2 |    2 |         8 | Pavan  | Pen
(6 rows)

Store=# 
Store=# SELECT customerid, unit, productid, fname, name FROM customer JOIN products;
ERROR:  syntax error at or near ";"
LINE 1: ...d, unit, productid, fname, name FROM customer JOIN products;
                                                                      ^
Store=# SELECT customerid, unit, productid, fname, name FROM customer JOIN products;
ERROR:  syntax error at or near ";"
LINE 1: ...d, unit, productid, fname, name FROM customer JOIN products;
                                                                      ^
Store=# SELECT customerid, count(unit), productid, fname, name FROM customer INNER JOIN products ON customerid = unit;
ERROR:  relation "customer" does not exist
LINE 1: ...tomerid, count(unit), productid, fname, name FROM customer I...
                                                             ^
Store=# \d
               List of relations
 Schema |      Name      |   Type   |  Owner   
--------+----------------+----------+----------
 public | comp           | table    | postgres
 public | company        | table    | postgres
 public | company_id_seq | sequence | postgres
 public | customers      | table    | postgres
 public | orderproducts  | table    | postgres
 public | orders         | table    | postgres
 public | products       | table    | postgres
(7 rows)

Store=# SELECT customerid, count(unit), productid, fname, name FROM customers INNER JOIN products ON customerid = unit;
ERROR:  column "customers.customerid" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: SELECT customerid, count(unit), productid, fname, name FROM ...
               ^
Store=# \c fly
You are now connected to database "fly" as user "postgres".
fly=# 
fly=# 
fly=# \d
           List of relations
 Schema |   Name    | Type  |  Owner   
--------+-----------+-------+----------
 public | aircraft  | table | postgres
 public | certified | table | postgres
 public | employees | table | postgres
 public | flights   | table | postgres
(4 rows)

fly=# \d aircraft;
            Table "public.aircraft"
    Column     |       Type        | Modifiers 
---------------+-------------------+-----------
 aid           | integer           | not null
 aname         | character varying | not null
 cruisingrange | integer           | not null
Indexes:
    "aircraft_pkey" PRIMARY KEY, btree (aid)
Referenced by:
    TABLE "certified" CONSTRAINT "certified_aid_fkey" FOREIGN KEY (aid) REFERENCES aircraft(aid)

fly=# \d certified;
   Table "public.certified"
 Column |  Type   | Modifiers 
--------+---------+-----------
 eid    | integer | 
 aid    | integer | 
Foreign-key constraints:
    "certified_aid_fkey" FOREIGN KEY (aid) REFERENCES aircraft(aid)
    "certified_eid_fkey" FOREIGN KEY (eid) REFERENCES employees(eid)

fly=# \d employees;
        Table "public.employees"
 Column |       Type        | Modifiers 
--------+-------------------+-----------
 eid    | integer           | not null
 ename  | character varying | not null
 salary | integer           | not null
Indexes:
    "employees_pkey" PRIMARY KEY, btree (eid)
Referenced by:
    TABLE "certified" CONSTRAINT "certified_eid_fkey" FOREIGN KEY (eid) REFERENCES employees(eid)

fly=# \d flights;
            Table "public.flights"
  Column  |          Type          | Modifiers 
----------+------------------------+-----------
 flno     | integer                | not null
 from     | character varying      | not null
 to       | character varying      | not null
 distance | integer                | not null
 departs  | time without time zone | not null
 arrives  | time without time zone | not null
 price    | integer                | not null
Indexes:
    "flights_pkey" PRIMARY KEY, btree (flno)

fly=# 
fly=# 
fly=# 
fly=# 
fly=# SELECT * FROM Employees;
 eid  |  ename   | salary 
------+----------+--------
  101 | Pankaj   | 100000
  102 | Pavan    |  10000
  103 | Chhavi   |  80000
  104 | Saurabh  |  70000
  105 | Ashutosh |  65000
  106 | Aman     |  95000
  107 | Moti     |  55000
  108 | Ramesh   |  80000
  109 | Bharti   |  40000
 1010 | Naveen   |  80000
 1011 | Praveen  |  80000
 1012 | Sager    |  85000
 1013 | Raju     |  56000
 1014 | Ashutosh |  65000
 1015 | Ashu     |  36000
 1016 | Manish   |  75000
 1017 | Aders    |  45000
(17 rows)

fly=# SELECT * FROM certified;
 eid  |  aid  
------+-------
  101 | 50001
  101 | 50002
  101 | 50003
  101 | 50004
  101 | 50005
  101 | 50006
  101 | 50007
  101 | 50003
  102 | 50003
  103 | 50003
  104 | 50003
  105 | 50003
  106 | 50003
  107 | 50003
  108 | 50003
  109 | 50003
 1010 | 50003
 1011 | 50003
 1012 | 50003
 1013 | 50003
 1010 | 50002
  108 | 50002
  108 | 50006
  108 | 50005
(24 rows)

fly=# SELECT * FROM aircraft;
  aid  |      aname      | cruisingrange 
-------+-----------------+---------------
 50001 | GoAir           |          5000
 50002 | IndiGo          |         10000
 50003 | SpiceJet        |         20000
 50004 | Vistara         |         15000
 50005 | Star Air        |         15000
 50006 | TruJet          |         12000
 50007 | Zoom AIr        |          5000
 50008 | Pawan Hans      |           500
 50009 | Deccan Charters |           900
(9 rows)

fly=# SELECT * FROM flights;
 flno  |  from  |     to     | distance | departs  | arrives  | price 
-------+--------+------------+----------+----------+----------+-------
 20001 | Delhi  | Mumbai     |     1700 | 01:10:00 | 02:50:00 |  5000
 20002 | Delhi  | Patna      |     1000 | 05:10:00 | 05:55:00 |  3000
 20003 | Patna  | Banglore   |     3000 | 09:30:00 | 12:00:00 |  7000
 20004 | Patna  | Chandigarh |     1200 | 06:30:00 | 08:00:00 |  2500
 20005 | Delhi  | Chandigarh |      300 | 01:30:00 | 02:00:00 |  2000
 20006 | Delhi  | London     |    30000 | 01:30:00 | 12:00:00 | 75000
 20007 | Delhi  | New Yark   |    30000 | 01:30:00 | 12:00:00 | 75000
 20008 | London | New Yark   |    30000 | 01:30:00 | 12:00:00 | 75000
(8 rows)

fly=# SELECT aname FROM Aircraft A JOIN Certified C;
ERROR:  syntax error at or near ";"
LINE 1: SELECT aname FROM Aircraft A JOIN Certified C;
                                                     ^
fly=# SELECT aname FROM Aircraft A JOIN Certified C ON A.aid = C.aid;
  aname   
----------
 GoAir
 IndiGo
 SpiceJet
 Vistara
 Star Air
 TruJet
 Zoom AIr
 SpiceJet
 SpiceJet
 SpiceJet
 SpiceJet
 SpiceJet
 SpiceJet
 SpiceJet
 SpiceJet
 SpiceJet
 SpiceJet
 SpiceJet
 SpiceJet
 SpiceJet
 IndiGo
 IndiGo
 TruJet
 Star Air
(24 rows)

fly=# SELECT aname,COUNT(C.eid) FROM Aircraft A JOIN Certified C ON A.aid = C.aid;
ERROR:  column "a.aname" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: SELECT aname,COUNT(C.eid) FROM Aircraft A JOIN Certified C O...
               ^
fly=# SELECT aname,COUNT(C.eid) FROM Aircraft A JOIN Certified C ON A.aid = C.aid GROUP BY C.eid;
ERROR:  column "a.aname" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: SELECT aname,COUNT(C.eid) FROM Aircraft A JOIN Certified C O...
               ^
fly=# SELECT A.aname,COUNT(C.eid) FROM Aircraft A JOIN Certified C ON A.aid = C.aid GROUP BY C.eid;
ERROR:  column "a.aname" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: SELECT A.aname,COUNT(C.eid) FROM Aircraft A JOIN Certified C...
               ^
fly=# SELECT A.aname,COUNT(C.eid) FROM Aircraft A JOIN Certified C ON A.aid = C.aid;
ERROR:  column "a.aname" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: SELECT A.aname,COUNT(C.eid) FROM Aircraft A JOIN Certified C...
               ^
fly=# SELECT A.aname FROM Aircraft A JOIN Certified C ON A.aid = C.aid;
  aname   
----------
 GoAir
 IndiGo
 SpiceJet
 Vistara
 Star Air
 TruJet
 Zoom AIr
 SpiceJet
 SpiceJet
 SpiceJet
 SpiceJet
 SpiceJet
 SpiceJet
 SpiceJet
 SpiceJet
 SpiceJet
 SpiceJet
 SpiceJet
 SpiceJet
 SpiceJet
 IndiGo
 IndiGo
 TruJet
 Star Air
(24 rows)

fly=# SELECT A.aname, COUNT(C.eid) FROM Aircraft A JOIN Certified C ON A.aid = C.aid GROUP BY A.name;
ERROR:  column a.name does not exist
LINE 1: ...ircraft A JOIN Certified C ON A.aid = C.aid GROUP BY A.name;
                                                                ^
HINT:  Perhaps you meant to reference the column "a.aname".
fly=# SELECT A.aname, COUNT(C.eid) FROM Aircraft A JOIN Certified C ON A.aid = C.aid GROUP BY A.aname;
  aname   | count 
----------+-------
 SpiceJet |    14
 Zoom AIr |     1
 Vistara  |     1
 TruJet   |     2
 Star Air |     2
 GoAir    |     1
 IndiGo   |     3
(7 rows)

fly=# 
fly=# 
fly=# SELECT A.aname, COUNT(C.eid) FROM Aircraft A JOIN Certified C ON A.aid = C.aid GROUP BY A.aname;
  aname   | count 
----------+-------
 SpiceJet |    14
 Zoom AIr |     1
 Vistara  |     1
 TruJet   |     2
 Star Air |     2
 GoAir    |     1
 IndiGo   |     3
(7 rows)

fly=# 
fly=# 
fly=# SELECT A.aname, COUNT(C.eid) FROM Aircraft A JOIN Certified C ON A.aid = C.aid GROUP BY A.aname;
  aname   | count 
----------+-------
 SpiceJet |    14
 Zoom AIr |     1
 Vistara  |     1
 TruJet   |     2
 Star Air |     2
 GoAir    |     1
 IndiGo   |     3
(7 rows)

fly=# \c Store
You are now connected to database "Store" as user "postgres".
Store=# \d
               List of relations
 Schema |      Name      |   Type   |  Owner   
--------+----------------+----------+----------
 public | comp           | table    | postgres
 public | company        | table    | postgres
 public | company_id_seq | sequence | postgres
 public | customers      | table    | postgres
 public | orderproducts  | table    | postgres
 public | orders         | table    | postgres
 public | products       | table    | postgres
(7 rows)

Store=# \d orderproducts
                Table "public.orderproducts"
        Column         |          Type          | Modifiers 
-----------------------+------------------------+-----------
 orderid               | integer                | 
 productid             | integer                | 
 qty                   | integer                | not null
 orderproductscomments | character varying(100) | not null
Foreign-key constraints:
    "orderproducts_orderid_fkey" FOREIGN KEY (orderid) REFERENCES orders(orderid)
    "orderproducts_productid_fkey" FOREIGN KEY (productid) REFERENCES products(productid)

Store=# \d orders
        Table "public.orders"
    Column     |  Type   | Modifiers 
---------------+---------+-----------
 orderid       | integer | not null
 customerid    | integer | 
 date          | date    | not null
 ordercomments | text    | not null
Indexes:
    "orders_pkey" PRIMARY KEY, btree (orderid)
Foreign-key constraints:
    "orders_customerid_fkey" FOREIGN KEY (customerid) REFERENCES customers(customerid)
Referenced by:
    TABLE "orderproducts" CONSTRAINT "orderproducts_orderid_fkey" FOREIGN KEY (orderid) REFERENCES orders(orderid)

Store=# CREATE DATABASE customer_order_product_mangment
Store-# ;
CREATE DATABASE
Store=# \c customer_order_product_mangment
You are now connected to database "customer_order_product_mangment" as user "postgres".
customer_order_product_mangment=# 
customer_order_product_mangment=# 
customer_order_product_mangment=# 
customer_order_product_mangment=# \c Store
You are now connected to database "Store" as user "postgres".
Store=# \d products;
               Table "public.products"
     Column      |          Type          | Modifiers 
-----------------+------------------------+-----------
 productid       | integer                | not null
 name            | character varying(20)  | not null
 description     | character varying(100) | not null
 size            | character varying(10)  | not null
 unit            | integer                | not null
 productcomments | character varying      | not null
Indexes:
    "products_pkey" PRIMARY KEY, btree (productid)
Referenced by:
    TABLE "orderproducts" CONSTRAINT "orderproducts_productid_fkey" FOREIGN KEY (productid) REFERENCES products(productid)

Store=# \d orders;
        Table "public.orders"
    Column     |  Type   | Modifiers 
---------------+---------+-----------
 orderid       | integer | not null
 customerid    | integer | 
 date          | date    | not null
 ordercomments | text    | not null
Indexes:
    "orders_pkey" PRIMARY KEY, btree (orderid)
Foreign-key constraints:
    "orders_customerid_fkey" FOREIGN KEY (customerid) REFERENCES customers(customerid)
Referenced by:
    TABLE "orderproducts" CONSTRAINT "orderproducts_orderid_fkey" FOREIGN KEY (orderid) REFERENCES orders(orderid)

Store=# \c customer_order_product_mangment
You are now connected to database "customer_order_product_mangment" as user "postgres".
customer_order_product_mangment=# 
customer_order_product_mangment=# 
customer_order_product_mangment=# CREATE TABLE customers(customerid INT PRYMERY KEY, name varchar NOT NULL, address varchar NOT NULL, dob DATE NOT NULL, contact INT NOT NULL);
ERROR:  syntax error at or near "PRYMERY"
LINE 1: CREATE TABLE customers(customerid INT PRYMERY KEY, name varc...
                                              ^
customer_order_product_mangment=# CREATE TABLE customers(customerid INT PRIMARY KEY, name varchar NOT NULL, address varchar NOT NULL, dob DATE NOT NULL, contact INT NOT NULL);
CREATE TABLE
customer_order_product_mangment=# 
customer_order_product_mangment=# CREATE TABLE products(productid INT PRIMARY KEY, name varchar not null, colour varchar not null);
CREATE TABLE
customer_order_product_mangment=# CREFGATE TABLE orders(orderid INT PRIMARY KEY, data DATE NOT NULL, customerid INT NOT NULL, productid INT NOT NULL, data DATE NOT NULL, FOREIGN KEY (customerid) references customers(customerid), foreign key (orderid) references orders(orderid) )
customer_order_product_mangment-# ;
ERROR:  syntax error at or near "CREFGATE"
LINE 1: CREFGATE TABLE orders(orderid INT PRIMARY KEY, data DATE NOT...
        ^
customer_order_product_mangment=# \d products;
          Table "public.products"
  Column   |       Type        | Modifiers 
-----------+-------------------+-----------
 productid | integer           | not null
 name      | character varying | not null
 colour    | character varying | not null
Indexes:
    "products_pkey" PRIMARY KEY, btree (productid)

customer_order_product_mangment=# alter table products add column price int not null;
ALTER TABLE
customer_order_product_mangment=# \d products;
          Table "public.products"
  Column   |       Type        | Modifiers 
-----------+-------------------+-----------
 productid | integer           | not null
 name      | character varying | not null
 colour    | character varying | not null
 price     | integer           | not null
Indexes:
    "products_pkey" PRIMARY KEY, btree (productid)

customer_order_product_mangment=# create table orders(orderid int primary key, customerid int not null, date date not null, foreign key (customerid) references customers(customerid));
CREATE TABLE
customer_order_product_mangment=# create table orderproducts (orderproductid int primary key, orderid int not null, productid int not null, foreign key(orderid) references orders(orderid), foreign key(productid) references products(productid));
CREATE TABLE
customer_order_product_mangment=# 
customer_order_product_mangment=# 
customer_order_product_mangment=# 
customer_order_product_mangment=# \d products;
          Table "public.products"
  Column   |       Type        | Modifiers 
-----------+-------------------+-----------
 productid | integer           | not null
 name      | character varying | not null
 colour    | character varying | not null
 price     | integer           | not null
Indexes:
    "products_pkey" PRIMARY KEY, btree (productid)
Referenced by:
    TABLE "orderproducts" CONSTRAINT "orderproducts_productid_fkey" FOREIGN KEY (productid) REFERENCES products(productid)

customer_order_product_mangment=# insert into products values (1,"Laptop","Silver",70000);
ERROR:  column "Laptop" does not exist
LINE 1: insert into products values (1,"Laptop","Silver",70000);
                                       ^
customer_order_product_mangment=# \d customers;
          Table "public.customers"
   Column   |       Type        | Modifiers 
------------+-------------------+-----------
 customerid | integer           | not null
 name       | character varying | not null
 address    | character varying | not null
 dob        | date              | not null
 contact    | integer           | not null
Indexes:
    "customers_pkey" PRIMARY KEY, btree (customerid)
Referenced by:
    TABLE "orders" CONSTRAINT "orders_customerid_fkey" FOREIGN KEY (customerid) REFERENCES customers(customerid)

customer_order_product_mangment=# \d orders;
      Table "public.orders"
   Column   |  Type   | Modifiers 
------------+---------+-----------
 orderid    | integer | not null
 customerid | integer | not null
 date       | date    | not null
Indexes:
    "orders_pkey" PRIMARY KEY, btree (orderid)
Foreign-key constraints:
    "orders_customerid_fkey" FOREIGN KEY (customerid) REFERENCES customers(customerid)
Referenced by:
    TABLE "orderproducts" CONSTRAINT "orderproducts_orderid_fkey" FOREIGN KEY (orderid) REFERENCES orders(orderid)

customer_order_product_mangment=# insert into products values (1,"Laptop","Silver",70000);
ERROR:  column "Laptop" does not exist
LINE 1: insert into products values (1,"Laptop","Silver",70000);
                                       ^
customer_order_product_mangment=# \d customers;
          Table "public.customers"
   Column   |       Type        | Modifiers 
------------+-------------------+-----------
 customerid | integer           | not null
 name       | character varying | not null
 address    | character varying | not null
 dob        | date              | not null
 contact    | integer           | not null
Indexes:
    "customers_pkey" PRIMARY KEY, btree (customerid)
Referenced by:
    TABLE "orders" CONSTRAINT "orders_customerid_fkey" FOREIGN KEY (customerid) REFERENCES customers(customerid)

customer_order_product_mangment=# insert into customers values (1,'Pankaj','Delhi','15-02-1997');
ERROR:  date/time field value out of range: "15-02-1997"
LINE 1: insert into customers values (1,'Pankaj','Delhi','15-02-1997...
                                                         ^
HINT:  Perhaps you need a different "datestyle" setting.
customer_order_product_mangment=# insert into customers values (1,'Pankaj','Delhi','1997-02-15');
ERROR:  null value in column "contact" violates not-null constraint
DETAIL:  Failing row contains (1, Pankaj, Delhi, 1997-02-15, null).
customer_order_product_mangment=# insert into customers values (1,'Pankaj','Delhi','1997-02-15',7009147259);
ERROR:  integer out of range
customer_order_product_mangment=# insert into customers values (1,'Pankaj','Delhi','1997-02-15',7788);
INSERT 0 1
customer_order_product_mangment=# insert into customers values (2,'Pavan','Punjab','2007-05-18',7799);
INSERT 0 1
customer_order_product_mangment=# insert into customers values (3,'Sachin','Haryana','2005-12-45',5698);
ERROR:  date/time field value out of range: "2005-12-45"
LINE 1: ...nsert into customers values (3,'Sachin','Haryana','2005-12-4...
                                                             ^
HINT:  Perhaps you need a different "datestyle" setting.
customer_order_product_mangment=# insert into customers values (3,'Sachin','Haryana','2005-12-15',5698);
INSERT 0 1
customer_order_product_mangment=# insert into products values (1,"Laptop","silver",70000 );
ERROR:  column "Laptop" does not exist
LINE 1: insert into products values (1,"Laptop","silver",70000 );
                                       ^
customer_order_product_mangment=# \d products;
          Table "public.products"
  Column   |       Type        | Modifiers 
-----------+-------------------+-----------
 productid | integer           | not null
 name      | character varying | not null
 colour    | character varying | not null
 price     | integer           | not null
Indexes:
    "products_pkey" PRIMARY KEY, btree (productid)
Referenced by:
    TABLE "orderproducts" CONSTRAINT "orderproducts_productid_fkey" FOREIGN KEY (productid) REFERENCES products(productid)

customer_order_product_mangment=# insert into products values (1,"Laptop","silver",70000 );
ERROR:  column "Laptop" does not exist
LINE 1: insert into products values (1,"Laptop","silver",70000 );
                                       ^
customer_order_product_mangment=# insert into products values (1,'Laptop',"silver",70000 );
ERROR:  column "silver" does not exist
LINE 1: insert into products values (1,'Laptop',"silver",70000 );
                                                ^
customer_order_product_mangment=# insert into products values (1,'Laptop','silver',70000 );
INSERT 0 1
customer_order_product_mangment=# insert into products values (2,'Mobile','silver',15000 );
INSERT 0 1
customer_order_product_mangment=# insert into products values (3,'Shoe','Black',1000 );
INSERT 0 1
customer_order_product_mangment=# select * from products;
 productid |  name  | colour | price 
-----------+--------+--------+-------
         1 | Laptop | silver | 70000
         2 | Mobile | silver | 15000
         3 | Shoe   | Black  |  1000
(3 rows)

customer_order_product_mangment=# update table products set colour = "Silver" where price = 70000;
ERROR:  syntax error at or near "table"
LINE 1: update table products set colour = "Silver" where price = 70...
               ^
customer_order_product_mangment=# update products set colour = "Silver" where price = 70000;
ERROR:  column "Silver" does not exist
LINE 1: update products set colour = "Silver" where price = 70000;
                                     ^
customer_order_product_mangment=# update products set colour = 'Silver' where price = 70000;
UPDATE 1
customer_order_product_mangment=# update products set colour = 'Silver' where price = 15000;
UPDATE 1
customer_order_product_mangment=# select * from products;
 productid |  name  | colour | price 
-----------+--------+--------+-------
         3 | Shoe   | Black  |  1000
         1 | Laptop | Silver | 70000
         2 | Mobile | Silver | 15000
(3 rows)

customer_order_product_mangment=# insert into products values (4,'Bag','Black',800 );
INSERT 0 1
customer_order_product_mangment=# insert into products values (5,'Mouse','Black',500 );
INSERT 0 1
customer_order_product_mangment=# \d orders;
      Table "public.orders"
   Column   |  Type   | Modifiers 
------------+---------+-----------
 orderid    | integer | not null
 customerid | integer | not null
 date       | date    | not null
Indexes:
    "orders_pkey" PRIMARY KEY, btree (orderid)
Foreign-key constraints:
    "orders_customerid_fkey" FOREIGN KEY (customerid) REFERENCES customers(customerid)
Referenced by:
    TABLE "orderproducts" CONSTRAINT "orderproducts_orderid_fkey" FOREIGN KEY (orderid) REFERENCES orders(orderid)

customer_order_product_mangment=# insert into orders values (1,1,'2020-01-28');
INSERT 0 1
customer_order_product_mangment=# insert into orders values (2,1,'2020-01-20');
INSERT 0 1
customer_order_product_mangment=# insert into orders values (2,1,'2020-01-20');
ERROR:  duplicate key value violates unique constraint "orders_pkey"
DETAIL:  Key (orderid)=(2) already exists.
customer_order_product_mangment=# insert into orders values (3,3,'2020-01-10');
INSERT 0 1
customer_order_product_mangment=# insert into orders values (3,3,'2020-01-12');
ERROR:  duplicate key value violates unique constraint "orders_pkey"
DETAIL:  Key (orderid)=(3) already exists.
customer_order_product_mangment=# insert into orders values (4,3,'2020-01-12');
INSERT 0 1
customer_order_product_mangment=# insert into orderproducts values ()
customer_order_product_mangment-# ;
ERROR:  syntax error at or near ")"
LINE 1: insert into orderproducts values ()
                                          ^
customer_order_product_mangment=# \d orderproducts;
     Table "public.orderproducts"
     Column     |  Type   | Modifiers 
----------------+---------+-----------
 orderproductid | integer | not null
 orderid        | integer | not null
 productid      | integer | not null
Indexes:
    "orderproducts_pkey" PRIMARY KEY, btree (orderproductid)
Foreign-key constraints:
    "orderproducts_orderid_fkey" FOREIGN KEY (orderid) REFERENCES orders(orderid)
    "orderproducts_productid_fkey" FOREIGN KEY (productid) REFERENCES products(productid)

customer_order_product_mangment=# insert into orderproducts values (1,1,1);
INSERT 0 1
customer_order_product_mangment=# insert into orderproducts values (2,1,1);
INSERT 0 1
customer_order_product_mangment=# SELECT * FROM products;
 productid |  name  | colour | price 
-----------+--------+--------+-------
         3 | Shoe   | Black  |  1000
         1 | Laptop | Silver | 70000
         2 | Mobile | Silver | 15000
         4 | Bag    | Black  |   800
         5 | Mouse  | Black  |   500
(5 rows)

customer_order_product_mangment=# SELECT * FROM customers;
 customerid |  name  | address |    dob     | contact 
------------+--------+---------+------------+---------
          1 | Pankaj | Delhi   | 1997-02-15 |    7788
          2 | Pavan  | Punjab  | 2007-05-18 |    7799
          3 | Sachin | Haryana | 2005-12-15 |    5698
(3 rows)

customer_order_product_mangment=# SELECT * FROM orders;
 orderid | customerid |    date    
---------+------------+------------
       1 |          1 | 2020-01-28
       2 |          1 | 2020-01-20
       3 |          3 | 2020-01-10
       4 |          3 | 2020-01-12
(4 rows)

customer_order_product_mangment=# SELECT * FROM orderproducts;
 orderproductid | orderid | productid 
----------------+---------+-----------
              1 |       1 |         1
              2 |       1 |         1
(2 rows)

customer_order_product_mangment=# insert into orderproducts values (3,2,1);
INSERT 0 1
customer_order_product_mangment=# SELECT * FROM orderproducts;
 orderproductid | orderid | productid 
----------------+---------+-----------
              1 |       1 |         1
              2 |       1 |         1
              3 |       2 |         1
(3 rows)

customer_order_product_mangment=# insert into orderproducts values (3,2,4);
ERROR:  duplicate key value violates unique constraint "orderproducts_pkey"
DETAIL:  Key (orderproductid)=(3) already exists.
customer_order_product_mangment=# insert into orderproducts values (4,2,4);
INSERT 0 1
customer_order_product_mangment=# SELECT * FROM orderproducts;
 orderproductid | orderid | productid 
----------------+---------+-----------
              1 |       1 |         1
              2 |       1 |         1
              3 |       2 |         1
              4 |       2 |         4
(4 rows)

customer_order_product_mangment=# insert into orderproducts values (5,3,4);
INSERT 0 1
customer_order_product_mangment=# insert into orderproducts values (6,4,4);
INSERT 0 1
customer_order_product_mangment=# insert into orderproducts values (6,4,5);
ERROR:  duplicate key value violates unique constraint "orderproducts_pkey"
DETAIL:  Key (orderproductid)=(6) already exists.
customer_order_product_mangment=# insert into orderproducts values (7,4,5);
INSERT 0 1
customer_order_product_mangment=# SELECT * FROM orderproducts;
 orderproductid | orderid | productid 
----------------+---------+-----------
              1 |       1 |         1
              2 |       1 |         1
              3 |       2 |         1
              4 |       2 |         4
              5 |       3 |         4
              6 |       4 |         4
              7 |       4 |         5
(7 rows)

customer_order_product_mangment=# SELECT * FROM orders;
 orderid | customerid |    date    
---------+------------+------------
       1 |          1 | 2020-01-28
       2 |          1 | 2020-01-20
       3 |          3 | 2020-01-10
       4 |          3 | 2020-01-12
(4 rows)

customer_order_product_mangment=# select * from customers C join orders O on C.customerid = O.orderid; 
 customerid |  name  | address |    dob     | contact | orderid | customerid |    date    
------------+--------+---------+------------+---------+---------+------------+------------
          1 | Pankaj | Delhi   | 1997-02-15 |    7788 |       1 |          1 | 2020-01-28
          2 | Pavan  | Punjab  | 2007-05-18 |    7799 |       2 |          1 | 2020-01-20
          3 | Sachin | Haryana | 2005-12-15 |    5698 |       3 |          3 | 2020-01-10
(3 rows)

customer_order_product_mangment=# select * from customers C join orders O on C.customerid = O.customerid; 
 customerid |  name  | address |    dob     | contact | orderid | customerid |    date    
------------+--------+---------+------------+---------+---------+------------+------------
          1 | Pankaj | Delhi   | 1997-02-15 |    7788 |       1 |          1 | 2020-01-28
          1 | Pankaj | Delhi   | 1997-02-15 |    7788 |       2 |          1 | 2020-01-20
          3 | Sachin | Haryana | 2005-12-15 |    5698 |       3 |          3 | 2020-01-10
          3 | Sachin | Haryana | 2005-12-15 |    5698 |       4 |          3 | 2020-01-12
(4 rows)

customer_order_product_mangment=# select * from customers C join orders O on C.customerid = O.customerid where C.customerid = 1; 
 customerid |  name  | address |    dob     | contact | orderid | customerid |    date    
------------+--------+---------+------------+---------+---------+------------+------------
          1 | Pankaj | Delhi   | 1997-02-15 |    7788 |       1 |          1 | 2020-01-28
          1 | Pankaj | Delhi   | 1997-02-15 |    7788 |       2 |          1 | 2020-01-20
(2 rows)

customer_order_product_mangment=# select C.address from customers C join orders O on C.customerid = O.customerid where C.customerid = 1; 
 address 
---------
 Delhi
 Delhi
(2 rows)

customer_order_product_mangment=# SELECT * FROM products;
 productid |  name  | colour | price 
-----------+--------+--------+-------
         3 | Shoe   | Black  |  1000
         1 | Laptop | Silver | 70000
         2 | Mobile | Silver | 15000
         4 | Bag    | Black  |   800
         5 | Mouse  | Black  |   500
(5 rows)

customer_order_product_mangment=# select P.name from Customer C join Orders O on C.customerid = O.customerid; 
ERROR:  relation "customer" does not exist
LINE 1: select P.name from Customer C join Orders O on C.customerid ...
                           ^
customer_order_product_mangment=# select P.name from customers C join Orders O on C.customerid = O.customerid; 
ERROR:  missing FROM-clause entry for table "p"
LINE 1: select P.name from customers C join Orders O on C.customerid...
               ^
customer_order_product_mangment=# select from customers C join Orders O on C.customerid = O.customerid; 
--
(4 rows)

customer_order_product_mangment=# 
customer_order_product_mangment=# select * from customers C join Orders O on C.customerid = O.customerid; 
 customerid |  name  | address |    dob     | contact | orderid | customerid |    date    
------------+--------+---------+------------+---------+---------+------------+------------
          1 | Pankaj | Delhi   | 1997-02-15 |    7788 |       1 |          1 | 2020-01-28
          1 | Pankaj | Delhi   | 1997-02-15 |    7788 |       2 |          1 | 2020-01-20
          3 | Sachin | Haryana | 2005-12-15 |    5698 |       3 |          3 | 2020-01-10
          3 | Sachin | Haryana | 2005-12-15 |    5698 |       4 |          3 | 2020-01-12
(4 rows)

customer_order_product_mangment=# 
customer_order_product_mangment=# 
customer_order_product_mangment=# select * from customers C join Orders O on C.customerid = O.customerid join orderproducts OP on O.orderid = OP.orderid; 
 customerid |  name  | address |    dob     | contact | orderid | customerid |    date    | orderproductid | orderid | productid 
------------+--------+---------+------------+---------+---------+------------+------------+----------------+---------+-----------
          1 | Pankaj | Delhi   | 1997-02-15 |    7788 |       1 |          1 | 2020-01-28 |              1 |       1 |         1
          1 | Pankaj | Delhi   | 1997-02-15 |    7788 |       1 |          1 | 2020-01-28 |              2 |       1 |         1
          1 | Pankaj | Delhi   | 1997-02-15 |    7788 |       2 |          1 | 2020-01-20 |              3 |       2 |         1
          1 | Pankaj | Delhi   | 1997-02-15 |    7788 |       2 |          1 | 2020-01-20 |              4 |       2 |         4
          3 | Sachin | Haryana | 2005-12-15 |    5698 |       3 |          3 | 2020-01-10 |              5 |       3 |         4
          3 | Sachin | Haryana | 2005-12-15 |    5698 |       4 |          3 | 2020-01-12 |              6 |       4 |         4
          3 | Sachin | Haryana | 2005-12-15 |    5698 |       4 |          3 | 2020-01-12 |              7 |       4 |         5
(7 rows)

customer_order_product_mangment=# select * from customers C join Orders O on C.customerid = O.customerid join orderproducts OP on O.orderid = OP.orderid join products P; 
ERROR:  syntax error at or near ";"
LINE 1: ... orderproducts OP on O.orderid = OP.orderid join products P;
                                                                      ^
customer_order_product_mangment=# select * from customers C join Orders O on C.customerid = O.customerid join orderproducts OP on O.orderid = OP.orderid join products P on P.productid = OP.productid; 
customer_order_product_mangment=# select P.name from customers C join Orders O on C.customerid = O.customerid join orderproducts OP on O.orderid = OP.orderid join products P on P.productid = OP.productid; 
  name  
--------
 Laptop
 Laptop
 Laptop
 Bag
 Bag
 Bag
 Mouse
(7 rows)

customer_order_product_mangment=# select distinct P.name from customers C join Orders O on C.customerid = O.customerid join orderproducts OP on O.orderid = OP.orderid join products P on P.productid = OP.productid; 
  name  
--------
 Bag
 Mouse
 Laptop
(3 rows)

customer_order_product_mangment=# select distinct P.name from customers C join Orders O on C.customerid = O.customerid join orderproducts OP on O.orderid = OP.orderid join products P on P.productid = OP.productid where C.customerid = 1; 
  name  
--------
 Bag
 Laptop
(2 rows)

customer_order_product_mangment=# select distinct P.name from customers C join Orders O on C.customerid = O.customerid join orderproducts OP on O.orderid = OP.orderid join products P on P.productid = OP.productid where C.customerid = 1 as Productname; 
ERROR:  syntax error at or near "as"
LINE 1: ...P.productid = OP.productid where C.customerid = 1 as Product...
                                                             ^
customer_order_product_mangment=# select distinct P.name as PN from customers C join Orders O on C.customerid = O.customerid join orderproducts OP on O.orderid = OP.orderid join products P on P.productid = OP.productid where C.customerid = 1; 
   pn   
--------
 Bag
 Laptop
(2 rows)

customer_order_product_mangment=# select distinct P.name as Product_Name from customers C join Orders O on C.customerid = O.customerid join orderproducts OP on O.orderid = OP.orderid join products P on P.productid = OP.productid where C.customerid = 1; 
 product_name 
--------------
 Bag
 Laptop
(2 rows)

customer_order_product_mangment=# select distinct P.name as Product_Name, P.productid as Product_id from customers C join Orders O on C.customerid = O.customerid join orderproducts OP on O.orderid = OP.orderid join products P on P.productid = OP.productid where C.customerid = 1; 
 product_name | product_id 
--------------+------------
 Laptop       |          1
 Bag          |          4
(2 rows)

customer_order_product_mangment=# select * from orders;
 orderid | customerid |    date    
---------+------------+------------
       1 |          1 | 2020-01-28
       2 |          1 | 2020-01-20
       3 |          3 | 2020-01-10
       4 |          3 | 2020-01-12
(4 rows)

customer_order_product_mangment=# select * from orderproducts;
 orderproductid | orderid | productid 
----------------+---------+-----------
              1 |       1 |         1
              2 |       1 |         1
              3 |       2 |         1
              4 |       2 |         4
              5 |       3 |         4
              6 |       4 |         4
              7 |       4 |         5
(7 rows)

customer_order_product_mangment=# select distinct P.name as Product_Name, P.productid as Product_id from customers C join Orders O on C.customerid = O.customerid join orderproducts OP on O.orderid = OP.orderid join products P on P.productid = OP.productid where C.customerid = 3; 
 product_name | product_id 
--------------+------------
 Mouse        |          5
 Bag          |          4
(2 rows)

customer_order_product_mangment=# select * from products;
 productid |  name  | colour | price 
-----------+--------+--------+-------
         3 | Shoe   | Black  |  1000
         1 | Laptop | Silver | 70000
         2 | Mobile | Silver | 15000
         4 | Bag    | Black  |   800
         5 | Mouse  | Black  |   500
(5 rows)

customer_order_product_mangment=# select distinct C.name from customers C join Orders O on C.customerid = O.customerid join orderproducts OP on O.orderid = OP.orderid join products P on P.productid = OP.productid where P.name = "Mouse"; 
ERROR:  column "Mouse" does not exist
LINE 1: ...ucts P on P.productid = OP.productid where P.name = "Mouse";
                                                               ^
customer_order_product_mangment=# select distinct C.name from customers C join Orders O on C.customerid = O.customerid join orderproducts OP on O.orderid = OP.orderid join products P on P.productid = OP.productid where P.name = 'Mouse'; 
  name  
--------
 Sachin
(1 row)

customer_order_product_mangment=# 
customer_order_product_mangment=# select distinct P.name, count(P.productid) from customers C join Orders O on C.customerid = O.customerid join orderproducts OP on O.orderid = OP.orderid join products P on P.productid = OP.productid group by P.name; 
  name  | count 
--------+-------
 Mouse  |     1
 Laptop |     3
 Bag    |     3
(3 rows)

customer_order_product_mangment=# select * from orders;
 orderid | customerid |    date    
---------+------------+------------
       1 |          1 | 2020-01-28
       2 |          1 | 2020-01-20
       3 |          3 | 2020-01-10
       4 |          3 | 2020-01-12
(4 rows)

customer_order_product_mangment=# select * from orderproducts;
 orderproductid | orderid | productid 
----------------+---------+-----------
              1 |       1 |         1
              2 |       1 |         1
              3 |       2 |         1
              4 |       2 |         4
              5 |       3 |         4
              6 |       4 |         4
              7 |       4 |         5
(7 rows)

customer_order_product_mangment=# select * from products;
 productid |  name  | colour | price 
-----------+--------+--------+-------
         3 | Shoe   | Black  |  1000
         1 | Laptop | Silver | 70000
         2 | Mobile | Silver | 15000
         4 | Bag    | Black  |   800
         5 | Mouse  | Black  |   500
(5 rows)

customer_order_product_mangment=# select distinct P.name, count(P.productid) from customers C join Orders O on C.customerid = O.customerid join orderproducts OP on O.orderid = OP.orderid join products P on P.productid = OP.productid group by P.name; 
  name  | count 
--------+-------
 Mouse  |     1
 Laptop |     3
 Bag    |     3
(3 rows)

customer_order_product_mangment=# select distinct P.name, count(P.productid) from customers C join Orders O on C.customerid = O.customerid join orderproducts OP on O.orderid = OP.orderid join products P on P.productid = OP.productid where C.name = 'Pankaj' group by P.name; 
  name  | count 
--------+-------
 Laptop |     3
 Bag    |     1
(2 rows)

customer_order_product_mangment=# select * from products;
 productid |  name  | colour | price 
-----------+--------+--------+-------
         3 | Shoe   | Black  |  1000
         1 | Laptop | Silver | 70000
         2 | Mobile | Silver | 15000
         4 | Bag    | Black  |   800
         5 | Mouse  | Black  |   500
(5 rows)

customer_order_product_mangment=# select * from orderproducts;
 orderproductid | orderid | productid 
----------------+---------+-----------
              1 |       1 |         1
              2 |       1 |         1
              3 |       2 |         1
              4 |       2 |         4
              5 |       3 |         4
              6 |       4 |         4
              7 |       4 |         5
(7 rows)

customer_order_product_mangment=# 
























=========================================================================================
=================================blog_post_system=======================================






beryl@beryl-Latitude-E5520:~$ su postgres
Password: 
postgres@beryl-Latitude-E5520:/home/beryl$ psql
Password: 
psql (9.5.19)
Type "help" for help.

postgres=# \l
postgres=# \c blog_post_system
You are now connected to database "blog_post_system" as user "postgres".
blog_post_system=# 
blog_post_system=# 
blog_post_system=# \d
           List of relations
 Schema |    Name    | Type  |  Owner   
--------+------------+-------+----------
 public | categories | table | postgres
 public | comments   | table | postgres
 public | likes      | table | postgres
 public | posts      | table | postgres
 public | users      | table | postgres
(5 rows)

blog_post_system=# select * from categories;
 id | type  
----+-------
  1 | Goods
  2 | food
(2 rows)

blog_post_system=# insert into categories values (3, '');
INSERT 0 1
blog_post_system=# select * from categories;
 id | type  
----+-------
  1 | Goods
  2 | food
  3 | 
(3 rows)

blog_post_system=# update categories set "type" = 'Food' where id = 2;
UPDATE 1
blog_post_system=# select * from categories;
 id | type  
----+-------
  1 | Goods
  3 | 
  2 | Food
(3 rows)

blog_post_system=# update categories set "type" = 'Fruit' where id = 2;
UPDATE 1
blog_post_system=# select * from categories;
 id | type  
----+-------
  1 | Goods
  3 | 
  2 | Fruit
(3 rows)

blog_post_system=# update categories set "type" = 'Foods' where id = 3;
UPDATE 1
blog_post_system=# update categories set "type" = 'Fruits' where id = 2;
UPDATE 1
blog_post_system=# select * from categories;
 id |  type  
----+--------
  1 | Goods
  3 | Foods
  2 | Fruits
(3 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select * from users;
 id | name | address | paid 
----+------+---------+------
(0 rows)

blog_post_system=# insert into users values (1, 'Pankaj', 'Patna');
INSERT 0 1
blog_post_system=# select * from users;
 id |  name  | address | paid 
----+--------+---------+------
  1 | Pankaj | Patna   | f
(1 row)

blog_post_system=# insert into users values (2, 'Pankaj', 'Patna', true);
INSERT 0 1
blog_post_system=# select * from users;
 id |  name  | address | paid 
----+--------+---------+------
  1 | Pankaj | Patna   | f
  2 | Pankaj | Patna   | t
(2 rows)

blog_post_system=# insert into users values (3, 'Saurabh', 'Delhi', true);
INSERT 0 1
blog_post_system=# insert into users values (4, 'Mohit', 'Delhi');
INSERT 0 1
blog_post_system=# select * from users;
 id |  name   | address | paid 
----+---------+---------+------
  1 | Pankaj  | Patna   | f
  2 | Pankaj  | Patna   | t
  3 | Saurabh | Delhi   | t
  4 | Mohit   | Delhi   | f
(4 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# insert into users values (5, 'Rohit', 'Hariyana');
INSERT 0 1
blog_post_system=# insert into users values (6, 'Gundeep', 'Patiala', true);
INSERT 0 1
blog_post_system=# insert into users values (7, 'Manjeet', 'Patiala', true);
INSERT 0 1
blog_post_system=# insert into users values (8, 'Motilal', 'Chhapra');
INSERT 0 1
blog_post_system=# insert into users values (9, 'Bittu', 'Chhapra');
INSERT 0 1
blog_post_system=# insert into users values (10, 'Bittu', 'Patna', true);
INSERT 0 1
blog_post_system=# insert into users values (11, 'Pavan', 'Patna', true);
INSERT 0 1
blog_post_system=# insert into users values (12, 'Pavan', 'Chhapra', true);
INSERT 0 1
blog_post_system=# insert into users values (13, 'Naveen', 'Chhapra', true);
INSERT 0 1
blog_post_system=# insert into users values (13, 'Naveen', 'Patiala', true);
ERROR:  duplicate key value violates unique constraint "users_pkey"
DETAIL:  Key (id)=(13) already exists.
blog_post_system=# insert into users values (14, 'Naveen', 'Patiala', true);
INSERT 0 1
blog_post_system=# insert into users values (15, 'Praveen', 'Chhapra');
INSERT 0 1
blog_post_system=# select * from users;
 id |  name   | address  | paid 
----+---------+----------+------
  1 | Pankaj  | Patna    | f
  2 | Pankaj  | Patna    | t
  3 | Saurabh | Delhi    | t
  4 | Mohit   | Delhi    | f
  5 | Rohit   | Hariyana | f
  6 | Gundeep | Patiala  | t
  7 | Manjeet | Patiala  | t
  8 | Motilal | Chhapra  | f
  9 | Bittu   | Chhapra  | f
 10 | Bittu   | Patna    | t
 11 | Pavan   | Patna    | t
 12 | Pavan   | Chhapra  | t
 13 | Naveen  | Chhapra  | t
 14 | Naveen  | Patiala  | t
 15 | Praveen | Chhapra  | f
(15 rows)

blog_post_system=# select * from users where paid = f
blog_post_system-# ;
ERROR:  column "f" does not exist
LINE 1: select * from users where paid = f
                                         ^
blog_post_system=# select * from users where paid = false;
 id |  name   | address  | paid 
----+---------+----------+------
  1 | Pankaj  | Patna    | f
  4 | Mohit   | Delhi    | f
  5 | Rohit   | Hariyana | f
  8 | Motilal | Chhapra  | f
  9 | Bittu   | Chhapra  | f
 15 | Praveen | Chhapra  | f
(6 rows)

blog_post_system=# select * from users where paid = true;
 id |  name   | address | paid 
----+---------+---------+------
  2 | Pankaj  | Patna   | t
  3 | Saurabh | Delhi   | t
  6 | Gundeep | Patiala | t
  7 | Manjeet | Patiala | t
 10 | Bittu   | Patna   | t
 11 | Pavan   | Patna   | t
 12 | Pavan   | Chhapra | t
 13 | Naveen  | Chhapra | t
 14 | Naveen  | Patiala | t
(9 rows)

blog_post_system=# \d posts;
            Table "public.posts"
   Column    |       Type        | Modifiers 
-------------+-------------------+-----------
 id          | integer           | not null
 user_id     | integer           | not null
 title       | character varying | not null
 content     | character varying | not null
 category_id | integer           | not null
Indexes:
    "posts_pkey" PRIMARY KEY, btree (id)
Foreign-key constraints:
    "posts_category_id_fkey" FOREIGN KEY (category_id) REFERENCES categories(id)
    "posts_user_id_fkey" FOREIGN KEY (user_id) REFERENCES users(id)
Referenced by:
    TABLE "comments" CONSTRAINT "comments_post_id_fkey" FOREIGN KEY (post_id) REFERENCES posts(id)
    TABLE "likes" CONSTRAINT "likes_post_id_fkey" FOREIGN KEY (post_id) REFERENCES posts(id)

blog_post_system=# insert into categories values (3, 'Woods');
ERROR:  duplicate key value violates unique constraint "categories_pkey"
DETAIL:  Key (id)=(3) already exists.
blog_post_system=# insert into categories values (4, 'Woods');
INSERT 0 1
blog_post_system=# insert into categories values (5, 'Books');
INSERT 0 1
blog_post_system=# insert into categories values (6, 'Health');
INSERT 0 1
blog_post_system=# insert into categories values (7, 'Medicines');
INSERT 0 1
blog_post_system=# insert into categories values (8, 'Cloths');
INSERT 0 1
blog_post_system=# select * from categories;
 id |   type    
----+-----------
  1 | Goods
  3 | Foods
  2 | Fruits
  4 | Woods
  5 | Books
  6 | Health
  7 | Medicines
  8 | Cloths
(8 rows)

blog_post_system=# insert into posts values (1, 5, 'Mango', 'Mangoes are sweets.')
blog_post_system-# ;
ERROR:  null value in column "category_id" violates not-null constraint
DETAIL:  Failing row contains (1, 5, Mango, Mangoes are sweets., null).
blog_post_system=# insert into posts values (1, 5, 'Mango', 'Mangoes are sweets.', 2);
INSERT 0 1
blog_post_system=# insert into posts values (2, 5, 'Banana', 'Bananas are sweets and yellow.', 2);
INSERT 0 1
blog_post_system=# insert into posts values (3, 10, 'Banana', 'Bananas are sweets and yellow.', 2);
INSERT 0 1
blog_post_system=# insert into posts values (4, 10, 'Book', 'Books are good.', 5);
INSERT 0 1
blog_post_system=# insert into posts values (5, 10, 'a goods', 'Goods are heavy.', 1);
INSERT 0 1
blog_post_system=# select * from categories;
 id |   type    
----+-----------
  1 | Goods
  3 | Foods
  2 | Fruits
  4 | Woods
  5 | Books
  6 | Health
  7 | Medicines
  8 | Cloths
(8 rows)

blog_post_system=# select * from posts;
 id | user_id |  title  |            content             | category_id 
----+---------+---------+--------------------------------+-------------
  1 |       5 | Mango   | Mangoes are sweets.            |           2
  2 |       5 | Banana  | Bananas are sweets and yellow. |           2
  3 |      10 | Banana  | Bananas are sweets and yellow. |           2
  4 |      10 | Book    | Books are good.                |           5
  5 |      10 | a goods | Goods are heavy.               |           1
(5 rows)

blog_post_system=# update posts set title = 'a mango' where id = 1;
UPDATE 1
blog_post_system=# update posts set title = 'a banana' where id = 2;
UPDATE 1
blog_post_system=# update posts set title = 'a banana' where id = 3;
UPDATE 1
blog_post_system=# update posts set title = 'a book' where id = 4;
UPDATE 1
blog_post_system=# select * from posts;
 id | user_id |  title   |            content             | category_id 
----+---------+----------+--------------------------------+-------------
  5 |      10 | a goods  | Goods are heavy.               |           1
  1 |       5 | a mango  | Mangoes are sweets.            |           2
  2 |       5 | a banana | Bananas are sweets and yellow. |           2
  3 |      10 | a banana | Bananas are sweets and yellow. |           2
  4 |      10 | a book   | Books are good.                |           5
(5 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# insert into posts values (6, 1, 'a food', 'foods are heavy.', 3);
INSERT 0 1
blog_post_system=# insert into posts values (7, 3, 'a food', 'foods are light.', 3);
INSERT 0 1
blog_post_system=# insert into posts values (8, 14, 'a food', 'foods are light.', 3);
INSERT 0 1
blog_post_system=# insert into posts values (9, 14, 'the goods', 'goods are light.', 1);
INSERT 0 1
blog_post_system=# insert into posts values (10, 14, 'a food', 'foods are good.', 3);
INSERT 0 1
blog_post_system=# insert into posts values (11, 14, 'a cloth', 'cloths are red.', 8);
INSERT 0 1
blog_post_system=# insert into posts values (12, 14, 'a wood', 'woods are heavy.', 4);
INSERT 0 1
blog_post_system=# select * from posts;
 id | user_id |   title   |            content             | category_id 
----+---------+-----------+--------------------------------+-------------
  5 |      10 | a goods   | Goods are heavy.               |           1
  1 |       5 | a mango   | Mangoes are sweets.            |           2
  2 |       5 | a banana  | Bananas are sweets and yellow. |           2
  3 |      10 | a banana  | Bananas are sweets and yellow. |           2
  4 |      10 | a book    | Books are good.                |           5
  6 |       1 | a food    | foods are heavy.               |           3
  7 |       3 | a food    | foods are light.               |           3
  8 |      14 | a food    | foods are light.               |           3
  9 |      14 | the goods | goods are light.               |           1
 10 |      14 | a food    | foods are good.                |           3
 11 |      14 | a cloth   | cloths are red.                |           8
 12 |      14 | a wood    | woods are heavy.               |           4
(12 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# insert into posts values (7, 7, 'a food', 'foods are light.', 3);
ERROR:  duplicate key value violates unique constraint "posts_pkey"
DETAIL:  Key (id)=(7) already exists.
blog_post_system=# insert into posts values (8, 7, 'a food', 'foods are light.', 3);
ERROR:  duplicate key value violates unique constraint "posts_pkey"
DETAIL:  Key (id)=(8) already exists.
blog_post_system=# insert into posts values (12, 7, 'a food', 'foods are light.', 3);
ERROR:  duplicate key value violates unique constraint "posts_pkey"
DETAIL:  Key (id)=(12) already exists.
blog_post_system=# insert into posts values (13, 7, 'a food', 'foods are light.', 3);
INSERT 0 1
blog_post_system=# insert into posts values (14, 7, 'a cloth', 'cloths are red.', 8);
INSERT 0 1
blog_post_system=# insert into posts values (15, 7, 'a food', 'foods are heavy.', 3);
INSERT 0 1
blog_post_system=# insert into posts values (16, 7, 'a goods', 'Goods are heavy.', 1);
INSERT 0 1
blog_post_system=# insert into posts values (17, 7, 'a goods', 'Goods are heavy.', 1);
INSERT 0 1
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select * from posts;
 id | user_id |   title   |            content             | category_id 
----+---------+-----------+--------------------------------+-------------
  5 |      10 | a goods   | Goods are heavy.               |           1
  1 |       5 | a mango   | Mangoes are sweets.            |           2
  2 |       5 | a banana  | Bananas are sweets and yellow. |           2
  3 |      10 | a banana  | Bananas are sweets and yellow. |           2
  4 |      10 | a book    | Books are good.                |           5
  6 |       1 | a food    | foods are heavy.               |           3
  7 |       3 | a food    | foods are light.               |           3
  8 |      14 | a food    | foods are light.               |           3
  9 |      14 | the goods | goods are light.               |           1
 10 |      14 | a food    | foods are good.                |           3
 11 |      14 | a cloth   | cloths are red.                |           8
 12 |      14 | a wood    | woods are heavy.               |           4
 13 |       7 | a food    | foods are light.               |           3
 14 |       7 | a cloth   | cloths are red.                |           8
 15 |       7 | a food    | foods are heavy.               |           3
 16 |       7 | a goods   | Goods are heavy.               |           1
 17 |       7 | a goods   | Goods are heavy.               |           1
(17 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# \d
           List of relations
 Schema |    Name    | Type  |  Owner   
--------+------------+-------+----------
 public | categories | table | postgres
 public | comments   | table | postgres
 public | likes      | table | postgres
 public | posts      | table | postgres
 public | users      | table | postgres
(5 rows)

blog_post_system=# \d likes;
     Table "public.likes"
 Column  |  Type   | Modifiers 
---------+---------+-----------
 id      | integer | not null
 user_id | integer | not null
 post_id | integer | not null
Indexes:
    "likes_pkey" PRIMARY KEY, btree (id)
Foreign-key constraints:
    "likes_post_id_fkey" FOREIGN KEY (post_id) REFERENCES posts(id)
    "likes_user_id_fkey" FOREIGN KEY (user_id) REFERENCES users(id)

blog_post_system=# insert into likes values (1, 1, 1)
blog_post_system-# ;
INSERT 0 1
blog_post_system=# 
blog_post_system=# insert into likes values (2, 1, 2);
INSERT 0 1
blog_post_system=# insert into likes values (2, 2, 1);
ERROR:  duplicate key value violates unique constraint "likes_pkey"
DETAIL:  Key (id)=(2) already exists.
blog_post_system=# insert into likes values (3, 2, 1);
INSERT 0 1
blog_post_system=# insert into likes values (4, 2, 5);
INSERT 0 1
blog_post_system=# insert into likes values (5, 2, 6);
INSERT 0 1
blog_post_system=# insert into likes values (6, 4, 6);
INSERT 0 1
blog_post_system=# insert into likes values (7, 4, 6);
INSERT 0 1
blog_post_system=# insert into likes values (8, 4, 12);
INSERT 0 1
blog_post_system=# insert into likes values (8, 14, 12);
ERROR:  duplicate key value violates unique constraint "likes_pkey"
DETAIL:  Key (id)=(8) already exists.
blog_post_system=# insert into likes values (9, 14, 12);
INSERT 0 1
blog_post_system=# insert into likes values (10, 14, 11);
INSERT 0 1
blog_post_system=# insert into likes values (11, 11, 11);
INSERT 0 1
blog_post_system=# select * from likes;
 id | user_id | post_id 
----+---------+---------
  1 |       1 |       1
  2 |       1 |       2
  3 |       2 |       1
  4 |       2 |       5
  5 |       2 |       6
  6 |       4 |       6
  7 |       4 |       6
  8 |       4 |      12
  9 |      14 |      12
 10 |      14 |      11
 11 |      11 |      11
(11 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# \d
           List of relations
 Schema |    Name    | Type  |  Owner   
--------+------------+-------+----------
 public | categories | table | postgres
 public | comments   | table | postgres
 public | likes      | table | postgres
 public | posts      | table | postgres
 public | users      | table | postgres
(5 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# \d comments;
     Table "public.comments"
 Column  |  Type   |  Modifiers   
---------+---------+--------------
 id      | integer | not null
 user_id | integer | not null
 post_id | integer | not null
 enable  | boolean | default true
Indexes:
    "comments_pkey" PRIMARY KEY, btree (id)
Foreign-key constraints:
    "comments_post_id_fkey" FOREIGN KEY (post_id) REFERENCES posts(id)
    "comments_user_id_fkey" FOREIGN KEY (user_id) REFERENCES users(id)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# insert into comments values (1, 1, 2);
INSERT 0 1
blog_post_system=# insert into comments values (2, 1, 5);
INSERT 0 1
blog_post_system=# insert into comments values (2, 1, 7);
ERROR:  duplicate key value violates unique constraint "comments_pkey"
DETAIL:  Key (id)=(2) already exists.
blog_post_system=# delete from comments;
DELETE 2
blog_post_system=# select * from comments;
 id | user_id | post_id | enable 
----+---------+---------+--------
(0 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# alter table comments add column content varchar default = 'Empty';
ERROR:  syntax error at or near "="
LINE 1: ...table comments add column content varchar default = 'Empty';
                                                             ^
blog_post_system=# alter table comments add content varchar default = 'Empty';
ERROR:  syntax error at or near "="
LINE 1: alter table comments add content varchar default = 'Empty';
                                                         ^
blog_post_system=# alter table comments add content varchar default = "Empty";
ERROR:  syntax error at or near "="
LINE 1: alter table comments add content varchar default = "Empty";
                                                         ^
blog_post_system=# alter table comments add column content varchar default = 'Empty';
ERROR:  syntax error at or near "="
LINE 1: ...table comments add column content varchar default = 'Empty';
                                                             ^
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# alter table comments add column content varchar default 'Empty';
ALTER TABLE
blog_post_system=# select * from comments;
 id | user_id | post_id | enable | content 
----+---------+---------+--------+---------
(0 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# insert into comments values (1, 1, 1);
INSERT 0 1
blog_post_system=# select * from comments;
 id | user_id | post_id | enable | content 
----+---------+---------+--------+---------
  1 |       1 |       1 | t      | Empty
(1 row)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# insert into comments values (2, 1, false, 1);
ERROR:  column "post_id" is of type integer but expression is of type boolean
LINE 1: insert into comments values (2, 1, false, 1);
                                           ^
HINT:  You will need to rewrite or cast the expression.
blog_post_system=# insert into comments values (2, 1, 3, false, 'This mangoes are not sweet');
INSERT 0 1
blog_post_system=# select * from comments;
 id | user_id | post_id | enable |          content           
----+---------+---------+--------+----------------------------
  1 |       1 |       1 | t      | Empty
  2 |       1 |       3 | f      | This mangoes are not sweet
(2 rows)

blog_post_system=# insert into comments values (3, 3, 5, 'This goods are light');
ERROR:  invalid input syntax for type boolean: "This goods are light"
LINE 1: insert into comments values (3, 3, 5, 'This goods are light'...
                                              ^
blog_post_system=# insert into comments values (3, 3, 5,'', 'This goods are light');
ERROR:  invalid input syntax for type boolean: ""
LINE 1: insert into comments values (3, 3, 5,'', 'This goods are lig...
                                             ^
blog_post_system=# insert into comments (id, user_id, post_id, enable, content) values (3, 3, 5, '', 'This goods are light');
ERROR:  invalid input syntax for type boolean: ""
LINE 1: ...er_id, post_id, enable, content) values (3, 3, 5, '', 'This ...
                                                             ^
blog_post_system=# insert into comments (id, user_id, post_id, content, enable) values (3, 3, 5, 'This goods are light');
ERROR:  INSERT has more target columns than expressions
LINE 1: ...ert into comments (id, user_id, post_id, content, enable) va...
                                                             ^
blog_post_system=# insert into comments (id, user_id, post_id, content) values (3, 3, 5, 'This goods are light');
INSERT 0 1
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select * from comments;
 id | user_id | post_id | enable |          content           
----+---------+---------+--------+----------------------------
  1 |       1 |       1 | t      | Empty
  2 |       1 |       3 | f      | This mangoes are not sweet
  3 |       3 |       5 | t      | This goods are light
(3 rows)

blog_post_system=# select * from posts;
 id | user_id |   title   |            content             | category_id 
----+---------+-----------+--------------------------------+-------------
  5 |      10 | a goods   | Goods are heavy.               |           1
  1 |       5 | a mango   | Mangoes are sweets.            |           2
  2 |       5 | a banana  | Bananas are sweets and yellow. |           2
  3 |      10 | a banana  | Bananas are sweets and yellow. |           2
  4 |      10 | a book    | Books are good.                |           5
  6 |       1 | a food    | foods are heavy.               |           3
  7 |       3 | a food    | foods are light.               |           3
  8 |      14 | a food    | foods are light.               |           3
  9 |      14 | the goods | goods are light.               |           1
 10 |      14 | a food    | foods are good.                |           3
 11 |      14 | a cloth   | cloths are red.                |           8
 12 |      14 | a wood    | woods are heavy.               |           4
 13 |       7 | a food    | foods are light.               |           3
 14 |       7 | a cloth   | cloths are red.                |           8
 15 |       7 | a food    | foods are heavy.               |           3
 16 |       7 | a goods   | Goods are heavy.               |           1
 17 |       7 | a goods   | Goods are heavy.               |           1
(17 rows)

blog_post_system=# insert into comments (id, user_id, post_id, content) values (3, 3, 5, 'This goods are light');
ERROR:  duplicate key value violates unique constraint "comments_pkey"
DETAIL:  Key (id)=(3) already exists.
blog_post_system=# insert into comments (id, user_id, post_id, content) values (4, 12, 15, 'foods are good');
INSERT 0 1
blog_post_system=# insert into comments (id, user_id, post_id, content, enable) values (5, 12, 14, 'cloths are old', false);
INSERT 0 1
blog_post_system=# select * from posts;
 id | user_id |   title   |            content             | category_id 
----+---------+-----------+--------------------------------+-------------
  5 |      10 | a goods   | Goods are heavy.               |           1
  1 |       5 | a mango   | Mangoes are sweets.            |           2
  2 |       5 | a banana  | Bananas are sweets and yellow. |           2
  3 |      10 | a banana  | Bananas are sweets and yellow. |           2
  4 |      10 | a book    | Books are good.                |           5
  6 |       1 | a food    | foods are heavy.               |           3
  7 |       3 | a food    | foods are light.               |           3
  8 |      14 | a food    | foods are light.               |           3
  9 |      14 | the goods | goods are light.               |           1
 10 |      14 | a food    | foods are good.                |           3
 11 |      14 | a cloth   | cloths are red.                |           8
 12 |      14 | a wood    | woods are heavy.               |           4
 13 |       7 | a food    | foods are light.               |           3
 14 |       7 | a cloth   | cloths are red.                |           8
 15 |       7 | a food    | foods are heavy.               |           3
 16 |       7 | a goods   | Goods are heavy.               |           1
 17 |       7 | a goods   | Goods are heavy.               |           1
(17 rows)

blog_post_system=# select * from comments;
 id | user_id | post_id | enable |          content           
----+---------+---------+--------+----------------------------
  1 |       1 |       1 | t      | Empty
  2 |       1 |       3 | f      | This mangoes are not sweet
  3 |       3 |       5 | t      | This goods are light
  4 |      12 |      15 | t      | foods are good
  5 |      12 |      14 | f      | cloths are old
(5 rows)

blog_post_system=# insert into comments (id, user_id, post_id, content) values (5, 12, 11, 'foods are not good');
ERROR:  duplicate key value violates unique constraint "comments_pkey"
DETAIL:  Key (id)=(5) already exists.
blog_post_system=# insert into comments (id, user_id, post_id, content) values (6, 12, 11, 'foods are not good');
INSERT 0 1
blog_post_system=# insert into comments (id, user_id, post_id, content) values (7, 12, 5, 'mangoes are not good');
INSERT 0 1
blog_post_system=# select count() from users U join post P on U.id = P.user_id where U.name = 'Pankaj' join categories C on C.id = P.category_id where C."type" = 'Foods';
ERROR:  syntax error at or near "join"
LINE 1: ...ost P on U.id = P.user_id where U.name = 'Pankaj' join categ...
                                                             ^
blog_post_system=# select count(P.id) from users U join post P on U.id = P.user_id where U.name = 'Pankaj' join categories C on C.id = P.category_id where C."type" = 'Foods';
ERROR:  syntax error at or near "join"
LINE 1: ...ost P on U.id = P.user_id where U.name = 'Pankaj' join categ...
                                                             ^
blog_post_system=# select count(P.id) from users U join post P on U.id = P.user_id join categories C on C.id = P.category_id where U.name = 'Pankaj' and C."type" = 'Foods';
ERROR:  relation "post" does not exist
LINE 1: select count(P.id) from users U join post P on U.id = P.user...
                                             ^
blog_post_system=# select count(P.id) from users U join posts P on U.id = P.user_id join categories C on C.id = P.category_id where U.name = 'Pankaj' and C."type" = 'Foods';
 count 
-------
     1
(1 row)

blog_post_system=# select count(P.id) from users U join posts P on U.id = P.user_id where U.name = 'Pankaj' join categories C on C.id = P.category_id where C."type" = 'Foods';
ERROR:  syntax error at or near "join"
LINE 1: ...sts P on U.id = P.user_id where U.name = 'Pankaj' join categ...
                                                             ^
blog_post_system=# select * from categories;
 id |   type    
----+-----------
  1 | Goods
  3 | Foods
  2 | Fruits
  4 | Woods
  5 | Books
  6 | Health
  7 | Medicines
  8 | Cloths
(8 rows)

blog_post_system=# alter table categories alter column "type" rename to name;
ERROR:  syntax error at or near "rename"
LINE 1: alter table categories alter column "type" rename to name;
                                                   ^
blog_post_system=# alter table categories rename column "type" to  name;
ALTER TABLE
blog_post_system=# select * from categories;
 id |   name    
----+-----------
  1 | Goods
  3 | Foods
  2 | Fruits
  4 | Woods
  5 | Books
  6 | Health
  7 | Medicines
  8 | Cloths
(8 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select count(P.id) from users U join posts P on U.id = P.user_id where U.name = 'Pankaj' join categories C on C.id = P.category_id where C.name = 'Foods';
ERROR:  syntax error at or near "join"
LINE 1: ...sts P on U.id = P.user_id where U.name = 'Pankaj' join categ...
                                                             ^
blog_post_system=# select count(P.id) from users U join posts P on U.id = P.user_id join categories C on C.id = P.category_id where U.name = 'Pankaj' and C.name = 'Foods';
 count 
-------
     1
(1 row)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# select count(P.id) from users U join posts P on U.id = P.user_id join categories C on C.id = P.category_id where U.name = 'Pankaj' and C.name = 'Foods';
 count 
-------
     1
(1 row)

blog_post_system=# select * from users;
 id |  name   | address  | paid 
----+---------+----------+------
  1 | Pankaj  | Patna    | f
  2 | Pankaj  | Patna    | t
  3 | Saurabh | Delhi    | t
  4 | Mohit   | Delhi    | f
  5 | Rohit   | Hariyana | f
  6 | Gundeep | Patiala  | t
  7 | Manjeet | Patiala  | t
  8 | Motilal | Chhapra  | f
  9 | Bittu   | Chhapra  | f
 10 | Bittu   | Patna    | t
 11 | Pavan   | Patna    | t
 12 | Pavan   | Chhapra  | t
 13 | Naveen  | Chhapra  | t
 14 | Naveen  | Patiala  | t
 15 | Praveen | Chhapra  | f
(15 rows)

blog_post_system=# select * from posts;
 id | user_id |   title   |            content             | category_id 
----+---------+-----------+--------------------------------+-------------
  5 |      10 | a goods   | Goods are heavy.               |           1
  1 |       5 | a mango   | Mangoes are sweets.            |           2
  2 |       5 | a banana  | Bananas are sweets and yellow. |           2
  3 |      10 | a banana  | Bananas are sweets and yellow. |           2
  4 |      10 | a book    | Books are good.                |           5
  6 |       1 | a food    | foods are heavy.               |           3
  7 |       3 | a food    | foods are light.               |           3
  8 |      14 | a food    | foods are light.               |           3
  9 |      14 | the goods | goods are light.               |           1
 10 |      14 | a food    | foods are good.                |           3
 11 |      14 | a cloth   | cloths are red.                |           8
 12 |      14 | a wood    | woods are heavy.               |           4
 13 |       7 | a food    | foods are light.               |           3
 14 |       7 | a cloth   | cloths are red.                |           8
 15 |       7 | a food    | foods are heavy.               |           3
 16 |       7 | a goods   | Goods are heavy.               |           1
 17 |       7 | a goods   | Goods are heavy.               |           1
(17 rows)

blog_post_system=# select * from categories;
 id |   name    
----+-----------
  1 | Goods
  3 | Foods
  2 | Fruits
  4 | Woods
  5 | Books
  6 | Health
  7 | Medicines
  8 | Cloths
(8 rows)

blog_post_system=# select * from comments;
 id | user_id | post_id | enable |          content           
----+---------+---------+--------+----------------------------
  1 |       1 |       1 | t      | Empty
  2 |       1 |       3 | f      | This mangoes are not sweet
  3 |       3 |       5 | t      | This goods are light
  4 |      12 |      15 | t      | foods are good
  5 |      12 |      14 | f      | cloths are old
  6 |      12 |      11 | t      | foods are not good
  7 |      12 |       5 | t      | mangoes are not good
(7 rows)

blog_post_system=# select * from likes;
 id | user_id | post_id 
----+---------+---------
  1 |       1 |       1
  2 |       1 |       2
  3 |       2 |       1
  4 |       2 |       5
  5 |       2 |       6
  6 |       4 |       6
  7 |       4 |       6
  8 |       4 |      12
  9 |      14 |      12
 10 |      14 |      11
 11 |      11 |      11
(11 rows)

blog_post_system=# select count(P.id) from users U join posts P on U.id = P.user_id join categories C on C.id = P.category_id where U.name = 'Naveen' and C.name = 'Foods';
 count 
-------
     2
(1 row)

blog_post_system=# select count(P.id) from users U join posts P on U.id = P.user_id join categories C on C.id = P.category_id where U.name = 'Naveen';
 count 
-------
     5
(1 row)

blog_post_system=# select * from users;
 id |  name   | address  | paid 
----+---------+----------+------
  1 | Pankaj  | Patna    | f
  2 | Pankaj  | Patna    | t
  3 | Saurabh | Delhi    | t
  4 | Mohit   | Delhi    | f
  5 | Rohit   | Hariyana | f
  6 | Gundeep | Patiala  | t
  7 | Manjeet | Patiala  | t
  8 | Motilal | Chhapra  | f
  9 | Bittu   | Chhapra  | f
 10 | Bittu   | Patna    | t
 11 | Pavan   | Patna    | t
 12 | Pavan   | Chhapra  | t
 13 | Naveen  | Chhapra  | t
 14 | Naveen  | Patiala  | t
 15 | Praveen | Chhapra  | f
(15 rows)

blog_post_system=# insert into users values (16, 'John', 'Goa');
INSERT 0 1
blog_post_system=# select * from users;
 id |  name   | address  | paid 
----+---------+----------+------
  1 | Pankaj  | Patna    | f
  2 | Pankaj  | Patna    | t
  3 | Saurabh | Delhi    | t
  4 | Mohit   | Delhi    | f
  5 | Rohit   | Hariyana | f
  6 | Gundeep | Patiala  | t
  7 | Manjeet | Patiala  | t
  8 | Motilal | Chhapra  | f
  9 | Bittu   | Chhapra  | f
 10 | Bittu   | Patna    | t
 11 | Pavan   | Patna    | t
 12 | Pavan   | Chhapra  | t
 13 | Naveen  | Chhapra  | t
 14 | Naveen  | Patiala  | t
 15 | Praveen | Chhapra  | f
 16 | John    | Goa      | f
(16 rows)

blog_post_system=# \d
           List of relations
 Schema |    Name    | Type  |  Owner   
--------+------------+-------+----------
 public | categories | table | postgres
 public | comments   | table | postgres
 public | likes      | table | postgres
 public | posts      | table | postgres
 public | users      | table | postgres
(5 rows)

blog_post_system=# \d users;
            Table "public.users"
 Column  |       Type        |   Modifiers   
---------+-------------------+---------------
 id      | integer           | not null
 name    | character varying | not null
 address | character varying | not null
 paid    | boolean           | default false
Indexes:
    "users_pkey" PRIMARY KEY, btree (id)
Referenced by:
    TABLE "comments" CONSTRAINT "comments_user_id_fkey" FOREIGN KEY (user_id) REFERENCES users(id)
    TABLE "likes" CONSTRAINT "likes_user_id_fkey" FOREIGN KEY (user_id) REFERENCES users(id)
    TABLE "posts" CONSTRAINT "posts_user_id_fkey" FOREIGN KEY (user_id) REFERENCES users(id)

blog_post_system=# insert into users values (17, 'Doe', 'Goa', true);
INSERT 0 1
blog_post_system=# select * from users;
 id |  name   | address  | paid 
----+---------+----------+------
  1 | Pankaj  | Patna    | f
  2 | Pankaj  | Patna    | t
  3 | Saurabh | Delhi    | t
  4 | Mohit   | Delhi    | f
  5 | Rohit   | Hariyana | f
  6 | Gundeep | Patiala  | t
  7 | Manjeet | Patiala  | t
  8 | Motilal | Chhapra  | f
  9 | Bittu   | Chhapra  | f
 10 | Bittu   | Patna    | t
 11 | Pavan   | Patna    | t
 12 | Pavan   | Chhapra  | t
 13 | Naveen  | Chhapra  | t
 14 | Naveen  | Patiala  | t
 15 | Praveen | Chhapra  | f
 16 | John    | Goa      | f
 17 | Doe     | Goa      | t
(17 rows)

blog_post_system=# select * from users;
 id |  name   | address  | paid 
----+---------+----------+------
  1 | Pankaj  | Patna    | f
  2 | Pankaj  | Patna    | t
  3 | Saurabh | Delhi    | t
  4 | Mohit   | Delhi    | f
  5 | Rohit   | Hariyana | f
  6 | Gundeep | Patiala  | t
  7 | Manjeet | Patiala  | t
  8 | Motilal | Chhapra  | f
  9 | Bittu   | Chhapra  | f
 10 | Bittu   | Patna    | t
 11 | Pavan   | Patna    | t
 12 | Pavan   | Chhapra  | t
 13 | Naveen  | Chhapra  | t
 14 | Naveen  | Patiala  | t
 15 | Praveen | Chhapra  | f
 16 | John    | Goa      | f
 17 | Doe     | Goa      | t
(17 rows)

blog_post_system=# select * from posts;
 id | user_id |   title   |            content             | category_id 
----+---------+-----------+--------------------------------+-------------
  5 |      10 | a goods   | Goods are heavy.               |           1
  1 |       5 | a mango   | Mangoes are sweets.            |           2
  2 |       5 | a banana  | Bananas are sweets and yellow. |           2
  3 |      10 | a banana  | Bananas are sweets and yellow. |           2
  4 |      10 | a book    | Books are good.                |           5
  6 |       1 | a food    | foods are heavy.               |           3
  7 |       3 | a food    | foods are light.               |           3
  8 |      14 | a food    | foods are light.               |           3
  9 |      14 | the goods | goods are light.               |           1
 10 |      14 | a food    | foods are good.                |           3
 11 |      14 | a cloth   | cloths are red.                |           8
 12 |      14 | a wood    | woods are heavy.               |           4
 13 |       7 | a food    | foods are light.               |           3
 14 |       7 | a cloth   | cloths are red.                |           8
 15 |       7 | a food    | foods are heavy.               |           3
 16 |       7 | a goods   | Goods are heavy.               |           1
 17 |       7 | a goods   | Goods are heavy.               |           1
(17 rows)

blog_post_system=# select * from users where paid = false;
 id |  name   | address  | paid 
----+---------+----------+------
  1 | Pankaj  | Patna    | f
  4 | Mohit   | Delhi    | f
  5 | Rohit   | Hariyana | f
  8 | Motilal | Chhapra  | f
  9 | Bittu   | Chhapra  | f
 15 | Praveen | Chhapra  | f
 16 | John    | Goa      | f
(7 rows)

blog_post_system=# select count(P.id) from users U join posts P where U.paid = false;
ERROR:  syntax error at or near "where"
LINE 1: select count(P.id) from users U join posts P where U.paid = ...
                                                     ^
blog_post_system=# select count(P.id) from users U join posts P on U.id = P.user_id where U.paid = false;
 count 
-------
     3
(1 row)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# select count(P.id) from user U join post P on U.id = P.user_id group by U.id;
ERROR:  relation "post" does not exist
LINE 1: select count(P.id) from user U join post P on U.id = P.user_...
                                            ^
blog_post_system=# select count(P.id) from user U join posts P on U.id = P.user_id group by U.id;
ERROR:  column u.id does not exist
LINE 1: select count(P.id) from user U join posts P on U.id = P.user...
                                                       ^
HINT:  Perhaps you meant to reference the column "p.id".
blog_post_system=# select count(P.id) from users U join posts P on U.id = P.user_id group by U.id;
 count 
-------
     3
     2
     1
     1
     5
     5
(6 rows)

blog_post_system=# 
blog_post_system=# select U.id, U.name, count(P.id) from users U join posts P on U.id = P.user_id where U.paid = false group by U.id;
 id |  name  | count 
----+--------+-------
  1 | Pankaj |     1
  5 | Rohit  |     2
(2 rows)

blog_post_system=# select U.id, U.name, count(P.id) from users U left join posts P on U.id = P.user_id where U.paid = false group by U.id;
 id |  name   | count 
----+---------+-------
  8 | Motilal |     0
 16 | John    |     0
 15 | Praveen |     0
  4 | Mohit   |     0
  1 | Pankaj  |     1
  5 | Rohit   |     2
  9 | Bittu   |     0
(7 rows)

blog_post_system=# select U.id, U.name, count(P.id) from users U left outer join posts P on U.id = P.user_id where U.paid = false group by U.id;
 id |  name   | count 
----+---------+-------
  8 | Motilal |     0
 16 | John    |     0
 15 | Praveen |     0
  4 | Mohit   |     0
  1 | Pankaj  |     1
  5 | Rohit   |     2
  9 | Bittu   |     0
(7 rows)

blog_post_system=# select U.id, U.name, count(P.id), C.id, C.name from users U left outer join posts P on U.id = P.user_id join categories C on C.id = P.category_id where U.paid = false and C.name = 'Foods' group by U.id;
ERROR:  column "c.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, U.name, count(P.id), C.id, C.name from users U ...
                                          ^
blog_post_system=# select U.id, U.name, count(P.id) from users U left outer join posts P on U.id = P.user_id join categories C on C.id = P.category_id where U.paid = false and C.name = 'Foods' group by U.id;
 id |  name  | count 
----+--------+-------
  1 | Pankaj |     1
(1 row)

blog_post_system=# select U.id, U.name, count(P.id), C.id from users U left outer join posts P on U.id = P.user_id join categories C on C.id = P.category_id where U.paid = false and C.name = 'Foods' group by U.id;
ERROR:  column "c.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, U.name, count(P.id), C.id from users U left out...
                                          ^
blog_post_system=# select U.id, U.name, count(P.id), C.name from users U left outer join posts P on U.id = P.user_id join categories C on C.id = P.category_id where U.paid = false and C.name = 'Foods' group by U.id;
ERROR:  column "c.name" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, U.name, count(P.id), C.name from users U left o...
                                          ^
blog_post_system=# select U.id, U.name, count(P.id), C.name from users U left join posts P on U.id = P.user_id join categories C on C.id = P.category_id where U.paid = false and C.name = 'Foods' group by U.id;
ERROR:  column "c.name" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, U.name, count(P.id), C.name from users U left j...
                                          ^
blog_post_system=# select U.id, U.name, count(P.id) from users U left outer join posts P on U.id = P.user_id join categories C on C.id = P.category_id where U.paid = false and C.name = 'Foods' group by U.id;
 id |  name  | count 
----+--------+-------
  1 | Pankaj |     1
(1 row)

blog_post_system=# select U.id, U.name, count(P.id) from users U left outer join posts P on U.id = P.user_id where U.paid = false group by U.id;
 id |  name   | count 
----+---------+-------
  8 | Motilal |     0
 16 | John    |     0
 15 | Praveen |     0
  4 | Mohit   |     0
  1 | Pankaj  |     1
  5 | Rohit   |     2
  9 | Bittu   |     0
(7 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# (select U.id, U.name, P.id count(P.id) from users U left outer join posts P on U.id = P.user_id where U.paid = false group by U.id) join categories C on C.id = P.category_id;
ERROR:  syntax error at or near "("
LINE 1: (select U.id, U.name, P.id count(P.id) from users U left out...
                                        ^
blog_post_system=# select A.id, A.name, A.count, C.id, C.name  (select U.id, U.name, P.id count(P.id) from users U left outer join posts P on U.id = P.user_id where U.paid = false group by U.id) A join categories C on C.id = P.category_id;
ERROR:  syntax error at or near "select"
LINE 1: select A.id, A.name, A.count, C.id, C.name  (select U.id, U....
                                                     ^
blog_post_system=# select A.id, A.name, A.count, C.id, C.name from(select U.id, U.name, P.id count(P.id) from users U left outer join posts P on U.id = P.user_id where U.paid = false group by U.id) A join categories C on C.id = P.category_id;
ERROR:  syntax error at or near "("
LINE 1: ... C.id, C.name from(select U.id, U.name, P.id count(P.id) fro...
                                                             ^
blog_post_system=# select A.id, A.name, A.count(P.id), C.id, C.name from(select U.id, U.name, P.id count(P.id) from users U left outer join posts P on U.id = P.user_id where U.paid = false group by U.id) A join categories C on C.id = P.category_id;
ERROR:  syntax error at or near "("
LINE 1: ... C.id, C.name from(select U.id, U.name, P.id count(P.id) fro...
                                                             ^
blog_post_system=# select A.id, A.name, A.count(P.id), C.id, C.name from(select U.id, U.name, P.id from users U left outer join posts P on U.id = P.user_id where U.paid = false ) A join categories C on C.id = P.category_id;
ERROR:  missing FROM-clause entry for table "p"
LINE 1: ...re U.paid = false ) A join categories C on C.id = P.category...
                                                             ^
blog_post_system=# select U.id, U.name, count(P.id) from users U left outer join posts P on U.id = P.user_id where U.paid = false group by U.id;
 id |  name   | count 
----+---------+-------
  8 | Motilal |     0
 16 | John    |     0
 15 | Praveen |     0
  4 | Mohit   |     0
  1 | Pankaj  |     1
  5 | Rohit   |     2
  9 | Bittu   |     0
(7 rows)

blog_post_system=# select U.id, U.name,P.id,P.name count(P.id) from users U left outer join posts P on U.id = P.user_id where U.paid = false group by U.id;
ERROR:  syntax error at or near "("
LINE 1: select U.id, U.name,P.id,P.name count(P.id) from users U lef...
                                             ^
blog_post_system=# select U.id, U.name, P.id, P.name, count(P.id) from users U left outer join posts P on U.id = P.user_id where U.paid = false group by U.id;
ERROR:  column p.name does not exist
LINE 1: select U.id, U.name, P.id, P.name, count(P.id) from users U ...
                                   ^
HINT:  Perhaps you meant to reference the column "u.name".
blog_post_system=# select U.id, U.name, P.id, P.name, count(P.id) from users U left outer join posts P on U.id = P.user_id where U.paid = false group by U.id;
ERROR:  column p.name does not exist
LINE 1: select U.id, U.name, P.id, P.name, count(P.id) from users U ...
                                   ^
HINT:  Perhaps you meant to reference the column "u.name".
blog_post_system=# 
blog_post_system=# select U.id, U.name, P.id, P.name, count(P.id) from users U left outer join posts P on U.id = P.user_id where U.paid = false group by U.id;
ERROR:  column p.name does not exist
LINE 1: select U.id, U.name, P.id, P.name, count(P.id) from users U ...
                                   ^
HINT:  Perhaps you meant to reference the column "u.name".
blog_post_system=# select U.id, U.name, count(P.id) from users U left outer join posts P on U.id = P.user_id where U.paid = false group by U.id;
 id |  name   | count 
----+---------+-------
  8 | Motilal |     0
 16 | John    |     0
 15 | Praveen |     0
  4 | Mohit   |     0
  1 | Pankaj  |     1
  5 | Rohit   |     2
  9 | Bittu   |     0
(7 rows)

blog_post_system=# 
blog_post_system=# select U.id, U.name, P.id, count(P.id) from users U left outer join posts P on U.id = P.user_id where U.paid = false group by U.id; 
ERROR:  column "p.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, U.name, P.id, count(P.id) from users U left out...
                             ^
blog_post_system=# select U.id, U.name, P.name, count(P.id) from users U left outer join posts P on U.id = P.user_id where U.paid = false group by U.id;
ERROR:  column p.name does not exist
LINE 1: select U.id, U.name, P.name, count(P.id) from users U left o...
                             ^
HINT:  Perhaps you meant to reference the column "u.name".
blog_post_system=# select U.id, U.name, count(P.id) from users U left outer join posts P on U.id = P.user_id where U.paid = false group by U.id;
 id |  name   | count 
----+---------+-------
  8 | Motilal |     0
 16 | John    |     0
 15 | Praveen |     0
  4 | Mohit   |     0
  1 | Pankaj  |     1
  5 | Rohit   |     2
  9 | Bittu   |     0
(7 rows)

blog_post_system=# 
blog_post_system=# select U.id, U.name, count(P.id) from users U right outer join posts P on U.id = P.user_id where U.paid = false group by U.id;
 id |  name  | count 
----+--------+-------
  1 | Pankaj |     1
  5 | Rohit  |     2
(2 rows)

blog_post_system=# select U.id, U.name, count(P.id) from users U cross join posts P on U.id = P.user_id where U.paid = false group by U.id;
ERROR:  syntax error at or near "on"
LINE 1: ...name, count(P.id) from users U cross join posts P on U.id = ...
                                                             ^
blog_post_system=# select U.id, U.name, count(P.id) from users U inner join posts P on U.id = P.user_id where U.paid = false group by U.id;
 id |  name  | count 
----+--------+-------
  1 | Pankaj |     1
  5 | Rohit  |     2
(2 rows)

blog_post_system=# select U.id, U.name, count(P.id) from users U left outer join posts P on U.id = P.user_id where U.paid = false group by U.id;
 id |  name   | count 
----+---------+-------
  8 | Motilal |     0
 16 | John    |     0
 15 | Praveen |     0
  4 | Mohit   |     0
  1 | Pankaj  |     1
  5 | Rohit   |     2
  9 | Bittu   |     0
(7 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# select U.id, U.name, count(P.id) from users U left outer join posts P on U.id = P.user_id where U.paid = false group by U.id;
 id |  name   | count 
----+---------+-------
  8 | Motilal |     0
 16 | John    |     0
 15 | Praveen |     0
  4 | Mohit   |     0
  1 | Pankaj  |     1
  5 | Rohit   |     2
  9 | Bittu   |     0
(7 rows)

blog_post_system=# select U.id, U.name, count(P.id) from users U inner join posts P on U.id = P.user_id where U.paid = false group by U.id;
 id |  name  | count 
----+--------+-------
  1 | Pankaj |     1
  5 | Rohit  |     2
(2 rows)

blog_post_system=# select U.id, U.name, count(P.id) from users U inner join posts P  where U.paid = false group by U.id;
ERROR:  syntax error at or near "where"
LINE 1: ...ame, count(P.id) from users U inner join posts P  where U.pa...
                                                             ^
blog_post_system=# select U.id, U.name, count(P.id) from users U inner join posts P  ;
ERROR:  syntax error at or near ";"
LINE 1: ...U.id, U.name, count(P.id) from users U inner join posts P  ;
                                                                      ^
blog_post_system=# select U.id, U.name, count(P.id) from users U inner join posts P on U.id = P.user_id where U.paid = false group by U.id;
 id |  name  | count 
----+--------+-------
  1 | Pankaj |     1
  5 | Rohit  |     2
(2 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select U.id, U.name, count(P.id) from users U left outer join posts P on U.id = P.user_id where U.paid = false group by U.id;
 id |  name   | count 
----+---------+-------
  8 | Motilal |     0
 16 | John    |     0
 15 | Praveen |     0
  4 | Mohit   |     0
  1 | Pankaj  |     1
  5 | Rohit   |     2
  9 | Bittu   |     0
(7 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select U.id, U.name, from users U left outer join posts P on U.id = P.user_id where U.paid = false;
ERROR:  syntax error at or near "from"
LINE 1: select U.id, U.name, from users U left outer join posts P on...
                             ^
blog_post_system=# select U.id, U.name from users U left outer join posts P on U.id = P.user_id where U.paid = false;
 id |  name   
----+---------
  5 | Rohit
  5 | Rohit
  1 | Pankaj
 15 | Praveen
  8 | Motilal
 16 | John
  4 | Mohit
  9 | Bittu
(8 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select U.id, U.name, P.id, P.name from users U left outer join posts P on U.id = P.user_id where U.paid = false;
ERROR:  column p.name does not exist
LINE 1: select U.id, U.name, P.id, P.name from users U left outer jo...
                                   ^
HINT:  Perhaps you meant to reference the column "u.name".
blog_post_system=# \d posts;
            Table "public.posts"
   Column    |       Type        | Modifiers 
-------------+-------------------+-----------
 id          | integer           | not null
 user_id     | integer           | not null
 title       | character varying | not null
 content     | character varying | not null
 category_id | integer           | not null
Indexes:
    "posts_pkey" PRIMARY KEY, btree (id)
Foreign-key constraints:
    "posts_category_id_fkey" FOREIGN KEY (category_id) REFERENCES categories(id)
    "posts_user_id_fkey" FOREIGN KEY (user_id) REFERENCES users(id)
Referenced by:
    TABLE "comments" CONSTRAINT "comments_post_id_fkey" FOREIGN KEY (post_id) REFERENCES posts(id)
    TABLE "likes" CONSTRAINT "likes_post_id_fkey" FOREIGN KEY (post_id) REFERENCES posts(id)

blog_post_system=# select U.id, U.name, count(P.id) from users U left outer join posts P on U.id = P.user_id where U.paid = false group by U.id;
 id |  name   | count 
----+---------+-------
  8 | Motilal |     0
 16 | John    |     0
 15 | Praveen |     0
  4 | Mohit   |     0
  1 | Pankaj  |     1
  5 | Rohit   |     2
  9 | Bittu   |     0
(7 rows)

blog_post_system=# select U.id, U.name, count(P.id), P.id from users U left outer join posts P on U.id = P.user_id where U.paid = false group by U.id; 
ERROR:  column "p.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, U.name, count(P.id), P.id from users U left out...
                                          ^
blog_post_system=# select U.id, U.name, P.id, P.name from users U left outer join posts P on U.id = P.user_id where U.paid = false;
ERROR:  column p.name does not exist
LINE 1: select U.id, U.name, P.id, P.name from users U left outer jo...
                                   ^
HINT:  Perhaps you meant to reference the column "u.name".
blog_post_system=# select U.id, U.name, P.id, P.title from users U left outer join posts P on U.id = P.user_id where U.paid = false;
 id |  name   | id |  title   
----+---------+----+----------
  5 | Rohit   |  1 | a mango
  5 | Rohit   |  2 | a banana
  1 | Pankaj  |  6 | a food
 15 | Praveen |    | 
  8 | Motilal |    | 
 16 | John    |    | 
  4 | Mohit   |    | 
  9 | Bittu   |    | 
(8 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select U.id, U.name, P.id, P.title from users U left outer join posts P on U.id = P.user_id join categories C on C.id = P.category_id where U.paid = false;
 id |  name  | id |  title   
----+--------+----+----------
  5 | Rohit  |  1 | a mango
  5 | Rohit  |  2 | a banana
  1 | Pankaj |  6 | a food
(3 rows)

blog_post_system=# select U.id, U.name, P.id, P.title from users U left outer join posts P on U.id = P.user_id left outerjoin categories C on C.id = P.category_id where U.paid = false;
ERROR:  syntax error at or near "outerjoin"
LINE 1: ... left outer join posts P on U.id = P.user_id left outerjoin ...
                                                             ^
blog_post_system=# select U.id, U.name, P.id, P.title from users U left outer join posts P on U.id = P.user_id left outer join categories C on C.id = P.category_id where U.paid = false;
 id |  name   | id |  title   
----+---------+----+----------
  5 | Rohit   |  1 | a mango
  5 | Rohit   |  2 | a banana
  1 | Pankaj  |  6 | a food
 15 | Praveen |    | 
  8 | Motilal |    | 
 16 | John    |    | 
  4 | Mohit   |    | 
  9 | Bittu   |    | 
(8 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# select U.id, U.name, P.id, count(P.id) P.title from users U left outer join posts P on U.id = P.user_id left outer join categories C on C.id = P.category_id where U.paid = false;
ERROR:  syntax error at or near "."
LINE 1: select U.id, U.name, P.id, count(P.id) P.title from users U ...
                                                ^
blog_post_system=# select U.id, U.name, P.id, count(P.id), P.title from users U left outer join posts P on U.id = P.user_id left outer join categories C on C.id = P.category_id where U.paid = false;
ERROR:  column "u.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, U.name, P.id, count(P.id), P.title from users U...
               ^
blog_post_system=# select U.id, U.name, P.id, count(P.id), P.title from users U left outer join posts P on U.id = P.user_id left outer join categories C on C.id = P.category_id where U.paid = false group by U.id;
ERROR:  column "p.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, U.name, P.id, count(P.id), P.title from users U...
                             ^
blog_post_system=# select U.id, U.name, count(P.id), P.title from users U left outer join posts P on U.id = P.user_id left outer join categories C on C.id = P.category_id where U.paid = false group by U.id;
ERROR:  column "p.title" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, U.name, count(P.id), P.title from users U left ...
                                          ^
blog_post_system=# select U.id, U.name, count(P.id) from users U left outer join posts P on U.id = P.user_id left outer join categories C on C.id = P.category_id where U.paid = false group by U.id;
 id |  name   | count 
----+---------+-------
  8 | Motilal |     0
 16 | John    |     0
 15 | Praveen |     0
  4 | Mohit   |     0
  1 | Pankaj  |     1
  5 | Rohit   |     2
  9 | Bittu   |     0
(7 rows)

blog_post_system=# select U.id, U.name, count(P.id), C.id from users U left outer join posts P on U.id = P.user_id left outer join categories C on C.id = P.category_id where U.paid = false group by U.id;
ERROR:  column "c.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, U.name, count(P.id), C.id from users U left out...
                                          ^
blog_post_system=# select U.id, U.name, C.id from users U left outer join posts P on U.id = P.user_id left outer join categories C on C.id = P.category_id where U.paid = false;
 id |  name   | id 
----+---------+----
  5 | Rohit   |  2
  5 | Rohit   |  2
  1 | Pankaj  |  3
 15 | Praveen |   
  8 | Motilal |   
 16 | John    |   
  4 | Mohit   |   
  9 | Bittu   |   
(8 rows)

blog_post_system=# select U.id, U.name, C.id, C.name from users U left outer join posts P on U.id = P.user_id left outer join categories C on C.id = P.category_id where U.paid = false;
 id |  name   | id |  name  
----+---------+----+--------
  5 | Rohit   |  2 | Fruits
  5 | Rohit   |  2 | Fruits
  1 | Pankaj  |  3 | Foods
 15 | Praveen |    | 
  8 | Motilal |    | 
 16 | John    |    | 
  4 | Mohit   |    | 
  9 | Bittu   |    | 
(8 rows)

blog_post_system=# select U.id, U.name,P.id, C.id, C.name from users U left outer join posts P on U.id = P.user_id left outer join categories C on C.id = P.category_id where U.paid = false;
 id |  name   | id | id |  name  
----+---------+----+----+--------
  5 | Rohit   |  1 |  2 | Fruits
  5 | Rohit   |  2 |  2 | Fruits
  1 | Pankaj  |  6 |  3 | Foods
 15 | Praveen |    |    | 
  8 | Motilal |    |    | 
 16 | John    |    |    | 
  4 | Mohit   |    |    | 
  9 | Bittu   |    |    | 
(8 rows)

blog_post_system=# select U.id as user_id, U.name as user_name,P.id as post_id, C.id category_id, C.name as category_name from users U left outer join posts P on U.id = P.user_id left outer join categories C on C.id = P.category_id where U.paid = false;
 user_id | user_name | post_id | category_id | category_name 
---------+-----------+---------+-------------+---------------
       5 | Rohit     |       1 |           2 | Fruits
       5 | Rohit     |       2 |           2 | Fruits
       1 | Pankaj    |       6 |           3 | Foods
      15 | Praveen   |         |             | 
       8 | Motilal   |         |             | 
      16 | John      |         |             | 
       4 | Mohit     |         |             | 
       9 | Bittu     |         |             | 
(8 rows)

blog_post_system=# select U.id, U.name, P.id, P.title from users U left outer join posts P on U.id = P.user_id where U.paid = false;
 id |  name   | id |  title   
----+---------+----+----------
  5 | Rohit   |  1 | a mango
  5 | Rohit   |  2 | a banana
  1 | Pankaj  |  6 | a food
 15 | Praveen |    | 
  8 | Motilal |    | 
 16 | John    |    | 
  4 | Mohit   |    | 
  9 | Bittu   |    | 
(8 rows)

blog_post_system=# select U.id, U.name, count(P.id) from users U left outer join posts P on U.id = P.user_id where U.paid = false group by U.id;
 id |  name   | count 
----+---------+-------
  8 | Motilal |     0
 16 | John    |     0
 15 | Praveen |     0
  4 | Mohit   |     0
  1 | Pankaj  |     1
  5 | Rohit   |     2
  9 | Bittu   |     0
(7 rows)

blog_post_system=# select U.id, U.name, P.id, P.title from users U left outer join posts P on U.id = P.user_id where U.paid = false;
 id |  name   | id |  title   
----+---------+----+----------
  5 | Rohit   |  1 | a mango
  5 | Rohit   |  2 | a banana
  1 | Pankaj  |  6 | a food
 15 | Praveen |    | 
  8 | Motilal |    | 
 16 | John    |    | 
  4 | Mohit   |    | 
  9 | Bittu   |    | 
(8 rows)

blog_post_system=# select U.id, U.name, count(P.id) from users U left outer join posts P on U.id = P.user_id where U.paid = false group by U.id;
 id |  name   | count 
----+---------+-------
  8 | Motilal |     0
 16 | John    |     0
 15 | Praveen |     0
  4 | Mohit   |     0
  1 | Pankaj  |     1
  5 | Rohit   |     2
  9 | Bittu   |     0
(7 rows)

blog_post_system=# select U.id as user_id, U.name as user_name,P.id as post_id, C.id category_id, C.name as category_name from users U left outer join posts P on U.id = P.user_id left outer join categories C on C.id = P.category_id where U.paid = false;
 user_id | user_name | post_id | category_id | category_name 
---------+-----------+---------+-------------+---------------
       5 | Rohit     |       1 |           2 | Fruits
       5 | Rohit     |       2 |           2 | Fruits
       1 | Pankaj    |       6 |           3 | Foods
      15 | Praveen   |         |             | 
       8 | Motilal   |         |             | 
      16 | John      |         |             | 
       4 | Mohit     |         |             | 
       9 | Bittu     |         |             | 
(8 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select U.id as user_id, U.name as user_name,P.id as post_id, C.id category_id, C.name as category_name from users U left outer join posts P on U.id = P.user_id left outer join categories C on C.id = P.category_id where U.paid = false group by U.id;
ERROR:  column "p.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id as user_id, U.name as user_name,P.id as post_id,...
                                                    ^
blog_post_system=# select U.id as user_id, U.name as user_name,P.id as post_id, C.id category_id, C.name as category_name from users U left outer join posts P on U.id = P.user_id left outer join categories C on C.id = P.category_id where U.paid = false group by P.id;
ERROR:  column "u.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id as user_id, U.name as user_name,P.id as post_id,...
               ^
blog_post_system=# select U.id, U.name, count(P.id) from users U left outer join posts P on U.id = P.user_id where U.paid = false group by U.id;
 id |  name   | count 
----+---------+-------
  8 | Motilal |     0
 16 | John    |     0
 15 | Praveen |     0
  4 | Mohit   |     0
  1 | Pankaj  |     1
  5 | Rohit   |     2
  9 | Bittu   |     0
(7 rows)

blog_post_system=# select * from users U left outer join posts P on U.id = P.user_id;
 id |  name   | address  | paid | id | user_id |   title   |            content             | category_id 
----+---------+----------+------+----+---------+-----------+--------------------------------+-------------
 10 | Bittu   | Patna    | t    |  5 |      10 | a goods   | Goods are heavy.               |           1
  5 | Rohit   | Hariyana | f    |  1 |       5 | a mango   | Mangoes are sweets.            |           2
  5 | Rohit   | Hariyana | f    |  2 |       5 | a banana  | Bananas are sweets and yellow. |           2
 10 | Bittu   | Patna    | t    |  3 |      10 | a banana  | Bananas are sweets and yellow. |           2
 10 | Bittu   | Patna    | t    |  4 |      10 | a book    | Books are good.                |           5
  1 | Pankaj  | Patna    | f    |  6 |       1 | a food    | foods are heavy.               |           3
  3 | Saurabh | Delhi    | t    |  7 |       3 | a food    | foods are light.               |           3
 14 | Naveen  | Patiala  | t    |  8 |      14 | a food    | foods are light.               |           3
 14 | Naveen  | Patiala  | t    |  9 |      14 | the goods | goods are light.               |           1
 14 | Naveen  | Patiala  | t    | 10 |      14 | a food    | foods are good.                |           3
 14 | Naveen  | Patiala  | t    | 11 |      14 | a cloth   | cloths are red.                |           8
 14 | Naveen  | Patiala  | t    | 12 |      14 | a wood    | woods are heavy.               |           4
  7 | Manjeet | Patiala  | t    | 13 |       7 | a food    | foods are light.               |           3
  7 | Manjeet | Patiala  | t    | 14 |       7 | a cloth   | cloths are red.                |           8
  7 | Manjeet | Patiala  | t    | 15 |       7 | a food    | foods are heavy.               |           3
  7 | Manjeet | Patiala  | t    | 16 |       7 | a goods   | Goods are heavy.               |           1
  7 | Manjeet | Patiala  | t    | 17 |       7 | a goods   | Goods are heavy.               |           1
 11 | Pavan   | Patna    | t    |    |         |           |                                |            
 17 | Doe     | Goa      | t    |    |         |           |                                |            
 12 | Pavan   | Chhapra  | t    |    |         |           |                                |            
  2 | Pankaj  | Patna    | t    |    |         |           |                                |            
 15 | Praveen | Chhapra  | f    |    |         |           |                                |            
 13 | Naveen  | Chhapra  | t    |    |         |           |                                |            
  8 | Motilal | Chhapra  | f    |    |         |           |                                |            
  6 | Gundeep | Patiala  | t    |    |         |           |                                |            
 16 | John    | Goa      | f    |    |         |           |                                |            
  4 | Mohit   | Delhi    | f    |    |         |           |                                |            
  9 | Bittu   | Chhapra  | f    |    |         |           |                                |            
(28 rows)

blog_post_system=# select * from users U left outer join posts P on U.id = P.user_id left outer join categories C on c.id = P.category_id;
 id |  name   | address  | paid | id | user_id |   title   |            content             | category_id | id |  name  
----+---------+----------+------+----+---------+-----------+--------------------------------+-------------+----+--------
 10 | Bittu   | Patna    | t    |  5 |      10 | a goods   | Goods are heavy.               |           1 |  1 | Goods
  5 | Rohit   | Hariyana | f    |  1 |       5 | a mango   | Mangoes are sweets.            |           2 |  2 | Fruits
  5 | Rohit   | Hariyana | f    |  2 |       5 | a banana  | Bananas are sweets and yellow. |           2 |  2 | Fruits
 10 | Bittu   | Patna    | t    |  3 |      10 | a banana  | Bananas are sweets and yellow. |           2 |  2 | Fruits
 10 | Bittu   | Patna    | t    |  4 |      10 | a book    | Books are good.                |           5 |  5 | Books
  1 | Pankaj  | Patna    | f    |  6 |       1 | a food    | foods are heavy.               |           3 |  3 | Foods
  3 | Saurabh | Delhi    | t    |  7 |       3 | a food    | foods are light.               |           3 |  3 | Foods
 14 | Naveen  | Patiala  | t    |  8 |      14 | a food    | foods are light.               |           3 |  3 | Foods
 14 | Naveen  | Patiala  | t    |  9 |      14 | the goods | goods are light.               |           1 |  1 | Goods
 14 | Naveen  | Patiala  | t    | 10 |      14 | a food    | foods are good.                |           3 |  3 | Foods
 14 | Naveen  | Patiala  | t    | 11 |      14 | a cloth   | cloths are red.                |           8 |  8 | Cloths
 14 | Naveen  | Patiala  | t    | 12 |      14 | a wood    | woods are heavy.               |           4 |  4 | Woods
  7 | Manjeet | Patiala  | t    | 13 |       7 | a food    | foods are light.               |           3 |  3 | Foods
  7 | Manjeet | Patiala  | t    | 14 |       7 | a cloth   | cloths are red.                |           8 |  8 | Cloths
  7 | Manjeet | Patiala  | t    | 15 |       7 | a food    | foods are heavy.               |           3 |  3 | Foods
  7 | Manjeet | Patiala  | t    | 16 |       7 | a goods   | Goods are heavy.               |           1 |  1 | Goods
  7 | Manjeet | Patiala  | t    | 17 |       7 | a goods   | Goods are heavy.               |           1 |  1 | Goods
 11 | Pavan   | Patna    | t    |    |         |           |                                |             |    | 
 17 | Doe     | Goa      | t    |    |         |           |                                |             |    | 
 12 | Pavan   | Chhapra  | t    |    |         |           |                                |             |    | 
  2 | Pankaj  | Patna    | t    |    |         |           |                                |             |    | 
 15 | Praveen | Chhapra  | f    |    |         |           |                                |             |    | 
 13 | Naveen  | Chhapra  | t    |    |         |           |                                |             |    | 
  8 | Motilal | Chhapra  | f    |    |         |           |                                |             |    | 
  6 | Gundeep | Patiala  | t    |    |         |           |                                |             |    | 
 16 | John    | Goa      | f    |    |         |           |                                |             |    | 
  4 | Mohit   | Delhi    | f    |    |         |           |                                |             |    | 
  9 | Bittu   | Chhapra  | f    |    |         |           |                                |             |    | 
(28 rows)

blog_post_system=# select * from users U left outer join posts P on U.id = P.user_id left outer join categories C on c.id = P.category_id where C.name = 'Foods';
 id |  name   | address | paid | id | user_id | title  |     content      | category_id | id | name  
----+---------+---------+------+----+---------+--------+------------------+-------------+----+-------
  1 | Pankaj  | Patna   | f    |  6 |       1 | a food | foods are heavy. |           3 |  3 | Foods
  3 | Saurabh | Delhi   | t    |  7 |       3 | a food | foods are light. |           3 |  3 | Foods
 14 | Naveen  | Patiala | t    |  8 |      14 | a food | foods are light. |           3 |  3 | Foods
 14 | Naveen  | Patiala | t    | 10 |      14 | a food | foods are good.  |           3 |  3 | Foods
  7 | Manjeet | Patiala | t    | 13 |       7 | a food | foods are light. |           3 |  3 | Foods
  7 | Manjeet | Patiala | t    | 15 |       7 | a food | foods are heavy. |           3 |  3 | Foods
(6 rows)

blog_post_system=# select * from users U left outer join posts P on U.id = P.user_id left outer join categories C on c.id = P.category_id where C.name = 'Foods' ;
 id |  name   | address | paid | id | user_id | title  |     content      | category_id | id | name  
----+---------+---------+------+----+---------+--------+------------------+-------------+----+-------
  1 | Pankaj  | Patna   | f    |  6 |       1 | a food | foods are heavy. |           3 |  3 | Foods
  3 | Saurabh | Delhi   | t    |  7 |       3 | a food | foods are light. |           3 |  3 | Foods
 14 | Naveen  | Patiala | t    |  8 |      14 | a food | foods are light. |           3 |  3 | Foods
 14 | Naveen  | Patiala | t    | 10 |      14 | a food | foods are good.  |           3 |  3 | Foods
  7 | Manjeet | Patiala | t    | 13 |       7 | a food | foods are light. |           3 |  3 | Foods
  7 | Manjeet | Patiala | t    | 15 |       7 | a food | foods are heavy. |           3 |  3 | Foods
(6 rows)

blog_post_system=# select U.id as user_id, U.name as user_name, U.paid as Paid_user, count(P.id) as post_count from users U left outer join posts P on U.id = P.user_id left outer join categories C on c.id = P.category_id where C.name = 'Foods' ;
ERROR:  column "u.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id as user_id, U.name as user_name, U.paid as Paid_...
               ^
blog_post_system=# select U.name as user_name, U.paid as Paid_user, count(P.id) as post_count from users U left outer join posts P on U.id = P.user_id left outer join categories C on c.id = P.category_id where C.name = 'Foods' ;
ERROR:  column "u.name" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.name as user_name, U.paid as Paid_user, count(P.id)...
               ^
blog_post_system=# select U.paid as Paid_user, count(P.id) as post_count from users U left outer join posts P on U.id = P.user_id left outer join categories C on c.id = P.category_id where C.name = 'Foods' ;
ERROR:  column "u.paid" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.paid as Paid_user, count(P.id) as post_count from u...
               ^
blog_post_system=# select count(P.id) as post_count from users U left outer join posts P on U.id = P.user_id left outer join categories C on c.id = P.category_id where C.name = 'Foods' ;
 post_count 
------------
          6
(1 row)

blog_post_system=# select count(P.id) as post_count from users U left outer join posts P on U.id = P.user_id left outer join categories C on c.id = P.category_id where C.name = 'Foods' and U.paid = false ;
 post_count 
------------
          1
(1 row)

blog_post_system=# select count(P.id) as post_count from users U left outer join posts P on U.id = P.user_id left outer join categories C on c.id = P.category_id where C.name = 'Foods' and U.paid = false group by U.id;
 post_count 
------------
          1
(1 row)

blog_post_system=# select U.id, count(P.id) as post_count from users U left outer join posts P on U.id = P.user_id left outer join categories C on c.id = P.category_id where C.name = 'Foods' and U.paid = false group by U.id;
 id | post_count 
----+------------
  1 |          1
(1 row)

blog_post_system=# select U.id, count(P.id), C.name as post_count from users U left outer join posts P on U.id = P.user_id left outer join categories C on c.id = P.category_id where C.name = 'Foods' and U.paid = false group by U.id;
ERROR:  column "c.name" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, count(P.id), C.name as post_count from users U ...
                                  ^
blog_post_system=# select U.id, count(P.id) as post_count, C.name from users U left outer join posts P on U.id = P.user_id left outer join categories C on c.id = P.category_id where C.name = 'Foods' and U.paid = false group by U.id;
ERROR:  column "c.name" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, count(P.id) as post_count, C.name from users U ...
                                                ^
blog_post_system=# select U.id, count(P.id) as post_count from users U left outer join posts P on U.id = P.user_id left outer join categories C on c.id = P.category_id where C.name = 'Foods' and U.paid = false group by U.id;
 id | post_count 
----+------------
  1 |          1
(1 row)

blog_post_system=# select U.id, count(P.id) as post_count from users U left outer join posts P on U.id = P.user_id left outer join categories C on c.id = P.category_id where C.name = 'Foods' and U.paid = false group by U.id;
 id | post_count 
----+------------
  1 |          1
(1 row)

blog_post_system=# select U.id, count(P.id) as post_count from users U left outer join posts P on U.id = P.user_id left outer join categories C on c.id = P.category_id where C.name = 'Foods' and U.paid = false group by U.id;
 id | post_count 
----+------------
  1 |          1
(1 row)

blog_post_system=# select count(P.id) as post_count from users U left outer join posts P on U.id = P.user_id left outer join categories C on c.id = P.category_id where C.name = 'Foods' and U.paid = false group by U.id;
 post_count 
------------
          1
(1 row)

blog_post_system=# select count(P.id) as post_count from users U left outer join posts P on U.id = P.user_id left outer join categories C on c.id = P.category_id where C.name = 'Foods' group by U.id;
 post_count 
------------
          2
          1
          1
          2
(4 rows)

blog_post_system=# create view as count_views select count(P.id) as post_count from users U left outer join posts P on U.id = P.user_id left outer join categories C on c.id = P.category_id where C.name = 'Foods' group by U.id;
ERROR:  syntax error at or near "as"
LINE 1: create view as count_views select count(P.id) as post_count ...
                    ^
blog_post_system=# create view count_views as select count(P.id) as post_count from users U left outer join posts P on U.id = P.user_id left outer join categories C on c.id = P.category_id where C.name = 'Foods' group by U.id;
CREATE VIEW
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select * from views;
ERROR:  relation "views" does not exist
LINE 1: select * from views;
                      ^
blog_post_system=# select * from count_views;
 post_count 
------------
          2
          1
          1
          2
(4 rows)

blog_post_system=# select U.id, count(P.id) as post_count from users U left outer join posts P on U.id = P.user_id left outer join categories C on c.id = P.category_id where C.name = 'Foods' and U.paid = false group by U.id;
 id | post_count 
----+------------
  1 |          1
(1 row)

blog_post_system=# select U.id, count(P.id) as post_count, C.name from users U left outer join posts P on U.id = P.user_id left outer join categories C on c.id = P.category_id where C.name = 'Foods' and U.paid = false group by U.id;
ERROR:  column "c.name" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, count(P.id) as post_count, C.name from users U ...
                                                ^
blog_post_system=# create view as count_views select count(P.id) as post_count from users U left outer join posts P on U.id = P.user_id left outer join categories C on c.id = P.category_id where C.name = 'Foods' group by U.id;from users U left outer join posts P on U.id = P.user_id left outer join categories C on c.id = P.category_id where C.name = 'Foods';
ERROR:  syntax error at or near "as"
LINE 1: create view as count_views select count(P.id) as post_count ...
                    ^
ERROR:  syntax error at or near "from"
LINE 1: from users U left outer join posts P on U.id = P.user_id lef...
        ^
blog_post_system=# from users U left outer join posts P on U.id = P.user_id left outer join categories C on c.id = P.category_id where C.name = 'Foods';
ERROR:  syntax error at or near "from"
LINE 1: from users U left outer join posts P on U.id = P.user_id lef...
        ^
blog_post_system=# select * from users U left outer join posts P on U.id = P.user_id left outer join categories C on c.id = P.category_id where C.name = 'Foods';
 id |  name   | address | paid | id | user_id | title  |     content      | category_id | id | name  
----+---------+---------+------+----+---------+--------+------------------+-------------+----+-------
  1 | Pankaj  | Patna   | f    |  6 |       1 | a food | foods are heavy. |           3 |  3 | Foods
  3 | Saurabh | Delhi   | t    |  7 |       3 | a food | foods are light. |           3 |  3 | Foods
 14 | Naveen  | Patiala | t    |  8 |      14 | a food | foods are light. |           3 |  3 | Foods
 14 | Naveen  | Patiala | t    | 10 |      14 | a food | foods are good.  |           3 |  3 | Foods
  7 | Manjeet | Patiala | t    | 13 |       7 | a food | foods are light. |           3 |  3 | Foods
  7 | Manjeet | Patiala | t    | 15 |       7 | a food | foods are heavy. |           3 |  3 | Foods
(6 rows)

blog_post_system=# select U.name from users U left outer join posts P on U.id = P.user_id left outer join categories C on c.id = P.category_id where C.name = 'Foods';
  name   
---------
 Pankaj
 Saurabh
 Naveen
 Naveen
 Manjeet
 Manjeet
(6 rows)

blog_post_system=# select U.name, (select * from count_views) from users U left outer join posts P on U.id = P.user_id left outer join categories C on c.id = P.category_id where C.name = 'Foods';
ERROR:  more than one row returned by a subquery used as an expression
blog_post_system=# 
blog_post_system=# select U.id, U.name, count(P.id) from users U left outer join posts P on U.id = P.user_id where U.paid = false group by U.id;
 id |  name   | count 
----+---------+-------
  8 | Motilal |     0
 16 | John    |     0
 15 | Praveen |     0
  4 | Mohit   |     0
  1 | Pankaj  |     1
  5 | Rohit   |     2
  9 | Bittu   |     0
(7 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# select * from users U1 left outer join posts P1 on U1.id = P1.user_id left outer join categories C1 on C1.id = P1.category_id  select U.id, U.name, count(P.id) from users U left outer join posts P on U.id = P.user_id where U.paid = false group by U.id;
ERROR:  syntax error at or near "select"
LINE 1: ...ter join categories C1 on C1.id = P1.category_id  select U.i...
                                                             ^
blog_post_system=# select * from users U1 left outer join posts P1 on U1.id = P1.user_id left outer join categories C1 on C1.id = P1.category_id;
 id |  name   | address  | paid | id | user_id |   title   |            content             | category_id | id |  name  
----+---------+----------+------+----+---------+-----------+--------------------------------+-------------+----+--------
 10 | Bittu   | Patna    | t    |  5 |      10 | a goods   | Goods are heavy.               |           1 |  1 | Goods
  5 | Rohit   | Hariyana | f    |  1 |       5 | a mango   | Mangoes are sweets.            |           2 |  2 | Fruits
  5 | Rohit   | Hariyana | f    |  2 |       5 | a banana  | Bananas are sweets and yellow. |           2 |  2 | Fruits
 10 | Bittu   | Patna    | t    |  3 |      10 | a banana  | Bananas are sweets and yellow. |           2 |  2 | Fruits
 10 | Bittu   | Patna    | t    |  4 |      10 | a book    | Books are good.                |           5 |  5 | Books
  1 | Pankaj  | Patna    | f    |  6 |       1 | a food    | foods are heavy.               |           3 |  3 | Foods
  3 | Saurabh | Delhi    | t    |  7 |       3 | a food    | foods are light.               |           3 |  3 | Foods
 14 | Naveen  | Patiala  | t    |  8 |      14 | a food    | foods are light.               |           3 |  3 | Foods
 14 | Naveen  | Patiala  | t    |  9 |      14 | the goods | goods are light.               |           1 |  1 | Goods
 14 | Naveen  | Patiala  | t    | 10 |      14 | a food    | foods are good.                |           3 |  3 | Foods
 14 | Naveen  | Patiala  | t    | 11 |      14 | a cloth   | cloths are red.                |           8 |  8 | Cloths
 14 | Naveen  | Patiala  | t    | 12 |      14 | a wood    | woods are heavy.               |           4 |  4 | Woods
  7 | Manjeet | Patiala  | t    | 13 |       7 | a food    | foods are light.               |           3 |  3 | Foods
  7 | Manjeet | Patiala  | t    | 14 |       7 | a cloth   | cloths are red.                |           8 |  8 | Cloths
  7 | Manjeet | Patiala  | t    | 15 |       7 | a food    | foods are heavy.               |           3 |  3 | Foods
  7 | Manjeet | Patiala  | t    | 16 |       7 | a goods   | Goods are heavy.               |           1 |  1 | Goods
  7 | Manjeet | Patiala  | t    | 17 |       7 | a goods   | Goods are heavy.               |           1 |  1 | Goods
 11 | Pavan   | Patna    | t    |    |         |           |                                |             |    | 
 17 | Doe     | Goa      | t    |    |         |           |                                |             |    | 
 12 | Pavan   | Chhapra  | t    |    |         |           |                                |             |    | 
  2 | Pankaj  | Patna    | t    |    |         |           |                                |             |    | 
 15 | Praveen | Chhapra  | f    |    |         |           |                                |             |    | 
 13 | Naveen  | Chhapra  | t    |    |         |           |                                |             |    | 
  8 | Motilal | Chhapra  | f    |    |         |           |                                |             |    | 
  6 | Gundeep | Patiala  | t    |    |         |           |                                |             |    | 
 16 | John    | Goa      | f    |    |         |           |                                |             |    | 
  4 | Mohit   | Delhi    | f    |    |         |           |                                |             |    | 
  9 | Bittu   | Chhapra  | f    |    |         |           |                                |             |    | 
(28 rows)

blog_post_system=# select * from users U1 left outer join posts P1 on U1.id = P1.user_id left outer join categories C1 on C1.id = P1.category_id  select U.id, U.name, count(P.id) from users U left outer join posts P on U.id = P.user_id where U.paid = false group by U.id;
ERROR:  syntax error at or near "select"
LINE 1: ...ter join categories C1 on C1.id = P1.category_id  select U.i...
                                                             ^
blog_post_system=# select * from users U1 left outer join posts P1 on U1.id = P1.user_id left outer join categories C1 on C1.id = P1.category_id;
 id |  name   | address  | paid | id | user_id |   title   |            content             | category_id | id |  name  
----+---------+----------+------+----+---------+-----------+--------------------------------+-------------+----+--------
 10 | Bittu   | Patna    | t    |  5 |      10 | a goods   | Goods are heavy.               |           1 |  1 | Goods
  5 | Rohit   | Hariyana | f    |  1 |       5 | a mango   | Mangoes are sweets.            |           2 |  2 | Fruits
  5 | Rohit   | Hariyana | f    |  2 |       5 | a banana  | Bananas are sweets and yellow. |           2 |  2 | Fruits
 10 | Bittu   | Patna    | t    |  3 |      10 | a banana  | Bananas are sweets and yellow. |           2 |  2 | Fruits
 10 | Bittu   | Patna    | t    |  4 |      10 | a book    | Books are good.                |           5 |  5 | Books
  1 | Pankaj  | Patna    | f    |  6 |       1 | a food    | foods are heavy.               |           3 |  3 | Foods
  3 | Saurabh | Delhi    | t    |  7 |       3 | a food    | foods are light.               |           3 |  3 | Foods
 14 | Naveen  | Patiala  | t    |  8 |      14 | a food    | foods are light.               |           3 |  3 | Foods
 14 | Naveen  | Patiala  | t    |  9 |      14 | the goods | goods are light.               |           1 |  1 | Goods
 14 | Naveen  | Patiala  | t    | 10 |      14 | a food    | foods are good.                |           3 |  3 | Foods
 14 | Naveen  | Patiala  | t    | 11 |      14 | a cloth   | cloths are red.                |           8 |  8 | Cloths
 14 | Naveen  | Patiala  | t    | 12 |      14 | a wood    | woods are heavy.               |           4 |  4 | Woods
  7 | Manjeet | Patiala  | t    | 13 |       7 | a food    | foods are light.               |           3 |  3 | Foods
  7 | Manjeet | Patiala  | t    | 14 |       7 | a cloth   | cloths are red.                |           8 |  8 | Cloths
  7 | Manjeet | Patiala  | t    | 15 |       7 | a food    | foods are heavy.               |           3 |  3 | Foods
  7 | Manjeet | Patiala  | t    | 16 |       7 | a goods   | Goods are heavy.               |           1 |  1 | Goods
  7 | Manjeet | Patiala  | t    | 17 |       7 | a goods   | Goods are heavy.               |           1 |  1 | Goods
 11 | Pavan   | Patna    | t    |    |         |           |                                |             |    | 
 17 | Doe     | Goa      | t    |    |         |           |                                |             |    | 
 12 | Pavan   | Chhapra  | t    |    |         |           |                                |             |    | 
  2 | Pankaj  | Patna    | t    |    |         |           |                                |             |    | 
 15 | Praveen | Chhapra  | f    |    |         |           |                                |             |    | 
 13 | Naveen  | Chhapra  | t    |    |         |           |                                |             |    | 
  8 | Motilal | Chhapra  | f    |    |         |           |                                |             |    | 
  6 | Gundeep | Patiala  | t    |    |         |           |                                |             |    | 
 16 | John    | Goa      | f    |    |         |           |                                |             |    | 
  4 | Mohit   | Delhi    | f    |    |         |           |                                |             |    | 
  9 | Bittu   | Chhapra  | f    |    |         |           |                                |             |    | 
(28 rows)

blog_post_system=# select * from users U1 left outer join posts P1 on U1.id = P1.user_id left outer join categories C1 on C1.id = P1.category_id where U1.paid = true;
 id |  name   | address | paid | id | user_id |   title   |            content             | category_id | id |  name  
----+---------+---------+------+----+---------+-----------+--------------------------------+-------------+----+--------
 10 | Bittu   | Patna   | t    |  5 |      10 | a goods   | Goods are heavy.               |           1 |  1 | Goods
 10 | Bittu   | Patna   | t    |  3 |      10 | a banana  | Bananas are sweets and yellow. |           2 |  2 | Fruits
 10 | Bittu   | Patna   | t    |  4 |      10 | a book    | Books are good.                |           5 |  5 | Books
  3 | Saurabh | Delhi   | t    |  7 |       3 | a food    | foods are light.               |           3 |  3 | Foods
 14 | Naveen  | Patiala | t    |  8 |      14 | a food    | foods are light.               |           3 |  3 | Foods
 14 | Naveen  | Patiala | t    |  9 |      14 | the goods | goods are light.               |           1 |  1 | Goods
 14 | Naveen  | Patiala | t    | 10 |      14 | a food    | foods are good.                |           3 |  3 | Foods
 14 | Naveen  | Patiala | t    | 11 |      14 | a cloth   | cloths are red.                |           8 |  8 | Cloths
 14 | Naveen  | Patiala | t    | 12 |      14 | a wood    | woods are heavy.               |           4 |  4 | Woods
  7 | Manjeet | Patiala | t    | 13 |       7 | a food    | foods are light.               |           3 |  3 | Foods
  7 | Manjeet | Patiala | t    | 14 |       7 | a cloth   | cloths are red.                |           8 |  8 | Cloths
  7 | Manjeet | Patiala | t    | 15 |       7 | a food    | foods are heavy.               |           3 |  3 | Foods
  7 | Manjeet | Patiala | t    | 16 |       7 | a goods   | Goods are heavy.               |           1 |  1 | Goods
  7 | Manjeet | Patiala | t    | 17 |       7 | a goods   | Goods are heavy.               |           1 |  1 | Goods
 11 | Pavan   | Patna   | t    |    |         |           |                                |             |    | 
 17 | Doe     | Goa     | t    |    |         |           |                                |             |    | 
 12 | Pavan   | Chhapra | t    |    |         |           |                                |             |    | 
  2 | Pankaj  | Patna   | t    |    |         |           |                                |             |    | 
 13 | Naveen  | Chhapra | t    |    |         |           |                                |             |    | 
  6 | Gundeep | Patiala | t    |    |         |           |                                |             |    | 
(20 rows)

blog_post_system=# select * from users U1 left outer join posts P1 on U1.id = P1.user_id left outer join categories C1 on C1.id = P1.category_id where U1.paid = true group by U1.id;
ERROR:  column "p1.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select * from users U1 left outer join posts P1 on U1.id = P...
               ^
blog_post_system=# select  from users U1 left outer join posts P1 on U1.id = P1.user_id left outer join categories C1 on C1.id = P1.category_id where U1.paid = true group by U1.id;
--
(10 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select count(P1.id) from users U1 left outer join posts P1 on U1.id = P1.user_id left outer join categories C1 on C1.id = P1.category_id where U1.paid = true group by U1.id;
 count 
-------
     0
     0
     0
     3
     0
     0
     0
     1
     5
     5
(10 rows)

blog_post_system=# select C1.name count(P1.id) from users U1 left outer join posts P1 on U1.id = P1.user_id left outer join categories C1 on C1.id = P1.category_id where U1.paid = true group by U1.id;
ERROR:  syntax error at or near "("
LINE 1: select C1.name count(P1.id) from users U1 left outer join po...
                            ^
blog_post_system=# select U1.name count(P1.id) from users U1 left outer join posts P1 on U1.id = P1.user_id left outer join categories C1 on C1.id = P1.category_id where U1.paid = true group by U1.id;
ERROR:  syntax error at or near "("
LINE 1: select U1.name count(P1.id) from users U1 left outer join po...
                            ^
blog_post_system=# select count(P1.id) from users U1 left outer join posts P1 on U1.id = P1.user_id left outer join categories C1 on C1.id = P1.category_id where U1.paid = true group by U1.id;
 count 
-------
     0
     0
     0
     3
     0
     0
     0
     1
     5
     5
(10 rows)

blog_post_system=# select count(P1.id) from users U1 left outer join posts P1 on U1.id = P1.user_id left outer join categories C1 on C1.id = P1.category_id where U1.paid = true group by U1.id having count(P1.id) > 2;
 count 
-------
     3
     5
     5
(3 rows)

blog_post_system=# select * from users U1 left outer join posts P1 on U1.id = P1.user_id left outer join categories C1 on C1.id = P1.category_id where U1.paid = true group by U1.id;
ERROR:  column "p1.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select * from users U1 left outer join posts P1 on U1.id = P...
               ^
blog_post_system=# select * from users U1 left outer join posts P1 on U1.id = P1.user_id left outer join categories C1 on C1.id = P1.category_id;
 id |  name   | address  | paid | id | user_id |   title   |            content             | category_id | id |  name  
----+---------+----------+------+----+---------+-----------+--------------------------------+-------------+----+--------
 10 | Bittu   | Patna    | t    |  5 |      10 | a goods   | Goods are heavy.               |           1 |  1 | Goods
  5 | Rohit   | Hariyana | f    |  1 |       5 | a mango   | Mangoes are sweets.            |           2 |  2 | Fruits
  5 | Rohit   | Hariyana | f    |  2 |       5 | a banana  | Bananas are sweets and yellow. |           2 |  2 | Fruits
 10 | Bittu   | Patna    | t    |  3 |      10 | a banana  | Bananas are sweets and yellow. |           2 |  2 | Fruits
 10 | Bittu   | Patna    | t    |  4 |      10 | a book    | Books are good.                |           5 |  5 | Books
  1 | Pankaj  | Patna    | f    |  6 |       1 | a food    | foods are heavy.               |           3 |  3 | Foods
  3 | Saurabh | Delhi    | t    |  7 |       3 | a food    | foods are light.               |           3 |  3 | Foods
 14 | Naveen  | Patiala  | t    |  8 |      14 | a food    | foods are light.               |           3 |  3 | Foods
 14 | Naveen  | Patiala  | t    |  9 |      14 | the goods | goods are light.               |           1 |  1 | Goods
 14 | Naveen  | Patiala  | t    | 10 |      14 | a food    | foods are good.                |           3 |  3 | Foods
 14 | Naveen  | Patiala  | t    | 11 |      14 | a cloth   | cloths are red.                |           8 |  8 | Cloths
 14 | Naveen  | Patiala  | t    | 12 |      14 | a wood    | woods are heavy.               |           4 |  4 | Woods
  7 | Manjeet | Patiala  | t    | 13 |       7 | a food    | foods are light.               |           3 |  3 | Foods
  7 | Manjeet | Patiala  | t    | 14 |       7 | a cloth   | cloths are red.                |           8 |  8 | Cloths
  7 | Manjeet | Patiala  | t    | 15 |       7 | a food    | foods are heavy.               |           3 |  3 | Foods
  7 | Manjeet | Patiala  | t    | 16 |       7 | a goods   | Goods are heavy.               |           1 |  1 | Goods
  7 | Manjeet | Patiala  | t    | 17 |       7 | a goods   | Goods are heavy.               |           1 |  1 | Goods
 11 | Pavan   | Patna    | t    |    |         |           |                                |             |    | 
 17 | Doe     | Goa      | t    |    |         |           |                                |             |    | 
 12 | Pavan   | Chhapra  | t    |    |         |           |                                |             |    | 
  2 | Pankaj  | Patna    | t    |    |         |           |                                |             |    | 
 15 | Praveen | Chhapra  | f    |    |         |           |                                |             |    | 
 13 | Naveen  | Chhapra  | t    |    |         |           |                                |             |    | 
  8 | Motilal | Chhapra  | f    |    |         |           |                                |             |    | 
  6 | Gundeep | Patiala  | t    |    |         |           |                                |             |    | 
 16 | John    | Goa      | f    |    |         |           |                                |             |    | 
  4 | Mohit   | Delhi    | f    |    |         |           |                                |             |    | 
  9 | Bittu   | Chhapra  | f    |    |         |           |                                |             |    | 
(28 rows)

blog_post_system=# select * from users U1 full outer join posts P1 on U1.id = P1.user_id left outer join categories C1 on C1.id = P1.category_id;
 id |  name   | address  | paid | id | user_id |   title   |            content             | category_id | id |  name  
----+---------+----------+------+----+---------+-----------+--------------------------------+-------------+----+--------
 10 | Bittu   | Patna    | t    |  5 |      10 | a goods   | Goods are heavy.               |           1 |  1 | Goods
  5 | Rohit   | Hariyana | f    |  1 |       5 | a mango   | Mangoes are sweets.            |           2 |  2 | Fruits
  5 | Rohit   | Hariyana | f    |  2 |       5 | a banana  | Bananas are sweets and yellow. |           2 |  2 | Fruits
 10 | Bittu   | Patna    | t    |  3 |      10 | a banana  | Bananas are sweets and yellow. |           2 |  2 | Fruits
 10 | Bittu   | Patna    | t    |  4 |      10 | a book    | Books are good.                |           5 |  5 | Books
  1 | Pankaj  | Patna    | f    |  6 |       1 | a food    | foods are heavy.               |           3 |  3 | Foods
  3 | Saurabh | Delhi    | t    |  7 |       3 | a food    | foods are light.               |           3 |  3 | Foods
 14 | Naveen  | Patiala  | t    |  8 |      14 | a food    | foods are light.               |           3 |  3 | Foods
 14 | Naveen  | Patiala  | t    |  9 |      14 | the goods | goods are light.               |           1 |  1 | Goods
 14 | Naveen  | Patiala  | t    | 10 |      14 | a food    | foods are good.                |           3 |  3 | Foods
 14 | Naveen  | Patiala  | t    | 11 |      14 | a cloth   | cloths are red.                |           8 |  8 | Cloths
 14 | Naveen  | Patiala  | t    | 12 |      14 | a wood    | woods are heavy.               |           4 |  4 | Woods
  7 | Manjeet | Patiala  | t    | 13 |       7 | a food    | foods are light.               |           3 |  3 | Foods
  7 | Manjeet | Patiala  | t    | 14 |       7 | a cloth   | cloths are red.                |           8 |  8 | Cloths
  7 | Manjeet | Patiala  | t    | 15 |       7 | a food    | foods are heavy.               |           3 |  3 | Foods
  7 | Manjeet | Patiala  | t    | 16 |       7 | a goods   | Goods are heavy.               |           1 |  1 | Goods
  7 | Manjeet | Patiala  | t    | 17 |       7 | a goods   | Goods are heavy.               |           1 |  1 | Goods
 11 | Pavan   | Patna    | t    |    |         |           |                                |             |    | 
 17 | Doe     | Goa      | t    |    |         |           |                                |             |    | 
 12 | Pavan   | Chhapra  | t    |    |         |           |                                |             |    | 
  2 | Pankaj  | Patna    | t    |    |         |           |                                |             |    | 
 15 | Praveen | Chhapra  | f    |    |         |           |                                |             |    | 
 13 | Naveen  | Chhapra  | t    |    |         |           |                                |             |    | 
  8 | Motilal | Chhapra  | f    |    |         |           |                                |             |    | 
  6 | Gundeep | Patiala  | t    |    |         |           |                                |             |    | 
 16 | John    | Goa      | f    |    |         |           |                                |             |    | 
  4 | Mohit   | Delhi    | f    |    |         |           |                                |             |    | 
  9 | Bittu   | Chhapra  | f    |    |         |           |                                |             |    | 
(28 rows)

blog_post_system=# select * from users U1 full outer join posts P1 on U1.id = P1.user_id full outer join categories C1 on C1.id = P1.category_id;
 id |  name   | address  | paid | id | user_id |   title   |            content             | category_id | id |   name    
----+---------+----------+------+----+---------+-----------+--------------------------------+-------------+----+-----------
 10 | Bittu   | Patna    | t    |  5 |      10 | a goods   | Goods are heavy.               |           1 |  1 | Goods
  5 | Rohit   | Hariyana | f    |  1 |       5 | a mango   | Mangoes are sweets.            |           2 |  2 | Fruits
  5 | Rohit   | Hariyana | f    |  2 |       5 | a banana  | Bananas are sweets and yellow. |           2 |  2 | Fruits
 10 | Bittu   | Patna    | t    |  3 |      10 | a banana  | Bananas are sweets and yellow. |           2 |  2 | Fruits
 10 | Bittu   | Patna    | t    |  4 |      10 | a book    | Books are good.                |           5 |  5 | Books
  1 | Pankaj  | Patna    | f    |  6 |       1 | a food    | foods are heavy.               |           3 |  3 | Foods
  3 | Saurabh | Delhi    | t    |  7 |       3 | a food    | foods are light.               |           3 |  3 | Foods
 14 | Naveen  | Patiala  | t    |  8 |      14 | a food    | foods are light.               |           3 |  3 | Foods
 14 | Naveen  | Patiala  | t    |  9 |      14 | the goods | goods are light.               |           1 |  1 | Goods
 14 | Naveen  | Patiala  | t    | 10 |      14 | a food    | foods are good.                |           3 |  3 | Foods
 14 | Naveen  | Patiala  | t    | 11 |      14 | a cloth   | cloths are red.                |           8 |  8 | Cloths
 14 | Naveen  | Patiala  | t    | 12 |      14 | a wood    | woods are heavy.               |           4 |  4 | Woods
  7 | Manjeet | Patiala  | t    | 13 |       7 | a food    | foods are light.               |           3 |  3 | Foods
  7 | Manjeet | Patiala  | t    | 14 |       7 | a cloth   | cloths are red.                |           8 |  8 | Cloths
  7 | Manjeet | Patiala  | t    | 15 |       7 | a food    | foods are heavy.               |           3 |  3 | Foods
  7 | Manjeet | Patiala  | t    | 16 |       7 | a goods   | Goods are heavy.               |           1 |  1 | Goods
  7 | Manjeet | Patiala  | t    | 17 |       7 | a goods   | Goods are heavy.               |           1 |  1 | Goods
 11 | Pavan   | Patna    | t    |    |         |           |                                |             |    | 
 17 | Doe     | Goa      | t    |    |         |           |                                |             |    | 
 12 | Pavan   | Chhapra  | t    |    |         |           |                                |             |    | 
  2 | Pankaj  | Patna    | t    |    |         |           |                                |             |    | 
 15 | Praveen | Chhapra  | f    |    |         |           |                                |             |    | 
 13 | Naveen  | Chhapra  | t    |    |         |           |                                |             |    | 
  8 | Motilal | Chhapra  | f    |    |         |           |                                |             |    | 
  6 | Gundeep | Patiala  | t    |    |         |           |                                |             |    | 
 16 | John    | Goa      | f    |    |         |           |                                |             |    | 
  4 | Mohit   | Delhi    | f    |    |         |           |                                |             |    | 
  9 | Bittu   | Chhapra  | f    |    |         |           |                                |             |    | 
    |         |          |      |    |         |           |                                |             |  6 | Health
    |         |          |      |    |         |           |                                |             |  7 | Medicines
(30 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select U.id, U.name, count(P.id) from users U left outer join posts P on U.id = P.user_id where U.paid = false group by U.id;
 id |  name   | count 
----+---------+-------
  8 | Motilal |     0
 16 | John    |     0
 15 | Praveen |     0
  4 | Mohit   |     0
  1 | Pankaj  |     1
  5 | Rohit   |     2
  9 | Bittu   |     0
(7 rows)

blog_post_system=# select U.id, U.name, count(P.id) from users U full outer join posts P on U.id = P.user_id where U.paid = false group by U.id;
 id |  name   | count 
----+---------+-------
  8 | Motilal |     0
 16 | John    |     0
 15 | Praveen |     0
  4 | Mohit   |     0
  1 | Pankaj  |     1
  5 | Rohit   |     2
  9 | Bittu   |     0
(7 rows)

blog_post_system=# select * from users U1 full outer join posts P1 on U1.id = P1.user_id full outer join categories C1 on C1.id = P1.category_id;
 id |  name   | address  | paid | id | user_id |   title   |            content             | category_id | id |   name    
----+---------+----------+------+----+---------+-----------+--------------------------------+-------------+----+-----------
 10 | Bittu   | Patna    | t    |  5 |      10 | a goods   | Goods are heavy.               |           1 |  1 | Goods
  5 | Rohit   | Hariyana | f    |  1 |       5 | a mango   | Mangoes are sweets.            |           2 |  2 | Fruits
  5 | Rohit   | Hariyana | f    |  2 |       5 | a banana  | Bananas are sweets and yellow. |           2 |  2 | Fruits
 10 | Bittu   | Patna    | t    |  3 |      10 | a banana  | Bananas are sweets and yellow. |           2 |  2 | Fruits
 10 | Bittu   | Patna    | t    |  4 |      10 | a book    | Books are good.                |           5 |  5 | Books
  1 | Pankaj  | Patna    | f    |  6 |       1 | a food    | foods are heavy.               |           3 |  3 | Foods
  3 | Saurabh | Delhi    | t    |  7 |       3 | a food    | foods are light.               |           3 |  3 | Foods
 14 | Naveen  | Patiala  | t    |  8 |      14 | a food    | foods are light.               |           3 |  3 | Foods
 14 | Naveen  | Patiala  | t    |  9 |      14 | the goods | goods are light.               |           1 |  1 | Goods
 14 | Naveen  | Patiala  | t    | 10 |      14 | a food    | foods are good.                |           3 |  3 | Foods
 14 | Naveen  | Patiala  | t    | 11 |      14 | a cloth   | cloths are red.                |           8 |  8 | Cloths
 14 | Naveen  | Patiala  | t    | 12 |      14 | a wood    | woods are heavy.               |           4 |  4 | Woods
  7 | Manjeet | Patiala  | t    | 13 |       7 | a food    | foods are light.               |           3 |  3 | Foods
  7 | Manjeet | Patiala  | t    | 14 |       7 | a cloth   | cloths are red.                |           8 |  8 | Cloths
  7 | Manjeet | Patiala  | t    | 15 |       7 | a food    | foods are heavy.               |           3 |  3 | Foods
  7 | Manjeet | Patiala  | t    | 16 |       7 | a goods   | Goods are heavy.               |           1 |  1 | Goods
  7 | Manjeet | Patiala  | t    | 17 |       7 | a goods   | Goods are heavy.               |           1 |  1 | Goods
 11 | Pavan   | Patna    | t    |    |         |           |                                |             |    | 
 17 | Doe     | Goa      | t    |    |         |           |                                |             |    | 
 12 | Pavan   | Chhapra  | t    |    |         |           |                                |             |    | 
  2 | Pankaj  | Patna    | t    |    |         |           |                                |             |    | 
 15 | Praveen | Chhapra  | f    |    |         |           |                                |             |    | 
 13 | Naveen  | Chhapra  | t    |    |         |           |                                |             |    | 
  8 | Motilal | Chhapra  | f    |    |         |           |                                |             |    | 
  6 | Gundeep | Patiala  | t    |    |         |           |                                |             |    | 
 16 | John    | Goa      | f    |    |         |           |                                |             |    | 
  4 | Mohit   | Delhi    | f    |    |         |           |                                |             |    | 
  9 | Bittu   | Chhapra  | f    |    |         |           |                                |             |    | 
    |         |          |      |    |         |           |                                |             |  6 | Health
    |         |          |      |    |         |           |                                |             |  7 | Medicines
(30 rows)

blog_post_system=# select * from users U1 full outer join posts P1 on U1.id = P1.user_id full outer join categories C1 on C1.id = P1.category_id where U1.paid = false;
 id |  name   | address  | paid | id | user_id |  title   |            content             | category_id | id |  name  
----+---------+----------+------+----+---------+----------+--------------------------------+-------------+----+--------
  5 | Rohit   | Hariyana | f    |  1 |       5 | a mango  | Mangoes are sweets.            |           2 |  2 | Fruits
  5 | Rohit   | Hariyana | f    |  2 |       5 | a banana | Bananas are sweets and yellow. |           2 |  2 | Fruits
  1 | Pankaj  | Patna    | f    |  6 |       1 | a food   | foods are heavy.               |           3 |  3 | Foods
 15 | Praveen | Chhapra  | f    |    |         |          |                                |             |    | 
  8 | Motilal | Chhapra  | f    |    |         |          |                                |             |    | 
 16 | John    | Goa      | f    |    |         |          |                                |             |    | 
  4 | Mohit   | Delhi    | f    |    |         |          |                                |             |    | 
  9 | Bittu   | Chhapra  | f    |    |         |          |                                |             |    | 
(8 rows)

blog_post_system=# select * from users U1 full outer join posts P1 on U1.id = P1.user_id full outer join categories C1 on C1.id = P1.category_id where U1.paid = true;
 id |  name   | address | paid | id | user_id |   title   |            content             | category_id | id |  name  
----+---------+---------+------+----+---------+-----------+--------------------------------+-------------+----+--------
 10 | Bittu   | Patna   | t    |  5 |      10 | a goods   | Goods are heavy.               |           1 |  1 | Goods
 10 | Bittu   | Patna   | t    |  3 |      10 | a banana  | Bananas are sweets and yellow. |           2 |  2 | Fruits
 10 | Bittu   | Patna   | t    |  4 |      10 | a book    | Books are good.                |           5 |  5 | Books
  3 | Saurabh | Delhi   | t    |  7 |       3 | a food    | foods are light.               |           3 |  3 | Foods
 14 | Naveen  | Patiala | t    |  8 |      14 | a food    | foods are light.               |           3 |  3 | Foods
 14 | Naveen  | Patiala | t    |  9 |      14 | the goods | goods are light.               |           1 |  1 | Goods
 14 | Naveen  | Patiala | t    | 10 |      14 | a food    | foods are good.                |           3 |  3 | Foods
 14 | Naveen  | Patiala | t    | 11 |      14 | a cloth   | cloths are red.                |           8 |  8 | Cloths
 14 | Naveen  | Patiala | t    | 12 |      14 | a wood    | woods are heavy.               |           4 |  4 | Woods
  7 | Manjeet | Patiala | t    | 13 |       7 | a food    | foods are light.               |           3 |  3 | Foods
  7 | Manjeet | Patiala | t    | 14 |       7 | a cloth   | cloths are red.                |           8 |  8 | Cloths
  7 | Manjeet | Patiala | t    | 15 |       7 | a food    | foods are heavy.               |           3 |  3 | Foods
  7 | Manjeet | Patiala | t    | 16 |       7 | a goods   | Goods are heavy.               |           1 |  1 | Goods
  7 | Manjeet | Patiala | t    | 17 |       7 | a goods   | Goods are heavy.               |           1 |  1 | Goods
 11 | Pavan   | Patna   | t    |    |         |           |                                |             |    | 
 17 | Doe     | Goa     | t    |    |         |           |                                |             |    | 
 12 | Pavan   | Chhapra | t    |    |         |           |                                |             |    | 
  2 | Pankaj  | Patna   | t    |    |         |           |                                |             |    | 
 13 | Naveen  | Chhapra | t    |    |         |           |                                |             |    | 
  6 | Gundeep | Patiala | t    |    |         |           |                                |             |    | 
(20 rows)

blog_post_system=# (select * from users U1 full outer join posts P1 on U1.id = P1.user_id full outer join categories C1 on C1.id = P1.category_id where U1.paid = true) as Information;
ERROR:  syntax error at or near "as"
LINE 1: ...1 on C1.id = P1.category_id where U1.paid = true) as Informa...
                                                             ^
blog_post_system=# (select * from users U1 full outer join posts P1 on U1.id = P1.user_id full outer join categories C1 on C1.id = P1.category_id where U1.paid = true) as INFO;
ERROR:  syntax error at or near "as"
LINE 1: ... C1 on C1.id = P1.category_id where U1.paid = true) as INFO;
                                                               ^
blog_post_system=# (select * from users U1 full outer join posts P1 on U1.id = P1.user_id full outer join categories C1 on C1.id = P1.category_id where U1.paid = true)  INFO;
ERROR:  syntax error at or near "INFO"
LINE 1: ...es C1 on C1.id = P1.category_id where U1.paid = true)  INFO;
                                                                  ^
blog_post_system=# select (select * from users U1 full outer join posts P1 on U1.id = P1.user_id full outer join categories C1 on C1.id = P1.category_id where U1.paid = true)  INFO;
ERROR:  subquery must return only one column
LINE 1: select (select * from users U1 full outer join posts P1 on U...
               ^
blog_post_system=# select (select * from users U1 full outer join posts P1 on U1.id = P1.user_id full outer join categories C1 on C1.id = P1.category_id where U1.paid = true) as INFO;
ERROR:  subquery must return only one column
LINE 1: select (select * from users U1 full outer join posts P1 on U...
               ^
blog_post_system=# select(select * from users U1 full outer join posts P1 on U1.id = P1.user_id full outer join categories C1 on C1.id = P1.category_id where U1.paid = true)  INFO;
ERROR:  subquery must return only one column
LINE 1: select(select * from users U1 full outer join posts P1 on U1...
              ^
blog_post_system=# select(select * from users U1 full outer join posts P1 on U1.id = P1.user_id full outer join categories C1 on C1.id = P1.category_id where U1.paid = true) as INFO;
ERROR:  subquery must return only one column
LINE 1: select(select * from users U1 full outer join posts P1 on U1...
              ^
blog_post_system=# select * from users U1 full outer join posts P1 on U1.id = P1.user_id full outer join categories C1 on C1.id = P1.category_id;
 id |  name   | address  | paid | id | user_id |   title   |            content             | category_id | id |   name    
----+---------+----------+------+----+---------+-----------+--------------------------------+-------------+----+-----------
 10 | Bittu   | Patna    | t    |  5 |      10 | a goods   | Goods are heavy.               |           1 |  1 | Goods
  5 | Rohit   | Hariyana | f    |  1 |       5 | a mango   | Mangoes are sweets.            |           2 |  2 | Fruits
  5 | Rohit   | Hariyana | f    |  2 |       5 | a banana  | Bananas are sweets and yellow. |           2 |  2 | Fruits
 10 | Bittu   | Patna    | t    |  3 |      10 | a banana  | Bananas are sweets and yellow. |           2 |  2 | Fruits
 10 | Bittu   | Patna    | t    |  4 |      10 | a book    | Books are good.                |           5 |  5 | Books
  1 | Pankaj  | Patna    | f    |  6 |       1 | a food    | foods are heavy.               |           3 |  3 | Foods
  3 | Saurabh | Delhi    | t    |  7 |       3 | a food    | foods are light.               |           3 |  3 | Foods
 14 | Naveen  | Patiala  | t    |  8 |      14 | a food    | foods are light.               |           3 |  3 | Foods
 14 | Naveen  | Patiala  | t    |  9 |      14 | the goods | goods are light.               |           1 |  1 | Goods
 14 | Naveen  | Patiala  | t    | 10 |      14 | a food    | foods are good.                |           3 |  3 | Foods
 14 | Naveen  | Patiala  | t    | 11 |      14 | a cloth   | cloths are red.                |           8 |  8 | Cloths
 14 | Naveen  | Patiala  | t    | 12 |      14 | a wood    | woods are heavy.               |           4 |  4 | Woods
  7 | Manjeet | Patiala  | t    | 13 |       7 | a food    | foods are light.               |           3 |  3 | Foods
  7 | Manjeet | Patiala  | t    | 14 |       7 | a cloth   | cloths are red.                |           8 |  8 | Cloths
  7 | Manjeet | Patiala  | t    | 15 |       7 | a food    | foods are heavy.               |           3 |  3 | Foods
  7 | Manjeet | Patiala  | t    | 16 |       7 | a goods   | Goods are heavy.               |           1 |  1 | Goods
  7 | Manjeet | Patiala  | t    | 17 |       7 | a goods   | Goods are heavy.               |           1 |  1 | Goods
 11 | Pavan   | Patna    | t    |    |         |           |                                |             |    | 
 17 | Doe     | Goa      | t    |    |         |           |                                |             |    | 
 12 | Pavan   | Chhapra  | t    |    |         |           |                                |             |    | 
  2 | Pankaj  | Patna    | t    |    |         |           |                                |             |    | 
 15 | Praveen | Chhapra  | f    |    |         |           |                                |             |    | 
 13 | Naveen  | Chhapra  | t    |    |         |           |                                |             |    | 
  8 | Motilal | Chhapra  | f    |    |         |           |                                |             |    | 
  6 | Gundeep | Patiala  | t    |    |         |           |                                |             |    | 
 16 | John    | Goa      | f    |    |         |           |                                |             |    | 
  4 | Mohit   | Delhi    | f    |    |         |           |                                |             |    | 
  9 | Bittu   | Chhapra  | f    |    |         |           |                                |             |    | 
    |         |          |      |    |         |           |                                |             |  6 | Health
    |         |          |      |    |         |           |                                |             |  7 | Medicines
(30 rows)

blog_post_system=# select count(P1.id) from users U1 left outer join posts P1 on U1.id = P1.user_id left outer join categories C1 on C1.id = P1.category_id where U1.paid = true group by U1.id having count(P1.id) > 2;
 count 
-------
     3
     5
     5
(3 rows)

blog_post_system=# select(select count(P1.id) from users U1 left outer join posts P1 on U1.id = P1.user_id left outer join categories C1 on C1.id = P1.category_id where U1.paid = true group by U1.id having count(P1.id) > 2) as CNT;
ERROR:  more than one row returned by a subquery used as an expression
blog_post_system=# select(select max(P1.id) from users U1 left outer join posts P1 on U1.id = P1.user_id left outer join categories C1 on C1.id = P1.category_id where U1.paid = true group by U1.id having count(P1.id) > 2) as CNT;
ERROR:  more than one row returned by a subquery used as an expression
blog_post_system=# select(select max(P1.id) from users U1 left outer join posts P1 on U1.id = P1.user_id left outer join categories C1 on C1.id = P1.category_id where U1.paid = true group by U1.id having count(P1.id) > 2) as M;
ERROR:  more than one row returned by a subquery used as an expression
blog_post_system=# select(select max(P1.id) from users U1 left outer join posts P1 on U1.id = P1.user_id left outer join categories C1 on C1.id = P1.category_id where U1.paid = true) as M;
 m  
----
 17
(1 row)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select count(P1.id) from users U1 left outer join posts P1 on U1.id = P1.user_id left outer join categories C1 on C1.id = P1.category_id where U1.paid = true group by U1.id having count(P1.id) > 2;
 count 
-------
     3
     5
     5
(3 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# alter table users alter column id type serial;
ERROR:  type "serial" does not exist
blog_post_system=# create table pk (id serial primary key);
CREATE TABLE
blog_post_system=# \d
             List of relations
 Schema |    Name     |   Type   |  Owner   
--------+-------------+----------+----------
 public | categories  | table    | postgres
 public | comments    | table    | postgres
 public | count_views | view     | postgres
 public | likes       | table    | postgres
 public | pk          | table    | postgres
 public | pk_id_seq   | sequence | postgres
 public | posts       | table    | postgres
 public | users       | table    | postgres
(8 rows)

blog_post_system=# drop table pk;
DROP TABLE
blog_post_system=# \d
            List of relations
 Schema |    Name     | Type  |  Owner   
--------+-------------+-------+----------
 public | categories  | table | postgres
 public | comments    | table | postgres
 public | count_views | view  | postgres
 public | likes       | table | postgres
 public | posts       | table | postgres
 public | users       | table | postgres
(6 rows)

blog_post_system=# create table pk (id int primary key);
CREATE TABLE
blog_post_system=# \d
            List of relations
 Schema |    Name     | Type  |  Owner   
--------+-------------+-------+----------
 public | categories  | table | postgres
 public | comments    | table | postgres
 public | count_views | view  | postgres
 public | likes       | table | postgres
 public | pk          | table | postgres
 public | posts       | table | postgres
 public | users       | table | postgres
(7 rows)

blog_post_system=# alter table pk alter column id type serial;
ERROR:  type "serial" does not exist
blog_post_system=# alter table pk alter column id serial;
ERROR:  syntax error at or near "serial"
LINE 1: alter table pk alter column id serial;
                                       ^
blog_post_system=# 
blog_post_system=# 
blog_post_system=# \d pk
      Table "public.pk"
 Column |  Type   | Modifiers 
--------+---------+-----------
 id     | integer | not null
Indexes:
    "pk_pkey" PRIMARY KEY, btree (id)

blog_post_system=# alter table pk add column roll int;
ALTER TABLE
blog_post_system=# \d pk
      Table "public.pk"
 Column |  Type   | Modifiers 
--------+---------+-----------
 id     | integer | not null
 roll   | integer | 
Indexes:
    "pk_pkey" PRIMARY KEY, btree (id)

blog_post_system=# alter table pk alter column roll serial;
ERROR:  syntax error at or near "serial"
LINE 1: alter table pk alter column roll serial;
                                         ^
blog_post_system=# alter table pk alter column roll type serial;
ERROR:  type "serial" does not exist
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# alter table pk alter column roll type varchar;
ALTER TABLE
blog_post_system=# alter table pk alter column roll type int;
ERROR:  column "roll" cannot be cast automatically to type integer
HINT:  You might need to specify "USING roll::integer".
blog_post_system=# alter table pk alter column roll type int using roll::integer;
ALTER TABLE
blog_post_system=# \d pk
      Table "public.pk"
 Column |  Type   | Modifiers 
--------+---------+-----------
 id     | integer | not null
 roll   | integer | 
Indexes:
    "pk_pkey" PRIMARY KEY, btree (id)

blog_post_system=# alter table pk drop column roll;
ALTER TABLE
blog_post_system=# \d pk
      Table "public.pk"
 Column |  Type   | Modifiers 
--------+---------+-----------
 id     | integer | not null
Indexes:
    "pk_pkey" PRIMARY KEY, btree (id)

blog_post_system=# alter table pk drop column id;
ALTER TABLE
blog_post_system=# \d pk
     Table "public.pk"
 Column | Type | Modifiers 
--------+------+-----------

blog_post_system=# alter table pk add column id serial primary key;
ALTER TABLE
blog_post_system=# \d pk
                         Table "public.pk"
 Column |  Type   |                    Modifiers                    
--------+---------+-------------------------------------------------
 id     | integer | not null default nextval('pk_id_seq'::regclass)
Indexes:
    "pk_pkey" PRIMARY KEY, btree (id)

blog_post_system=# 
blog_post_system=# insert into pk values();
ERROR:  syntax error at or near ")"
LINE 1: insert into pk values();
                              ^
blog_post_system=# insert into pk values(1);
INSERT 0 1
blog_post_system=# select * from pk
blog_post_system-# ;
 id 
----
  1
(1 row)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# insert into pk values(10);
INSERT 0 1
blog_post_system=# select * from pk;
 id 
----
  1
 10
(2 rows)

blog_post_system=# insert into pk (id) values ();
ERROR:  syntax error at or near ")"
LINE 1: insert into pk (id) values ();
                                    ^
blog_post_system=# insert into pk (id) values ('');
ERROR:  invalid input syntax for integer: ""
LINE 1: insert into pk (id) values ('');
                                    ^
blog_post_system=# insert into pk (id) values (2);
INSERT 0 1
blog_post_system=# select * from pk;
 id 
----
  1
 10
  2
(3 rows)

blog_post_system=# insert into pk (id) values (2);
ERROR:  duplicate key value violates unique constraint "pk_pkey"
DETAIL:  Key (id)=(2) already exists.
blog_post_system=# alter table pk add column roll int;
ALTER TABLE
blog_post_system=# select * from pk;
 id | roll 
----+------
  1 |     
 10 |     
  2 |     
(3 rows)

blog_post_system=# 
blog_post_system=# insert into pk (roll) values (2);
ERROR:  duplicate key value violates unique constraint "pk_pkey"
DETAIL:  Key (id)=(1) already exists.
blog_post_system=# insert into pk (roll) values (5);
ERROR:  duplicate key value violates unique constraint "pk_pkey"
DETAIL:  Key (id)=(2) already exists.
blog_post_system=# insert into pk (id,roll) values (5);
ERROR:  INSERT has more target columns than expressions
LINE 1: insert into pk (id,roll) values (5);
                           ^
blog_post_system=# insert into pk (id, roll) values (5, 5);
INSERT 0 1
blog_post_system=# 
blog_post_system=# insert into pk (roll,id) values (50);
ERROR:  INSERT has more target columns than expressions
LINE 1: insert into pk (roll,id) values (50);
                             ^
blog_post_system=# insert into pk (roll,id) values (50,);
ERROR:  syntax error at or near ")"
LINE 1: insert into pk (roll,id) values (50,);
                                            ^
blog_post_system=# insert into pk (roll,id) values (50, '');
ERROR:  invalid input syntax for integer: ""
LINE 1: insert into pk (roll,id) values (50, '');
                                             ^
blog_post_system=# insert into pk values ();
ERROR:  syntax error at or near ")"
LINE 1: insert into pk values ();
                               ^
blog_post_system=# 
blog_post_system=# insert into pk values (roll = 50);
ERROR:  column "roll" does not exist
LINE 1: insert into pk values (roll = 50);
                               ^
HINT:  There is a column named "roll" in table "pk", but it cannot be referenced from this part of the query.
blog_post_system=# insert into pk (id,roll) values (50);
ERROR:  INSERT has more target columns than expressions
LINE 1: insert into pk (id,roll) values (50);
                           ^
blog_post_system=# insert into pk (id, roll) values (50,10);
INSERT 0 1
blog_post_system=# insert into pk (id, roll) values (,10);
ERROR:  syntax error at or near ","
LINE 1: insert into pk (id, roll) values (,10);
                                          ^
blog_post_system=# insert into pk (id, roll) values ("",10);
ERROR:  zero-length delimited identifier at or near """"
LINE 1: insert into pk (id, roll) values ("",10);
                                          ^
blog_post_system=# insert into pk (id, roll) values ('',10);
ERROR:  invalid input syntax for integer: ""
LINE 1: insert into pk (id, roll) values ('',10);
                                          ^
blog_post_system=# insert into pk (id, roll) values (20,10);
INSERT 0 1
blog_post_system=# insert into pk (id, roll) values (20,10);
ERROR:  duplicate key value violates unique constraint "pk_pkey"
DETAIL:  Key (id)=(20) already exists.
blog_post_system=# delete from pk
blog_post_system-# ;
DELETE 6
blog_post_system=# 
blog_post_system=# 
blog_post_system=# insert into pk (id, roll) values ('',10);
ERROR:  invalid input syntax for integer: ""
LINE 1: insert into pk (id, roll) values ('',10);
                                          ^
blog_post_system=# insert into pk (id, roll) values (0,10);
INSERT 0 1
blog_post_system=# insert into pk (id, roll) values (0,10);
ERROR:  duplicate key value violates unique constraint "pk_pkey"
DETAIL:  Key (id)=(0) already exists.
blog_post_system=# \d 
             List of relations
 Schema |    Name     |   Type   |  Owner   
--------+-------------+----------+----------
 public | categories  | table    | postgres
 public | comments    | table    | postgres
 public | count_views | view     | postgres
 public | likes       | table    | postgres
 public | pk          | table    | postgres
 public | pk_id_seq   | sequence | postgres
 public | posts       | table    | postgres
 public | users       | table    | postgres
(8 rows)

blog_post_system=# insert into pk (roll) values (10);
INSERT 0 1
blog_post_system=# insert into pk (roll) values (10);
INSERT 0 1
blog_post_system=# insert into pk (roll) values (12);
INSERT 0 1
blog_post_system=# insert into pk (roll) values (120);
INSERT 0 1
blog_post_system=# select * from pk;
 id | roll 
----+------
  0 |   10
  3 |   10
  4 |   10
  5 |   12
  6 |  120
(5 rows)

blog_post_system=# delete from pk
;
DELETE 5
blog_post_system=# insert into pk (roll) values (101);
INSERT 0 1
blog_post_system=# select * from pk;
 id | roll 
----+------
  7 |  101
(1 row)

blog_post_system=# insert into pk (roll) values (101);
INSERT 0 1
blog_post_system=# insert into pk (roll) values (101);
INSERT 0 1
blog_post_system=# insert into pk (roll) values (101);
INSERT 0 1
blog_post_system=# insert into pk (roll) values (101);
INSERT 0 1
blog_post_system=# insert into pk (roll) values (101);
INSERT 0 1
blog_post_system=# select * from pk;
 id | roll 
----+------
  7 |  101
  8 |  101
  9 |  101
 10 |  101
 11 |  101
 12 |  101
(6 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# delete from pk
;
DELETE 6
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select * from users U1 full outer join posts P1 on U1.id = P1.user_id full outer join categories C1 on C1.id = P1.category_id;
 id |  name   | address  | paid | id | user_id |   title   |            content             | category_id | id |   name    
----+---------+----------+------+----+---------+-----------+--------------------------------+-------------+----+-----------
 10 | Bittu   | Patna    | t    |  5 |      10 | a goods   | Goods are heavy.               |           1 |  1 | Goods
  5 | Rohit   | Hariyana | f    |  1 |       5 | a mango   | Mangoes are sweets.            |           2 |  2 | Fruits
  5 | Rohit   | Hariyana | f    |  2 |       5 | a banana  | Bananas are sweets and yellow. |           2 |  2 | Fruits
 10 | Bittu   | Patna    | t    |  3 |      10 | a banana  | Bananas are sweets and yellow. |           2 |  2 | Fruits
 10 | Bittu   | Patna    | t    |  4 |      10 | a book    | Books are good.                |           5 |  5 | Books
  1 | Pankaj  | Patna    | f    |  6 |       1 | a food    | foods are heavy.               |           3 |  3 | Foods
  3 | Saurabh | Delhi    | t    |  7 |       3 | a food    | foods are light.               |           3 |  3 | Foods
 14 | Naveen  | Patiala  | t    |  8 |      14 | a food    | foods are light.               |           3 |  3 | Foods
 14 | Naveen  | Patiala  | t    |  9 |      14 | the goods | goods are light.               |           1 |  1 | Goods
 14 | Naveen  | Patiala  | t    | 10 |      14 | a food    | foods are good.                |           3 |  3 | Foods
 14 | Naveen  | Patiala  | t    | 11 |      14 | a cloth   | cloths are red.                |           8 |  8 | Cloths
 14 | Naveen  | Patiala  | t    | 12 |      14 | a wood    | woods are heavy.               |           4 |  4 | Woods
  7 | Manjeet | Patiala  | t    | 13 |       7 | a food    | foods are light.               |           3 |  3 | Foods
  7 | Manjeet | Patiala  | t    | 14 |       7 | a cloth   | cloths are red.                |           8 |  8 | Cloths
  7 | Manjeet | Patiala  | t    | 15 |       7 | a food    | foods are heavy.               |           3 |  3 | Foods
  7 | Manjeet | Patiala  | t    | 16 |       7 | a goods   | Goods are heavy.               |           1 |  1 | Goods
  7 | Manjeet | Patiala  | t    | 17 |       7 | a goods   | Goods are heavy.               |           1 |  1 | Goods
 11 | Pavan   | Patna    | t    |    |         |           |                                |             |    | 
 17 | Doe     | Goa      | t    |    |         |           |                                |             |    | 
 12 | Pavan   | Chhapra  | t    |    |         |           |                                |             |    | 
  2 | Pankaj  | Patna    | t    |    |         |           |                                |             |    | 
 15 | Praveen | Chhapra  | f    |    |         |           |                                |             |    | 
 13 | Naveen  | Chhapra  | t    |    |         |           |                                |             |    | 
  8 | Motilal | Chhapra  | f    |    |         |           |                                |             |    | 
  6 | Gundeep | Patiala  | t    |    |         |           |                                |             |    | 
 16 | John    | Goa      | f    |    |         |           |                                |             |    | 
  4 | Mohit   | Delhi    | f    |    |         |           |                                |             |    | 
  9 | Bittu   | Chhapra  | f    |    |         |           |                                |             |    | 
    |         |          |      |    |         |           |                                |             |  6 | Health
    |         |          |      |    |         |           |                                |             |  7 | Medicines
(30 rows)

blog_post_system=# select * from users U1 full outer join posts P1 on U1.id = P1.user_id full outer join categories C1 on C1.id = P1.category_id where U1.paid = false and C.name;
ERROR:  missing FROM-clause entry for table "c"
LINE 1: ... on C1.id = P1.category_id where U1.paid = false and C.name;
                                                                ^
blog_post_system=# select * from users U1 full outer join posts P1 on U1.id = P1.user_id full outer join categories C1 on C1.id = P1.category_id where U1.paid = false and C1.name;
ERROR:  argument of AND must be type boolean, not type character varying
LINE 1: ...on C1.id = P1.category_id where U1.paid = false and C1.name;
                                                               ^
blog_post_system=# select * from users U1 full outer join posts P1 on U1.id = P1.user_id full outer join categories C1 on C1.id = P1.category_id where U1.paid = false and C1.name = 'Foods';
 id |  name  | address | paid | id | user_id | title  |     content      | category_id | id | name  
----+--------+---------+------+----+---------+--------+------------------+-------------+----+-------
  1 | Pankaj | Patna   | f    |  6 |       1 | a food | foods are heavy. |           3 |  3 | Foods
(1 row)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select * from Categories C join posts P on C.id = P.category_id;
 id |  name  | id | user_id |   title   |            content             | category_id 
----+--------+----+---------+-----------+--------------------------------+-------------
  1 | Goods  |  5 |      10 | a goods   | Goods are heavy.               |           1
  2 | Fruits |  1 |       5 | a mango   | Mangoes are sweets.            |           2
  2 | Fruits |  2 |       5 | a banana  | Bananas are sweets and yellow. |           2
  2 | Fruits |  3 |      10 | a banana  | Bananas are sweets and yellow. |           2
  5 | Books  |  4 |      10 | a book    | Books are good.                |           5
  3 | Foods  |  6 |       1 | a food    | foods are heavy.               |           3
  3 | Foods  |  7 |       3 | a food    | foods are light.               |           3
  3 | Foods  |  8 |      14 | a food    | foods are light.               |           3
  1 | Goods  |  9 |      14 | the goods | goods are light.               |           1
  3 | Foods  | 10 |      14 | a food    | foods are good.                |           3
  8 | Cloths | 11 |      14 | a cloth   | cloths are red.                |           8
  4 | Woods  | 12 |      14 | a wood    | woods are heavy.               |           4
  3 | Foods  | 13 |       7 | a food    | foods are light.               |           3
  8 | Cloths | 14 |       7 | a cloth   | cloths are red.                |           8
  3 | Foods  | 15 |       7 | a food    | foods are heavy.               |           3
  1 | Goods  | 16 |       7 | a goods   | Goods are heavy.               |           1
  1 | Goods  | 17 |       7 | a goods   | Goods are heavy.               |           1
(17 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select * from Categories C full outer join posts P on C.id = P.category_id ;
 id |   name    | id | user_id |   title   |            content             | category_id 
----+-----------+----+---------+-----------+--------------------------------+-------------
  1 | Goods     |  5 |      10 | a goods   | Goods are heavy.               |           1
  2 | Fruits    |  1 |       5 | a mango   | Mangoes are sweets.            |           2
  2 | Fruits    |  2 |       5 | a banana  | Bananas are sweets and yellow. |           2
  2 | Fruits    |  3 |      10 | a banana  | Bananas are sweets and yellow. |           2
  5 | Books     |  4 |      10 | a book    | Books are good.                |           5
  3 | Foods     |  6 |       1 | a food    | foods are heavy.               |           3
  3 | Foods     |  7 |       3 | a food    | foods are light.               |           3
  3 | Foods     |  8 |      14 | a food    | foods are light.               |           3
  1 | Goods     |  9 |      14 | the goods | goods are light.               |           1
  3 | Foods     | 10 |      14 | a food    | foods are good.                |           3
  8 | Cloths    | 11 |      14 | a cloth   | cloths are red.                |           8
  4 | Woods     | 12 |      14 | a wood    | woods are heavy.               |           4
  3 | Foods     | 13 |       7 | a food    | foods are light.               |           3
  8 | Cloths    | 14 |       7 | a cloth   | cloths are red.                |           8
  3 | Foods     | 15 |       7 | a food    | foods are heavy.               |           3
  1 | Goods     | 16 |       7 | a goods   | Goods are heavy.               |           1
  1 | Goods     | 17 |       7 | a goods   | Goods are heavy.               |           1
  6 | Health    |    |         |           |                                |            
  7 | Medicines |    |         |           |                                |            
(19 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select * from Categories C full outer join posts P on C.id = P.category_id join users U on U.id = P.user_id;
 id |  name  | id | user_id |   title   |            content             | category_id | id |  name   | address  | paid 
----+--------+----+---------+-----------+--------------------------------+-------------+----+---------+----------+------
  1 | Goods  |  5 |      10 | a goods   | Goods are heavy.               |           1 | 10 | Bittu   | Patna    | t
  2 | Fruits |  1 |       5 | a mango   | Mangoes are sweets.            |           2 |  5 | Rohit   | Hariyana | f
  2 | Fruits |  2 |       5 | a banana  | Bananas are sweets and yellow. |           2 |  5 | Rohit   | Hariyana | f
  2 | Fruits |  3 |      10 | a banana  | Bananas are sweets and yellow. |           2 | 10 | Bittu   | Patna    | t
  5 | Books  |  4 |      10 | a book    | Books are good.                |           5 | 10 | Bittu   | Patna    | t
  3 | Foods  |  6 |       1 | a food    | foods are heavy.               |           3 |  1 | Pankaj  | Patna    | f
  3 | Foods  |  7 |       3 | a food    | foods are light.               |           3 |  3 | Saurabh | Delhi    | t
  3 | Foods  |  8 |      14 | a food    | foods are light.               |           3 | 14 | Naveen  | Patiala  | t
  1 | Goods  |  9 |      14 | the goods | goods are light.               |           1 | 14 | Naveen  | Patiala  | t
  3 | Foods  | 10 |      14 | a food    | foods are good.                |           3 | 14 | Naveen  | Patiala  | t
  8 | Cloths | 11 |      14 | a cloth   | cloths are red.                |           8 | 14 | Naveen  | Patiala  | t
  4 | Woods  | 12 |      14 | a wood    | woods are heavy.               |           4 | 14 | Naveen  | Patiala  | t
  3 | Foods  | 13 |       7 | a food    | foods are light.               |           3 |  7 | Manjeet | Patiala  | t
  8 | Cloths | 14 |       7 | a cloth   | cloths are red.                |           8 |  7 | Manjeet | Patiala  | t
  3 | Foods  | 15 |       7 | a food    | foods are heavy.               |           3 |  7 | Manjeet | Patiala  | t
  1 | Goods  | 16 |       7 | a goods   | Goods are heavy.               |           1 |  7 | Manjeet | Patiala  | t
  1 | Goods  | 17 |       7 | a goods   | Goods are heavy.               |           1 |  7 | Manjeet | Patiala  | t
(17 rows)

blog_post_system=# select * from categories C full outer join posts P on C.id = P.category_id join users U on U.id = P.user_id;
 id |  name  | id | user_id |   title   |            content             | category_id | id |  name   | address  | paid 
----+--------+----+---------+-----------+--------------------------------+-------------+----+---------+----------+------
  1 | Goods  |  5 |      10 | a goods   | Goods are heavy.               |           1 | 10 | Bittu   | Patna    | t
  2 | Fruits |  1 |       5 | a mango   | Mangoes are sweets.            |           2 |  5 | Rohit   | Hariyana | f
  2 | Fruits |  2 |       5 | a banana  | Bananas are sweets and yellow. |           2 |  5 | Rohit   | Hariyana | f
  2 | Fruits |  3 |      10 | a banana  | Bananas are sweets and yellow. |           2 | 10 | Bittu   | Patna    | t
  5 | Books  |  4 |      10 | a book    | Books are good.                |           5 | 10 | Bittu   | Patna    | t
  3 | Foods  |  6 |       1 | a food    | foods are heavy.               |           3 |  1 | Pankaj  | Patna    | f
  3 | Foods  |  7 |       3 | a food    | foods are light.               |           3 |  3 | Saurabh | Delhi    | t
  3 | Foods  |  8 |      14 | a food    | foods are light.               |           3 | 14 | Naveen  | Patiala  | t
  1 | Goods  |  9 |      14 | the goods | goods are light.               |           1 | 14 | Naveen  | Patiala  | t
  3 | Foods  | 10 |      14 | a food    | foods are good.                |           3 | 14 | Naveen  | Patiala  | t
  8 | Cloths | 11 |      14 | a cloth   | cloths are red.                |           8 | 14 | Naveen  | Patiala  | t
  4 | Woods  | 12 |      14 | a wood    | woods are heavy.               |           4 | 14 | Naveen  | Patiala  | t
  3 | Foods  | 13 |       7 | a food    | foods are light.               |           3 |  7 | Manjeet | Patiala  | t
  8 | Cloths | 14 |       7 | a cloth   | cloths are red.                |           8 |  7 | Manjeet | Patiala  | t
  3 | Foods  | 15 |       7 | a food    | foods are heavy.               |           3 |  7 | Manjeet | Patiala  | t
  1 | Goods  | 16 |       7 | a goods   | Goods are heavy.               |           1 |  7 | Manjeet | Patiala  | t
  1 | Goods  | 17 |       7 | a goods   | Goods are heavy.               |           1 |  7 | Manjeet | Patiala  | t
(17 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# select count(P.id) from categories C full outer join posts P on C.id = P.category_id join users U on U.id = P.user_id;
 count 
-------
    17
(1 row)

blog_post_system=# select U.id, U.name, count(P.id) from categories C full outer join posts P on C.id = P.category_id join users U on U.id = P.user_id;
ERROR:  column "u.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, U.name, count(P.id) from categories C full oute...
               ^
blog_post_system=# select U.id, U.name, count(P.id) from categories C full outer join posts P on C.id = P.category_id join users U on U.id = P.user_id group by U.id;
 id |  name   | count 
----+---------+-------
 10 | Bittu   |     3
  5 | Rohit   |     2
  1 | Pankaj  |     1
  3 | Saurabh |     1
 14 | Naveen  |     5
  7 | Manjeet |     5
(6 rows)

blog_post_system=# select U.id, U.name, count(P.id), C.name from categories C full outer join posts P on C.id = P.category_id join users U on U.id = P.user_id group by U.id;
ERROR:  column "c.name" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, U.name, count(P.id), C.name from categories C f...
                                          ^
blog_post_system=# select U.id, U.name, C.name from categories C full outer join posts P on C.id = P.category_id join users U on U.id = P.user_id group by U.id;
ERROR:  column "c.name" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, U.name, C.name from categories C full outer joi...
                             ^
blog_post_system=# select U.id, U.name, C.name from categories C full outer join posts P on C.id = P.category_id join users U on U.id = P.user_id;
 id |  name   |  name  
----+---------+--------
 10 | Bittu   | Goods
  5 | Rohit   | Fruits
  5 | Rohit   | Fruits
 10 | Bittu   | Fruits
 10 | Bittu   | Books
  1 | Pankaj  | Foods
  3 | Saurabh | Foods
 14 | Naveen  | Foods
 14 | Naveen  | Goods
 14 | Naveen  | Foods
 14 | Naveen  | Cloths
 14 | Naveen  | Woods
  7 | Manjeet | Foods
  7 | Manjeet | Cloths
  7 | Manjeet | Foods
  7 | Manjeet | Goods
  7 | Manjeet | Goods
(17 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# select U.id, U.name,P.id, P.name, C.id, C.name from categories C full outer join posts P on C.id = P.category_id join users U on U.id = P.user_id;
ERROR:  column p.name does not exist
LINE 1: select U.id, U.name,P.id, P.name, C.id, C.name from categori...
                                  ^
HINT:  Perhaps you meant to reference the column "c.name" or the column "u.name".
blog_post_system=# select U.id, U.name,P.id, C.id, C.name from categories C full outer join posts P on C.id = P.category_id join users U on U.id = P.user_id;
 id |  name   | id | id |  name  
----+---------+----+----+--------
 10 | Bittu   |  5 |  1 | Goods
  5 | Rohit   |  1 |  2 | Fruits
  5 | Rohit   |  2 |  2 | Fruits
 10 | Bittu   |  3 |  2 | Fruits
 10 | Bittu   |  4 |  5 | Books
  1 | Pankaj  |  6 |  3 | Foods
  3 | Saurabh |  7 |  3 | Foods
 14 | Naveen  |  8 |  3 | Foods
 14 | Naveen  |  9 |  1 | Goods
 14 | Naveen  | 10 |  3 | Foods
 14 | Naveen  | 11 |  8 | Cloths
 14 | Naveen  | 12 |  4 | Woods
  7 | Manjeet | 13 |  3 | Foods
  7 | Manjeet | 14 |  8 | Cloths
  7 | Manjeet | 15 |  3 | Foods
  7 | Manjeet | 16 |  1 | Goods
  7 | Manjeet | 17 |  1 | Goods
(17 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# select U.id, U.name,P.id, C.id, C.name from categories C full outer join posts P on C.id = P.category_id join users U on U.id = P.user_id where U.paid = false;
 id |  name  | id | id |  name  
----+--------+----+----+--------
  5 | Rohit  |  1 |  2 | Fruits
  5 | Rohit  |  2 |  2 | Fruits
  1 | Pankaj |  6 |  3 | Foods
(3 rows)

blog_post_system=# select U.id, U.name,P.id, C.id, C.name, count(P.id) from categories C full outer join posts P on C.id = P.category_id join users U on U.id = P.user_id where U.paid = false;
ERROR:  column "u.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, U.name,P.id, C.id, C.name, count(P.id) from cat...
               ^
blog_post_system=# select U.id, U.name,P.id, C.id, C.name, count(P.id) from categories C full outer join posts P on C.id = P.category_id join users U on U.id = P.user_id where U.paid = false group by U.id;
ERROR:  column "p.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, U.name,P.id, C.id, C.name, count(P.id) from cat...
                            ^
blog_post_system=# select U.id, U.name,P.id, C.id, C.name, count(P.id) from categories C full outer join posts P on C.id = P.category_id join users U on U.id = P.user_id where U.paid = false;
ERROR:  column "u.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, U.name,P.id, C.id, C.name, count(P.id) from cat...
               ^
blog_post_system=# select U.id, U.name,P.id, C.id, C.name, count(P.id) from categories C full outer join posts P on C.id = P.category_id join users U on U.id = P.user_id where U.paid = false;
ERROR:  column "u.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, U.name,P.id, C.id, C.name, count(P.id) from cat...
               ^
blog_post_system=# select U.id, U.name,P.id, C.id, C.name, count(P.id) from categories C full outer join posts P on C.id = P.category_id join users U on U.id = P.user_id where U.paid = false;
ERROR:  column "u.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, U.name,P.id, C.id, C.name, count(P.id) from cat...
               ^
blog_post_system=# select U.id, U.name,P.id, C.id, C.name from categories C full outer join posts P on C.id = P.category_id join users U on U.id = P.user_id where U.paid = false;
 id |  name  | id | id |  name  
----+--------+----+----+--------
  5 | Rohit  |  1 |  2 | Fruits
  5 | Rohit  |  2 |  2 | Fruits
  1 | Pankaj |  6 |  3 | Foods
(3 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select U.id, U.name,P.id, C.id, C.name from categories C full outer join posts P on C.id = P.category_id join users U on U.id = P.user_id where U.paid = false;
 id |  name  | id | id |  name  
----+--------+----+----+--------
  5 | Rohit  |  1 |  2 | Fruits
  5 | Rohit  |  2 |  2 | Fruits
  1 | Pankaj |  6 |  3 | Foods
(3 rows)

blog_post_system=# select U.id, U.name,P.id, C.id, C.name from categories C full outer join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods';
 id |  name   | id | id | name  
----+---------+----+----+-------
  1 | Pankaj  |  6 |  3 | Foods
  3 | Saurabh |  7 |  3 | Foods
 14 | Naveen  |  8 |  3 | Foods
 14 | Naveen  | 10 |  3 | Foods
  7 | Manjeet | 13 |  3 | Foods
  7 | Manjeet | 15 |  3 | Foods
(6 rows)

blog_post_system=# select U.id, U.name,P.id, C.id, C.name from categories C full outer join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false;
 id |  name  | id | id | name  
----+--------+----+----+-------
  1 | Pankaj |  6 |  3 | Foods
(1 row)

blog_post_system=# select U.id, U.name,P.id, C.id, C.name from categories C full outer join posts P on C.id = P.category_id join users U on U.id = P.user_id where U.paid = false, C.name = 'Foods';
ERROR:  syntax error at or near ","
LINE 1: ...n users U on U.id = P.user_id where U.paid = false, C.name =...
                                                             ^
blog_post_system=# select U.id, U.name,P.id, C.id, C.name from categories C full outer join posts P on C.id = P.category_id join users U on U.id = P.user_id where U.paid = false and C.name = 'Foods';
 id |  name  | id | id | name  
----+--------+----+----+-------
  1 | Pankaj |  6 |  3 | Foods
(1 row)

blog_post_system=# select U.id, U.name,P.id,count(P.id), C.id, C.name from categories C full outer join posts P on C.id = P.category_id join users U on U.id = P.user_id where U.paid = false and C.name = 'Foods';
ERROR:  column "u.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, U.name,P.id,count(P.id), C.id, C.name from cate...
               ^
blog_post_system=# select U.id, U.name,P.id,count(P.id), C.id, C.name from categories C full outer join posts P on C.id = P.category_id join users U on U.id = P.user_id where U.paid = false and C.name = 'Foods' group by P.id;
ERROR:  column "u.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, U.name,P.id,count(P.id), C.id, C.name from cate...
               ^
blog_post_system=# select U.id, U.name,P.id,count(P.id), C.id, C.name from categories C full outer join posts P on C.id = P.category_id join users U on U.id = P.user_id where U.paid = false and C.name = 'Foods' group by U.id;
ERROR:  column "p.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, U.name,P.id,count(P.id), C.id, C.name from cate...
                            ^
blog_post_system=# select U.id, U.name, count(P.id), C.id, C.name from categories C full outer join posts P on C.id = P.category_id join users U on U.id = P.user_id where U.paid = false and C.name = 'Foods' group by U.id;
ERROR:  column "c.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, U.name, count(P.id), C.id, C.name from categori...
                                          ^
blog_post_system=# select * from categories c;
 id |   name    
----+-----------
  1 | Goods
  3 | Foods
  2 | Fruits
  4 | Woods
  5 | Books
  6 | Health
  7 | Medicines
  8 | Cloths
(8 rows)

blog_post_system=# select * from categories c join posts P;
ERROR:  syntax error at or near ";"
LINE 1: select * from categories c join posts P;
                                               ^
blog_post_system=# select * from categories c join posts P on C.id = P.category_id;
 id |  name  | id | user_id |   title   |            content             | category_id 
----+--------+----+---------+-----------+--------------------------------+-------------
  1 | Goods  |  5 |      10 | a goods   | Goods are heavy.               |           1
  2 | Fruits |  1 |       5 | a mango   | Mangoes are sweets.            |           2
  2 | Fruits |  2 |       5 | a banana  | Bananas are sweets and yellow. |           2
  2 | Fruits |  3 |      10 | a banana  | Bananas are sweets and yellow. |           2
  5 | Books  |  4 |      10 | a book    | Books are good.                |           5
  3 | Foods  |  6 |       1 | a food    | foods are heavy.               |           3
  3 | Foods  |  7 |       3 | a food    | foods are light.               |           3
  3 | Foods  |  8 |      14 | a food    | foods are light.               |           3
  1 | Goods  |  9 |      14 | the goods | goods are light.               |           1
  3 | Foods  | 10 |      14 | a food    | foods are good.                |           3
  8 | Cloths | 11 |      14 | a cloth   | cloths are red.                |           8
  4 | Woods  | 12 |      14 | a wood    | woods are heavy.               |           4
  3 | Foods  | 13 |       7 | a food    | foods are light.               |           3
  8 | Cloths | 14 |       7 | a cloth   | cloths are red.                |           8
  3 | Foods  | 15 |       7 | a food    | foods are heavy.               |           3
  1 | Goods  | 16 |       7 | a goods   | Goods are heavy.               |           1
  1 | Goods  | 17 |       7 | a goods   | Goods are heavy.               |           1
(17 rows)

blog_post_system=# select * from categories c join posts P on C.id = P.category_id where C.name = 'Foods';
 id | name  | id | user_id | title  |     content      | category_id 
----+-------+----+---------+--------+------------------+-------------
  3 | Foods |  6 |       1 | a food | foods are heavy. |           3
  3 | Foods |  7 |       3 | a food | foods are light. |           3
  3 | Foods |  8 |      14 | a food | foods are light. |           3
  3 | Foods | 10 |      14 | a food | foods are good.  |           3
  3 | Foods | 13 |       7 | a food | foods are light. |           3
  3 | Foods | 15 |       7 | a food | foods are heavy. |           3
(6 rows)

blog_post_system=# select * from categories c join posts P on C.id = P.category_id where C.name = 'Foods' joins users U on U.id = P.user_id;
ERROR:  syntax error at or near "joins"
LINE 1: ... P on C.id = P.category_id where C.name = 'Foods' joins user...
                                                             ^
blog_post_system=# select * from categories c join posts P on C.id = P.category_id where C.name = 'Foods' join users U on U.id = P.user_id;
ERROR:  syntax error at or near "join"
LINE 1: ... P on C.id = P.category_id where C.name = 'Foods' join users...
                                                             ^
blog_post_system=# select * from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id;
 id |  name  | id | user_id |   title   |            content             | category_id | id |  name   | address  | paid 
----+--------+----+---------+-----------+--------------------------------+-------------+----+---------+----------+------
  1 | Goods  |  5 |      10 | a goods   | Goods are heavy.               |           1 | 10 | Bittu   | Patna    | t
  2 | Fruits |  1 |       5 | a mango   | Mangoes are sweets.            |           2 |  5 | Rohit   | Hariyana | f
  2 | Fruits |  2 |       5 | a banana  | Bananas are sweets and yellow. |           2 |  5 | Rohit   | Hariyana | f
  2 | Fruits |  3 |      10 | a banana  | Bananas are sweets and yellow. |           2 | 10 | Bittu   | Patna    | t
  5 | Books  |  4 |      10 | a book    | Books are good.                |           5 | 10 | Bittu   | Patna    | t
  3 | Foods  |  6 |       1 | a food    | foods are heavy.               |           3 |  1 | Pankaj  | Patna    | f
  3 | Foods  |  7 |       3 | a food    | foods are light.               |           3 |  3 | Saurabh | Delhi    | t
  3 | Foods  |  8 |      14 | a food    | foods are light.               |           3 | 14 | Naveen  | Patiala  | t
  1 | Goods  |  9 |      14 | the goods | goods are light.               |           1 | 14 | Naveen  | Patiala  | t
  3 | Foods  | 10 |      14 | a food    | foods are good.                |           3 | 14 | Naveen  | Patiala  | t
  8 | Cloths | 11 |      14 | a cloth   | cloths are red.                |           8 | 14 | Naveen  | Patiala  | t
  4 | Woods  | 12 |      14 | a wood    | woods are heavy.               |           4 | 14 | Naveen  | Patiala  | t
  3 | Foods  | 13 |       7 | a food    | foods are light.               |           3 |  7 | Manjeet | Patiala  | t
  8 | Cloths | 14 |       7 | a cloth   | cloths are red.                |           8 |  7 | Manjeet | Patiala  | t
  3 | Foods  | 15 |       7 | a food    | foods are heavy.               |           3 |  7 | Manjeet | Patiala  | t
  1 | Goods  | 16 |       7 | a goods   | Goods are heavy.               |           1 |  7 | Manjeet | Patiala  | t
  1 | Goods  | 17 |       7 | a goods   | Goods are heavy.               |           1 |  7 | Manjeet | Patiala  | t
(17 rows)

blog_post_system=# select * from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods';
 id | name  | id | user_id | title  |     content      | category_id | id |  name   | address | paid 
----+-------+----+---------+--------+------------------+-------------+----+---------+---------+------
  3 | Foods |  6 |       1 | a food | foods are heavy. |           3 |  1 | Pankaj  | Patna   | f
  3 | Foods |  7 |       3 | a food | foods are light. |           3 |  3 | Saurabh | Delhi   | t
  3 | Foods |  8 |      14 | a food | foods are light. |           3 | 14 | Naveen  | Patiala | t
  3 | Foods | 10 |      14 | a food | foods are good.  |           3 | 14 | Naveen  | Patiala | t
  3 | Foods | 13 |       7 | a food | foods are light. |           3 |  7 | Manjeet | Patiala | t
  3 | Foods | 15 |       7 | a food | foods are heavy. |           3 |  7 | Manjeet | Patiala | t
(6 rows)

blog_post_system=# select * from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false;
 id | name  | id | user_id | title  |     content      | category_id | id |  name  | address | paid 
----+-------+----+---------+--------+------------------+-------------+----+--------+---------+------
  3 | Foods |  6 |       1 | a food | foods are heavy. |           3 |  1 | Pankaj | Patna   | f
(1 row)

blog_post_system=# 
blog_post_system=# select * from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false;
 id | name  | id | user_id | title  |     content      | category_id | id |  name  | address | paid 
----+-------+----+---------+--------+------------------+-------------+----+--------+---------+------
  3 | Foods |  6 |       1 | a food | foods are heavy. |           3 |  1 | Pankaj | Patna   | f
(1 row)

blog_post_system=# select * from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false ;
 id | name  | id | user_id | title  |     content      | category_id | id |  name  | address | paid 
----+-------+----+---------+--------+------------------+-------------+----+--------+---------+------
  3 | Foods |  6 |       1 | a food | foods are heavy. |           3 |  1 | Pankaj | Patna   | f
(1 row)

blog_post_system=# select count(P.id) from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false ;
 count 
-------
     1
(1 row)

blog_post_system=# select count(P.id), C.id from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false ;
ERROR:  column "c.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select count(P.id), C.id from categories c join posts P on C...
                            ^
blog_post_system=# select count(P.id) from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false ;
 count 
-------
     1
(1 row)

blog_post_system=# 
blog_post_system=# select count(P.id) from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false ;
 count 
-------
     1
(1 row)

blog_post_system=# 
blog_post_system=# select count(P.id) from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false ;
 count 
-------
     1
(1 row)

blog_post_system=# select count(P.id) from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false ;
 count 
-------
     1
(1 row)

blog_post_system=# select count(P.id) from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false ;
 count 
-------
     1
(1 row)

blog_post_system=# select count(P.id) from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false ;
 count 
-------
     1
(1 row)

blog_post_system=# select count(P.id) from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false ;
 count 
-------
     1
(1 row)

blog_post_system=# select count(P.id) from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false ;
 count 
-------
     1
(1 row)

blog_post_system=# select count(P.id) from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false ;
 count 
-------
     1
(1 row)

blog_post_system=# select count(P.id) from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false ;
 count 
-------
     1
(1 row)

blog_post_system=# select count(P.id) from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false ;
 count 
-------
     1
(1 row)

blog_post_system=# select count(P.id) from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false ;
 count 
-------
     1
(1 row)

blog_post_system=# select count(P.id) from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods' ;
 count 
-------
     6
(1 row)

blog_post_system=# select count(P.id) from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods' U.paid = true;
ERROR:  syntax error at or near "U"
LINE 1: ...sers U on U.id = P.user_id where C.name = 'Foods' U.paid = t...
                                                             ^
blog_post_system=# select count(P.id) from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = true;
 count 
-------
     5
(1 row)

blog_post_system=# 
blog_post_system=# select count(P.id) from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Goods' and U.paid = true;
 count 
-------
     4
(1 row)

blog_post_system=# 
blog_post_system=# select count(P.id) from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Goods' and U.paid = true;
 count 
-------
     4
(1 row)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select count(P.id) from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Goods' and U.paid = false;
 count 
-------
     0
(1 row)

blog_post_system=# select count(P.id) from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false;
 count 
-------
     1
(1 row)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# select count(P.id),C.id from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false;
ERROR:  column "c.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select count(P.id),C.id from categories c join posts P on C....
                           ^
blog_post_system=# select U.name, count(P.id),C.id from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false;
ERROR:  column "u.name" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.name, count(P.id),C.id from categories c join posts...
               ^
blog_post_system=# select U.name, count(P.id),C.id from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false;
ERROR:  column "u.name" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.name, count(P.id),C.id from categories c join posts...
               ^
blog_post_system=# select count(P.id),C.id from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false;
ERROR:  column "c.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select count(P.id),C.id from categories c join posts P on C....
                           ^
blog_post_system=# select count(P.id) from categories c join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false;
 count 
-------
     1
(1 row)

blog_post_system=# select count(P.id) from categories C join posts P on C.id = P.category_id join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false;
 count 
-------
     1
(1 row)

blog_post_system=# select count(P.id) from categories C full outer join posts P on C.id = P.category_id full outer join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false;
 count 
-------
     1
(1 row)

blog_post_system=# select count(P.id) from categories C full outer join posts P on C.id = P.category_id full outer join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false;
 count 
-------
     1
(1 row)

blog_post_system=# select U.name, count(P.id) from categories C full outer join posts P on C.id = P.category_id full outer join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false;
ERROR:  column "u.name" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.name, count(P.id) from categories C full outer join...
               ^
blog_post_system=# select U.name, count(P.id) from categories C full outer join posts P on C.id = P.category_id full outer join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false group by U.id;
  name  | count 
--------+-------
 Pankaj |     1
(1 row)

blog_post_system=# select U.name, count(P.id) from categories C full outer join posts P on C.id = P.category_id left outer join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false group by U.id;
  name  | count 
--------+-------
 Pankaj |     1
(1 row)

blog_post_system=# select U.name, count(P.id), C.id, C.name from categories C full outer join posts P on C.id = P.category_id left outer join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false group by U.id;
ERROR:  column "c.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.name, count(P.id), C.id, C.name from categories C f...
                                    ^
blog_post_system=# select U.name, count(P.id) from categories C full outer join posts P on C.id = P.category_id left outer join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false group by U.id;
  name  | count 
--------+-------
 Pankaj |     1
(1 row)

blog_post_system=# select * from categories C full outer join posts P on C.id = P.category_id left outer join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false group by U.id;
ERROR:  column "c.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select * from categories C full outer join posts P on C.id =...
               ^
blog_post_system=# select * from categories C full outer join posts P on C.id = P.category_id left outer join users U on U.id = P.user_id where C.name = 'Foods' and U.paid = false;
 id | name  | id | user_id | title  |     content      | category_id | id |  name  | address | paid 
----+-------+----+---------+--------+------------------+-------------+----+--------+---------+------
  3 | Foods |  6 |       1 | a food | foods are heavy. |           3 |  1 | Pankaj | Patna   | f
(1 row)

blog_post_system=# select * from categories'
blog_post_system'# ^C
blog_post_system=# select * from categories;
 id |   name    
----+-----------
  1 | Goods
  3 | Foods
  2 | Fruits
  4 | Woods
  5 | Books
  6 | Health
  7 | Medicines
  8 | Cloths
(8 rows)

blog_post_system=# select * from posts;
 id | user_id |   title   |            content             | category_id 
----+---------+-----------+--------------------------------+-------------
  5 |      10 | a goods   | Goods are heavy.               |           1
  1 |       5 | a mango   | Mangoes are sweets.            |           2
  2 |       5 | a banana  | Bananas are sweets and yellow. |           2
  3 |      10 | a banana  | Bananas are sweets and yellow. |           2
  4 |      10 | a book    | Books are good.                |           5
  6 |       1 | a food    | foods are heavy.               |           3
  7 |       3 | a food    | foods are light.               |           3
  8 |      14 | a food    | foods are light.               |           3
  9 |      14 | the goods | goods are light.               |           1
 10 |      14 | a food    | foods are good.                |           3
 11 |      14 | a cloth   | cloths are red.                |           8
 12 |      14 | a wood    | woods are heavy.               |           4
 13 |       7 | a food    | foods are light.               |           3
 14 |       7 | a cloth   | cloths are red.                |           8
 15 |       7 | a food    | foods are heavy.               |           3
 16 |       7 | a goods   | Goods are heavy.               |           1
 17 |       7 | a goods   | Goods are heavy.               |           1
(17 rows)

blog_post_system=# select count(P1.id) from users U1 left outer join posts P1 on U1.id = P1.user_id left outer join categories C1 on C1.id = P1.category_id where U1.paid = true group by U1.id having count(P1.id) > 2;
 count 
-------
     3
     5
     5
(3 rows)

blog_post_system=# Alter table users alter column id type varchar;
ERROR:  cannot alter type of a column used by a view or rule
DETAIL:  rule _RETURN on view count_views depends on column "id"
blog_post_system=# 
blog_post_system=# select U.id, U.name, count(P.id) from users U full outer join posts P on U.id = P.user_id where U.paid = false group by U.id;
 id |  name   | count 
----+---------+-------
  8 | Motilal |     0
 16 | John    |     0
 15 | Praveen |     0
  4 | Mohit   |     0
  1 | Pankaj  |     1
  5 | Rohit   |     2
  9 | Bittu   |     0
(7 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# select * from posts;
 id | user_id |   title   |            content             | category_id 
----+---------+-----------+--------------------------------+-------------
  5 |      10 | a goods   | Goods are heavy.               |           1
  1 |       5 | a mango   | Mangoes are sweets.            |           2
  2 |       5 | a banana  | Bananas are sweets and yellow. |           2
  3 |      10 | a banana  | Bananas are sweets and yellow. |           2
  4 |      10 | a book    | Books are good.                |           5
  6 |       1 | a food    | foods are heavy.               |           3
  7 |       3 | a food    | foods are light.               |           3
  8 |      14 | a food    | foods are light.               |           3
  9 |      14 | the goods | goods are light.               |           1
 10 |      14 | a food    | foods are good.                |           3
 11 |      14 | a cloth   | cloths are red.                |           8
 12 |      14 | a wood    | woods are heavy.               |           4
 13 |       7 | a food    | foods are light.               |           3
 14 |       7 | a cloth   | cloths are red.                |           8
 15 |       7 | a food    | foods are heavy.               |           3
 16 |       7 | a goods   | Goods are heavy.               |           1
 17 |       7 | a goods   | Goods are heavy.               |           1
(17 rows)

blog_post_system=# select P.id from categories C right outer join posts P on C.id = P.category_id;
 id 
----
  5
  1
  2
  3
  4
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
(17 rows)

blog_post_system=# select P.id, P.title from categories C right outer join posts P on C.id = P.category_id where C.id = 3;
 id | title  
----+--------
  6 | a food
  7 | a food
  8 | a food
 10 | a food
 13 | a food
 15 | a food
(6 rows)

blog_post_system=# select P.id, P.title, C.name from categories C right outer join posts P on C.id = P.category_id where C.id = 3;
 id | title  | name  
----+--------+-------
  6 | a food | Foods
  7 | a food | Foods
  8 | a food | Foods
 10 | a food | Foods
 13 | a food | Foods
 15 | a food | Foods
(6 rows)

blog_post_system=# select U.name, U.id from users U left join posts P on U.id = P.id where P.id in (select P.id from categories C right outer join posts P on C.id = P.category_id where C.id = 3;)
blog_post_system-# ;
ERROR:  syntax error at or near ";"
LINE 1: ... outer join posts P on C.id = P.category_id where C.id = 3;)
                                                                     ^
blog_post_system=# select U.name, U.id from users U left join posts P on U.id = P.id where P.id in (select P.id from categories C right outer join posts P on C.id = P.category_id where C.id = 3)
;
  name   | id 
---------+----
 Gundeep |  6
 Manjeet |  7
 Motilal |  8
 Bittu   | 10
 Naveen  | 13
 Praveen | 15
(6 rows)

blog_post_system=# select U.name, U.id from users U left join posts P on U.id = P.id where P.id in (select P.id from categories C right outer join posts P on C.id = P.category_id where C.id = 3);

  name   | id 
---------+----
 Gundeep |  6
 Manjeet |  7
 Motilal |  8
 Bittu   | 10
 Naveen  | 13
 Praveen | 15
(6 rows)

blog_post_system=# select U.name, U.id, P.id from users U left join posts P on U.id = P.id where P.id in (select P.id from categories C right outer join posts P on C.id = P.category_id where C.id = 3);
  name   | id | id 
---------+----+----
 Gundeep |  6 |  6
 Manjeet |  7 |  7
 Motilal |  8 |  8
 Bittu   | 10 | 10
 Naveen  | 13 | 13
 Praveen | 15 | 15
(6 rows)

blog_post_system=# select U.name, U.id, P.user_id from users U left join posts P on U.id = P.id where P.id in (select P.id from categories C right outer join posts P on C.id = P.category_id where C.id = 3);
  name   | id | user_id 
---------+----+---------
 Gundeep |  6 |       1
 Manjeet |  7 |       3
 Motilal |  8 |      14
 Bittu   | 10 |      14
 Naveen  | 13 |       7
 Praveen | 15 |       7
(6 rows)

blog_post_system=# select * from users
blog_post_system-# ;
 id |  name   | address  | paid 
----+---------+----------+------
  1 | Pankaj  | Patna    | f
  2 | Pankaj  | Patna    | t
  3 | Saurabh | Delhi    | t
  4 | Mohit   | Delhi    | f
  5 | Rohit   | Hariyana | f
  6 | Gundeep | Patiala  | t
  7 | Manjeet | Patiala  | t
  8 | Motilal | Chhapra  | f
  9 | Bittu   | Chhapra  | f
 10 | Bittu   | Patna    | t
 11 | Pavan   | Patna    | t
 12 | Pavan   | Chhapra  | t
 13 | Naveen  | Chhapra  | t
 14 | Naveen  | Patiala  | t
 15 | Praveen | Chhapra  | f
 16 | John    | Goa      | f
 17 | Doe     | Goa      | t
(17 rows)

blog_post_system=# select U.name, U.id, P.id from users U left join posts P on U.id = P.id where P.id in (select P.id from categories C right outer join posts P on C.id = P.category_id where C.id = 3);
  name   | id | id 
---------+----+----
 Gundeep |  6 |  6
 Manjeet |  7 |  7
 Motilal |  8 |  8
 Bittu   | 10 | 10
 Naveen  | 13 | 13
 Praveen | 15 | 15
(6 rows)

blog_post_system=# select U.name, U.id, P.title from users U left join posts P on U.id = P.id where P.id in (select P.id from categories C right outer join posts P on C.id = P.category_id where C.id = 3);
  name   | id | title  
---------+----+--------
 Gundeep |  6 | a food
 Manjeet |  7 | a food
 Motilal |  8 | a food
 Bittu   | 10 | a food
 Naveen  | 13 | a food
 Praveen | 15 | a food
(6 rows)

blog_post_system=# select U.id, U.name, P.title, P.content from users U left join posts P on U.id = P.id where P.id in (select P.id from categories C right outer join posts P on C.id = P.category_id where C.id = 3);
 id |  name   | title  |     content      
----+---------+--------+------------------
  6 | Gundeep | a food | foods are heavy.
  7 | Manjeet | a food | foods are light.
  8 | Motilal | a food | foods are light.
 10 | Bittu   | a food | foods are good.
 13 | Naveen  | a food | foods are light.
 15 | Praveen | a food | foods are heavy.
(6 rows)

blog_post_system=# select U.id, U.name,P.id, P.title, P.content from users U left join posts P on U.id = P.id where P.id in (select P.id from categories C right outer join posts P on C.id = P.category_id where C.id = 3);
 id |  name   | id | title  |     content      
----+---------+----+--------+------------------
  6 | Gundeep |  6 | a food | foods are heavy.
  7 | Manjeet |  7 | a food | foods are light.
  8 | Motilal |  8 | a food | foods are light.
 10 | Bittu   | 10 | a food | foods are good.
 13 | Naveen  | 13 | a food | foods are light.
 15 | Praveen | 15 | a food | foods are heavy.
(6 rows)

blog_post_system=# select * from posts;
 id | user_id |   title   |            content             | category_id 
----+---------+-----------+--------------------------------+-------------
  5 |      10 | a goods   | Goods are heavy.               |           1
  1 |       5 | a mango   | Mangoes are sweets.            |           2
  2 |       5 | a banana  | Bananas are sweets and yellow. |           2
  3 |      10 | a banana  | Bananas are sweets and yellow. |           2
  4 |      10 | a book    | Books are good.                |           5
  6 |       1 | a food    | foods are heavy.               |           3
  7 |       3 | a food    | foods are light.               |           3
  8 |      14 | a food    | foods are light.               |           3
  9 |      14 | the goods | goods are light.               |           1
 10 |      14 | a food    | foods are good.                |           3
 11 |      14 | a cloth   | cloths are red.                |           8
 12 |      14 | a wood    | woods are heavy.               |           4
 13 |       7 | a food    | foods are light.               |           3
 14 |       7 | a cloth   | cloths are red.                |           8
 15 |       7 | a food    | foods are heavy.               |           3
 16 |       7 | a goods   | Goods are heavy.               |           1
 17 |       7 | a goods   | Goods are heavy.               |           1
(17 rows)

blog_post_system=# select U.id, U.name, count(P.id) from users U full outer join posts P on U.id = P.user_id where U.paid = false group by U.id;
 id |  name   | count 
----+---------+-------
  8 | Motilal |     0
 16 | John    |     0
 15 | Praveen |     0
  4 | Mohit   |     0
  1 | Pankaj  |     1
  5 | Rohit   |     2
  9 | Bittu   |     0
(7 rows)

blog_post_system=# select U.id, U.name, P.id from users U full outer join posts P on U.id = P.user_id where U.paid = false ;
 id |  name   | id 
----+---------+----
  5 | Rohit   |  1
  5 | Rohit   |  2
  1 | Pankaj  |  6
 15 | Praveen |   
  8 | Motilal |   
 16 | John    |   
  4 | Mohit   |   
  9 | Bittu   |   
(8 rows)

blog_post_system=# select * from users;
 id |  name   | address  | paid 
----+---------+----------+------
  1 | Pankaj  | Patna    | f
  2 | Pankaj  | Patna    | t
  3 | Saurabh | Delhi    | t
  4 | Mohit   | Delhi    | f
  5 | Rohit   | Hariyana | f
  6 | Gundeep | Patiala  | t
  7 | Manjeet | Patiala  | t
  8 | Motilal | Chhapra  | f
  9 | Bittu   | Chhapra  | f
 10 | Bittu   | Patna    | t
 11 | Pavan   | Patna    | t
 12 | Pavan   | Chhapra  | t
 13 | Naveen  | Chhapra  | t
 14 | Naveen  | Patiala  | t
 15 | Praveen | Chhapra  | f
 16 | John    | Goa      | f
 17 | Doe     | Goa      | t
(17 rows)

blog_post_system=# select U.id as User_id, P.id, P.title from users U full outer join posts P on U.id = P.user_id where U.paid = false;
 user_id | id |  title   
---------+----+----------
       5 |  1 | a mango
       5 |  2 | a banana
       1 |  6 | a food
      15 |    | 
       8 |    | 
      16 |    | 
       4 |    | 
       9 |    | 
(8 rows)

blog_post_system=# select U.id as User_id, P.id, P.title from users U full outer join posts P on U.id = P.user_id where U.paid = false P.category_id = 3;
ERROR:  syntax error at or near "P"
LINE 1: ... posts P on U.id = P.user_id where U.paid = false P.category...
                                                             ^
blog_post_system=# select U.id as User_id, P.id, P.title from users U full outer join posts P on U.id = P.user_id where U.paid = false and P.category_id = 3;
 user_id | id | title  
---------+----+--------
       1 |  6 | a food
(1 row)

blog_post_system=# 
blog_post_system=# select U.id as User_id, P.id, P.title from users U full outer join posts P on U.id = P.user_id where U.paid = false and P.category_id = 2;
 user_id | id |  title   
---------+----+----------
       5 |  2 | a banana
       5 |  1 | a mango
(2 rows)

blog_post_system=# select U.id as User_id, P.id, P.title from users U full outer join posts P on U.id = P.user_id where U.paid = true and P.category_id = 3;
 user_id | id | title  
---------+----+--------
       3 |  7 | a food
       7 | 15 | a food
       7 | 13 | a food
      14 | 10 | a food
      14 |  8 | a food
(5 rows)

blog_post_system=# select U.id as User_id, P.id, P.title from users U full outer join posts P on U.id = P.user_id where P.category_id = 3;
 user_id | id | title  
---------+----+--------
       1 |  6 | a food
       3 |  7 | a food
       7 | 15 | a food
       7 | 13 | a food
      14 | 10 | a food
      14 |  8 | a food
(6 rows)

blog_post_system=# select U.id as User_id, count(P.id), P.title from users U full outer join posts P on U.id = P.user_id where P.category_id = 3 group by U.id;
ERROR:  column "p.title" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id as User_id, count(P.id), P.title from users U fu...
                                             ^
blog_post_system=# select U.id as User_id, count(P.id) from users U full outer join posts P on U.id = P.user_id where P.category_id = 3 group by U.id;
 user_id | count 
---------+-------
      14 |     2
       1 |     1
       3 |     1
       7 |     2
(4 rows)

blog_post_system=# 
blog_post_system=# select U.id as User_id, U.paid, count(P.id) from users U full outer join posts P on U.id = P.user_id where P.category_id = 3 group by U.id;
 user_id | paid | count 
---------+------+-------
      14 | t    |     2
       1 | f    |     1
       3 | t    |     1
       7 | t    |     2
(4 rows)

blog_post_system=# select U.id as User_id, U.paid, count(P.id) from users U full outer join posts P on U.id = P.user_id where U.paid = true and P.category_id = 3 group by U.id;
 user_id | paid | count 
---------+------+-------
      14 | t    |     2
       3 | t    |     1
       7 | t    |     2
(3 rows)

blog_post_system=# select U.id as User_id, U.paid, P.id, count(P.id) from users U full outer join posts P on U.id = P.user_id where U.paid = true and P.category_id = 3 group by U.id;
ERROR:  column "p.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id as User_id, U.paid, P.id, count(P.id) from users...
                                        ^
blog_post_system=# select U.id as User_id, U.paid, count(P.id) from users U full outer join posts P on U.id = P.user_id where U.paid = true and P.category_id = 3 group by U.id;
 user_id | paid | count 
---------+------+-------
      14 | t    |     2
       3 | t    |     1
       7 | t    |     2
(3 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# ^Z
[1]+  Stopped                 psql
postgres@beryl-Latitude-E5520:/home/beryl$  select count(P.id) from users U join posts P on U.id = P.user_id join categories C on C.id = P.category_id where U.name = 'Pankaj' and C.name = 'Foods';
bash: syntax error near unexpected token `('
postgres@beryl-Latitude-E5520:/home/beryl$ psql
Password: 
psql (9.5.19)
Type "help" for help.

postgres=# \c blog_post_system
You are now connected to database "blog_post_system" as user "postgres".
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select * from users U join posts P on U.id = P.user_id;
 id |  name   | address  | paid | id | user_id |   title   |            content             | category_id 
----+---------+----------+------+----+---------+-----------+--------------------------------+-------------
 10 | Bittu   | Patna    | t    |  5 |      10 | a goods   | Goods are heavy.               |           1
  5 | Rohit   | Hariyana | f    |  1 |       5 | a mango   | Mangoes are sweets.            |           2
  5 | Rohit   | Hariyana | f    |  2 |       5 | a banana  | Bananas are sweets and yellow. |           2
 10 | Bittu   | Patna    | t    |  3 |      10 | a banana  | Bananas are sweets and yellow. |           2
 10 | Bittu   | Patna    | t    |  4 |      10 | a book    | Books are good.                |           5
  1 | Pankaj  | Patna    | f    |  6 |       1 | a food    | foods are heavy.               |           3
  3 | Saurabh | Delhi    | t    |  7 |       3 | a food    | foods are light.               |           3
 14 | Naveen  | Patiala  | t    |  8 |      14 | a food    | foods are light.               |           3
 14 | Naveen  | Patiala  | t    |  9 |      14 | the goods | goods are light.               |           1
 14 | Naveen  | Patiala  | t    | 10 |      14 | a food    | foods are good.                |           3
 14 | Naveen  | Patiala  | t    | 11 |      14 | a cloth   | cloths are red.                |           8
 14 | Naveen  | Patiala  | t    | 12 |      14 | a wood    | woods are heavy.               |           4
  7 | Manjeet | Patiala  | t    | 13 |       7 | a food    | foods are light.               |           3
  7 | Manjeet | Patiala  | t    | 14 |       7 | a cloth   | cloths are red.                |           8
  7 | Manjeet | Patiala  | t    | 15 |       7 | a food    | foods are heavy.               |           3
  7 | Manjeet | Patiala  | t    | 16 |       7 | a goods   | Goods are heavy.               |           1
  7 | Manjeet | Patiala  | t    | 17 |       7 | a goods   | Goods are heavy.               |           1
(17 rows)

blog_post_system=# select * from users U join posts P on U.id = P.user_id U.paid = false;
ERROR:  syntax error at or near "U"
LINE 1: ...t * from users U join posts P on U.id = P.user_id U.paid = f...
                                                             ^
blog_post_system=# select * from users U join posts P on U.id = P.user_id where U.paid = false;
 id |  name  | address  | paid | id | user_id |  title   |            content             | category_id 
----+--------+----------+------+----+---------+----------+--------------------------------+-------------
  5 | Rohit  | Hariyana | f    |  1 |       5 | a mango  | Mangoes are sweets.            |           2
  5 | Rohit  | Hariyana | f    |  2 |       5 | a banana | Bananas are sweets and yellow. |           2
  1 | Pankaj | Patna    | f    |  6 |       1 | a food   | foods are heavy.               |           3
(3 rows)

blog_post_system=# 
blog_post_system=# select * from users U full outer join posts P on U.id = P.user_id where U.paid = false;
 id |  name   | address  | paid | id | user_id |  title   |            content             | category_id 
----+---------+----------+------+----+---------+----------+--------------------------------+-------------
  5 | Rohit   | Hariyana | f    |  1 |       5 | a mango  | Mangoes are sweets.            |           2
  5 | Rohit   | Hariyana | f    |  2 |       5 | a banana | Bananas are sweets and yellow. |           2
  1 | Pankaj  | Patna    | f    |  6 |       1 | a food   | foods are heavy.               |           3
 15 | Praveen | Chhapra  | f    |    |         |          |                                |            
  8 | Motilal | Chhapra  | f    |    |         |          |                                |            
 16 | John    | Goa      | f    |    |         |          |                                |            
  4 | Mohit   | Delhi    | f    |    |         |          |                                |            
  9 | Bittu   | Chhapra  | f    |    |         |          |                                |            
(8 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select * from users U full outer join posts P on U.id = P.user_id full outer join likes L where U.paid = false;
ERROR:  syntax error at or near "where"
LINE 1: ...sts P on U.id = P.user_id full outer join likes L where U.pa...
                                                             ^
blog_post_system=# select * from users U full outer join posts P on U.id = P.user_id full outer join likes L on U.id = L.user_id where U.paid = false; 
 id |  name   | address  | paid | id | user_id |  title   |            content             | category_id | id | user_id | post_id 
----+---------+----------+------+----+---------+----------+--------------------------------+-------------+----+---------+---------
  1 | Pankaj  | Patna    | f    |  6 |       1 | a food   | foods are heavy.               |           3 |  1 |       1 |       1
  1 | Pankaj  | Patna    | f    |  6 |       1 | a food   | foods are heavy.               |           3 |  2 |       1 |       2
  4 | Mohit   | Delhi    | f    |    |         |          |                                |             |  6 |       4 |       6
  4 | Mohit   | Delhi    | f    |    |         |          |                                |             |  7 |       4 |       6
  4 | Mohit   | Delhi    | f    |    |         |          |                                |             |  8 |       4 |      12
 15 | Praveen | Chhapra  | f    |    |         |          |                                |             |    |         |        
  5 | Rohit   | Hariyana | f    |  2 |       5 | a banana | Bananas are sweets and yellow. |           2 |    |         |        
  5 | Rohit   | Hariyana | f    |  1 |       5 | a mango  | Mangoes are sweets.            |           2 |    |         |        
  8 | Motilal | Chhapra  | f    |    |         |          |                                |             |    |         |        
 16 | John    | Goa      | f    |    |         |          |                                |             |    |         |        
  9 | Bittu   | Chhapra  | f    |    |         |          |                                |             |    |         |        
(11 rows)

blog_post_system=# select * from users U full outer join posts P on U.id = P.user_id full outer join likes L on U.id = L.user_id and P.id = L.post_id where U.paid = false;
 id |  name   | address  | paid | id | user_id |  title   |            content             | category_id | id | user_id | post_id 
----+---------+----------+------+----+---------+----------+--------------------------------+-------------+----+---------+---------
  8 | Motilal | Chhapra  | f    |    |         |          |                                |             |    |         |        
  1 | Pankaj  | Patna    | f    |  6 |       1 | a food   | foods are heavy.               |           3 |    |         |        
  5 | Rohit   | Hariyana | f    |  1 |       5 | a mango  | Mangoes are sweets.            |           2 |    |         |        
  5 | Rohit   | Hariyana | f    |  2 |       5 | a banana | Bananas are sweets and yellow. |           2 |    |         |        
 16 | John    | Goa      | f    |    |         |          |                                |             |    |         |        
 15 | Praveen | Chhapra  | f    |    |         |          |                                |             |    |         |        
  4 | Mohit   | Delhi    | f    |    |         |          |                                |             |    |         |        
  9 | Bittu   | Chhapra  | f    |    |         |          |                                |             |    |         |        
(8 rows)

blog_post_system=# select * from users U full outer join posts P on U.id = P.user_id full outer join likes L on U.id = L.user_id and P.id = L.post_id where U.paid = true;
 id |  name   | address | paid | id | user_id |   title   |            content             | category_id | id | user_id | post_id 
----+---------+---------+------+----+---------+-----------+--------------------------------+-------------+----+---------+---------
 14 | Naveen  | Patiala | t    | 12 |      14 | a wood    | woods are heavy.               |           4 |  9 |      14 |      12
 14 | Naveen  | Patiala | t    | 11 |      14 | a cloth   | cloths are red.                |           8 | 10 |      14 |      11
  7 | Manjeet | Patiala | t    | 14 |       7 | a cloth   | cloths are red.                |           8 |    |         |        
 14 | Naveen  | Patiala | t    |  9 |      14 | the goods | goods are light.               |           1 |    |         |        
  3 | Saurabh | Delhi   | t    |  7 |       3 | a food    | foods are light.               |           3 |    |         |        
  7 | Manjeet | Patiala | t    | 16 |       7 | a goods   | Goods are heavy.               |           1 |    |         |        
 10 | Bittu   | Patna   | t    |  5 |      10 | a goods   | Goods are heavy.               |           1 |    |         |        
 11 | Pavan   | Patna   | t    |    |         |           |                                |             |    |         |        
 14 | Naveen  | Patiala | t    |  8 |      14 | a food    | foods are light.               |           3 |    |         |        
 17 | Doe     | Goa     | t    |    |         |           |                                |             |    |         |        
 12 | Pavan   | Chhapra | t    |    |         |           |                                |             |    |         |        
  6 | Gundeep | Patiala | t    |    |         |           |                                |             |    |         |        
  2 | Pankaj  | Patna   | t    |    |         |           |                                |             |    |         |        
 10 | Bittu   | Patna   | t    |  3 |      10 | a banana  | Bananas are sweets and yellow. |           2 |    |         |        
  7 | Manjeet | Patiala | t    | 13 |       7 | a food    | foods are light.               |           3 |    |         |        
 10 | Bittu   | Patna   | t    |  4 |      10 | a book    | Books are good.                |           5 |    |         |        
 13 | Naveen  | Chhapra | t    |    |         |           |                                |             |    |         |        
  7 | Manjeet | Patiala | t    | 15 |       7 | a food    | foods are heavy.               |           3 |    |         |        
  7 | Manjeet | Patiala | t    | 17 |       7 | a goods   | Goods are heavy.               |           1 |    |         |        
 14 | Naveen  | Patiala | t    | 10 |      14 | a food    | foods are good.                |           3 |    |         |        
(20 rows)

blog_post_system=# select * from users U full outer join posts P on U.id = P.user_id full outer join likes L on U.id = L.user_id and P.id = L.post_id where U.paid = false;
 id |  name   | address  | paid | id | user_id |  title   |            content             | category_id | id | user_id | post_id 
----+---------+----------+------+----+---------+----------+--------------------------------+-------------+----+---------+---------
  8 | Motilal | Chhapra  | f    |    |         |          |                                |             |    |         |        
  1 | Pankaj  | Patna    | f    |  6 |       1 | a food   | foods are heavy.               |           3 |    |         |        
  5 | Rohit   | Hariyana | f    |  1 |       5 | a mango  | Mangoes are sweets.            |           2 |    |         |        
  5 | Rohit   | Hariyana | f    |  2 |       5 | a banana | Bananas are sweets and yellow. |           2 |    |         |        
 16 | John    | Goa      | f    |    |         |          |                                |             |    |         |        
 15 | Praveen | Chhapra  | f    |    |         |          |                                |             |    |         |        
  4 | Mohit   | Delhi    | f    |    |         |          |                                |             |    |         |        
  9 | Bittu   | Chhapra  | f    |    |         |          |                                |             |    |         |        
(8 rows)

blog_post_system=# select count(L.id) from users U full outer join posts P on U.id = P.user_id full outer join likes L on U.id = L.user_id and P.id = L.post_id where U.paid = false;
 count 
-------
     0
(1 row)

blog_post_system=# select count(L.id) from users U full outer join posts P on U.id = P.user_id full outer join likes L on U.id = L.user_id where U.paid = false;
 count 
-------
     5
(1 row)

blog_post_system=# select count(L.id) from users U full outer join posts P on U.id = P.user_id full outer join likes L on U.id = L.user_id where U.paid = false;
 count 
-------
     5
(1 row)

blog_post_system=# select count(L.id) from users U full outer join posts P on U.id = P.user_id full outer join likes L on U.id = L.user_id where U.paid = false;
 count 
-------
     5
(1 row)

blog_post_system=# select count(L.id) from users U full outer join posts P on U.id = P.user_id full outer join likes L on P.id = L.post_id where U.paid = false;
 count 
-------
     6
(1 row)

blog_post_system=# select * from users U left outer join Like L on U.id = L.user_id;
ERROR:  syntax error at or near "L"
LINE 1: select * from users U left outer join Like L on U.id = L.use...
                                                   ^
blog_post_system=# select * from users U left outer join Likes L on U.id = L.user_id;
 id |  name   | address  | paid | id | user_id | post_id 
----+---------+----------+------+----+---------+---------
  1 | Pankaj  | Patna    | f    |  1 |       1 |       1
  1 | Pankaj  | Patna    | f    |  2 |       1 |       2
  2 | Pankaj  | Patna    | t    |  3 |       2 |       1
  2 | Pankaj  | Patna    | t    |  4 |       2 |       5
  2 | Pankaj  | Patna    | t    |  5 |       2 |       6
  4 | Mohit   | Delhi    | f    |  6 |       4 |       6
  4 | Mohit   | Delhi    | f    |  7 |       4 |       6
  4 | Mohit   | Delhi    | f    |  8 |       4 |      12
 14 | Naveen  | Patiala  | t    |  9 |      14 |      12
 14 | Naveen  | Patiala  | t    | 10 |      14 |      11
 11 | Pavan   | Patna    | t    | 11 |      11 |      11
 17 | Doe     | Goa      | t    |    |         |        
 12 | Pavan   | Chhapra  | t    |    |         |        
 10 | Bittu   | Patna    | t    |    |         |        
 15 | Praveen | Chhapra  | f    |    |         |        
 13 | Naveen  | Chhapra  | t    |    |         |        
  5 | Rohit   | Hariyana | f    |    |         |        
  8 | Motilal | Chhapra  | f    |    |         |        
  6 | Gundeep | Patiala  | t    |    |         |        
 16 | John    | Goa      | f    |    |         |        
  3 | Saurabh | Delhi    | t    |    |         |        
  9 | Bittu   | Chhapra  | f    |    |         |        
  7 | Manjeet | Patiala  | t    |    |         |        
(23 rows)

blog_post_system=# select * from users U full outer join Likes L on U.id = L.user_id;
 id |  name   | address  | paid | id | user_id | post_id 
----+---------+----------+------+----+---------+---------
  1 | Pankaj  | Patna    | f    |  1 |       1 |       1
  1 | Pankaj  | Patna    | f    |  2 |       1 |       2
  2 | Pankaj  | Patna    | t    |  3 |       2 |       1
  2 | Pankaj  | Patna    | t    |  4 |       2 |       5
  2 | Pankaj  | Patna    | t    |  5 |       2 |       6
  4 | Mohit   | Delhi    | f    |  6 |       4 |       6
  4 | Mohit   | Delhi    | f    |  7 |       4 |       6
  4 | Mohit   | Delhi    | f    |  8 |       4 |      12
 14 | Naveen  | Patiala  | t    |  9 |      14 |      12
 14 | Naveen  | Patiala  | t    | 10 |      14 |      11
 11 | Pavan   | Patna    | t    | 11 |      11 |      11
 17 | Doe     | Goa      | t    |    |         |        
 12 | Pavan   | Chhapra  | t    |    |         |        
 10 | Bittu   | Patna    | t    |    |         |        
 15 | Praveen | Chhapra  | f    |    |         |        
 13 | Naveen  | Chhapra  | t    |    |         |        
  5 | Rohit   | Hariyana | f    |    |         |        
  8 | Motilal | Chhapra  | f    |    |         |        
  6 | Gundeep | Patiala  | t    |    |         |        
 16 | John    | Goa      | f    |    |         |        
  3 | Saurabh | Delhi    | t    |    |         |        
  9 | Bittu   | Chhapra  | f    |    |         |        
  7 | Manjeet | Patiala  | t    |    |         |        
(23 rows)

blog_post_system=# select * from users U full join Likes L on U.id = L.user_id;
 id |  name   | address  | paid | id | user_id | post_id 
----+---------+----------+------+----+---------+---------
  1 | Pankaj  | Patna    | f    |  1 |       1 |       1
  1 | Pankaj  | Patna    | f    |  2 |       1 |       2
  2 | Pankaj  | Patna    | t    |  3 |       2 |       1
  2 | Pankaj  | Patna    | t    |  4 |       2 |       5
  2 | Pankaj  | Patna    | t    |  5 |       2 |       6
  4 | Mohit   | Delhi    | f    |  6 |       4 |       6
  4 | Mohit   | Delhi    | f    |  7 |       4 |       6
  4 | Mohit   | Delhi    | f    |  8 |       4 |      12
 14 | Naveen  | Patiala  | t    |  9 |      14 |      12
 14 | Naveen  | Patiala  | t    | 10 |      14 |      11
 11 | Pavan   | Patna    | t    | 11 |      11 |      11
 17 | Doe     | Goa      | t    |    |         |        
 12 | Pavan   | Chhapra  | t    |    |         |        
 10 | Bittu   | Patna    | t    |    |         |        
 15 | Praveen | Chhapra  | f    |    |         |        
 13 | Naveen  | Chhapra  | t    |    |         |        
  5 | Rohit   | Hariyana | f    |    |         |        
  8 | Motilal | Chhapra  | f    |    |         |        
  6 | Gundeep | Patiala  | t    |    |         |        
 16 | John    | Goa      | f    |    |         |        
  3 | Saurabh | Delhi    | t    |    |         |        
  9 | Bittu   | Chhapra  | f    |    |         |        
  7 | Manjeet | Patiala  | t    |    |         |        
(23 rows)

blog_post_system=# select * from users U right outer join Likes L on U.id = L.user_id;
 id |  name  | address | paid | id | user_id | post_id 
----+--------+---------+------+----+---------+---------
  1 | Pankaj | Patna   | f    |  1 |       1 |       1
  1 | Pankaj | Patna   | f    |  2 |       1 |       2
  2 | Pankaj | Patna   | t    |  3 |       2 |       1
  2 | Pankaj | Patna   | t    |  4 |       2 |       5
  2 | Pankaj | Patna   | t    |  5 |       2 |       6
  4 | Mohit  | Delhi   | f    |  6 |       4 |       6
  4 | Mohit  | Delhi   | f    |  7 |       4 |       6
  4 | Mohit  | Delhi   | f    |  8 |       4 |      12
 14 | Naveen | Patiala | t    |  9 |      14 |      12
 14 | Naveen | Patiala | t    | 10 |      14 |      11
 11 | Pavan  | Patna   | t    | 11 |      11 |      11
(11 rows)

blog_post_system=# select * from likes;
 id | user_id | post_id 
----+---------+---------
  1 |       1 |       1
  2 |       1 |       2
  3 |       2 |       1
  4 |       2 |       5
  5 |       2 |       6
  6 |       4 |       6
  7 |       4 |       6
  8 |       4 |      12
  9 |      14 |      12
 10 |      14 |      11
 11 |      11 |      11
(11 rows)

blog_post_system=# select * from users U right outer join Likes L on U.id = L.user_id;
 id |  name  | address | paid | id | user_id | post_id 
----+--------+---------+------+----+---------+---------
  1 | Pankaj | Patna   | f    |  1 |       1 |       1
  1 | Pankaj | Patna   | f    |  2 |       1 |       2
  2 | Pankaj | Patna   | t    |  3 |       2 |       1
  2 | Pankaj | Patna   | t    |  4 |       2 |       5
  2 | Pankaj | Patna   | t    |  5 |       2 |       6
  4 | Mohit  | Delhi   | f    |  6 |       4 |       6
  4 | Mohit  | Delhi   | f    |  7 |       4 |       6
  4 | Mohit  | Delhi   | f    |  8 |       4 |      12
 14 | Naveen | Patiala | t    |  9 |      14 |      12
 14 | Naveen | Patiala | t    | 10 |      14 |      11
 11 | Pavan  | Patna   | t    | 11 |      11 |      11
(11 rows)

blog_post_system=# select * from users U right outer join Likes L on U.id = L.user_id;
 id |  name  | address | paid | id | user_id | post_id 
----+--------+---------+------+----+---------+---------
  1 | Pankaj | Patna   | f    |  1 |       1 |       1
  1 | Pankaj | Patna   | f    |  2 |       1 |       2
  2 | Pankaj | Patna   | t    |  3 |       2 |       1
  2 | Pankaj | Patna   | t    |  4 |       2 |       5
  2 | Pankaj | Patna   | t    |  5 |       2 |       6
  4 | Mohit  | Delhi   | f    |  6 |       4 |       6
  4 | Mohit  | Delhi   | f    |  7 |       4 |       6
  4 | Mohit  | Delhi   | f    |  8 |       4 |      12
 14 | Naveen | Patiala | t    |  9 |      14 |      12
 14 | Naveen | Patiala | t    | 10 |      14 |      11
 11 | Pavan  | Patna   | t    | 11 |      11 |      11
(11 rows)

blog_post_system=# select * from users U left outer join Likes L on U.id = L.user_id;
 id |  name   | address  | paid | id | user_id | post_id 
----+---------+----------+------+----+---------+---------
  1 | Pankaj  | Patna    | f    |  1 |       1 |       1
  1 | Pankaj  | Patna    | f    |  2 |       1 |       2
  2 | Pankaj  | Patna    | t    |  3 |       2 |       1
  2 | Pankaj  | Patna    | t    |  4 |       2 |       5
  2 | Pankaj  | Patna    | t    |  5 |       2 |       6
  4 | Mohit   | Delhi    | f    |  6 |       4 |       6
  4 | Mohit   | Delhi    | f    |  7 |       4 |       6
  4 | Mohit   | Delhi    | f    |  8 |       4 |      12
 14 | Naveen  | Patiala  | t    |  9 |      14 |      12
 14 | Naveen  | Patiala  | t    | 10 |      14 |      11
 11 | Pavan   | Patna    | t    | 11 |      11 |      11
 17 | Doe     | Goa      | t    |    |         |        
 12 | Pavan   | Chhapra  | t    |    |         |        
 10 | Bittu   | Patna    | t    |    |         |        
 15 | Praveen | Chhapra  | f    |    |         |        
 13 | Naveen  | Chhapra  | t    |    |         |        
  5 | Rohit   | Hariyana | f    |    |         |        
  8 | Motilal | Chhapra  | f    |    |         |        
  6 | Gundeep | Patiala  | t    |    |         |        
 16 | John    | Goa      | f    |    |         |        
  3 | Saurabh | Delhi    | t    |    |         |        
  9 | Bittu   | Chhapra  | f    |    |         |        
  7 | Manjeet | Patiala  | t    |    |         |        
(23 rows)

blog_post_system=# select * from Likes L left outer join users U on U.id = L.user_id;
 id | user_id | post_id | id |  name  | address | paid 
----+---------+---------+----+--------+---------+------
  1 |       1 |       1 |  1 | Pankaj | Patna   | f
  2 |       1 |       2 |  1 | Pankaj | Patna   | f
  3 |       2 |       1 |  2 | Pankaj | Patna   | t
  4 |       2 |       5 |  2 | Pankaj | Patna   | t
  5 |       2 |       6 |  2 | Pankaj | Patna   | t
  6 |       4 |       6 |  4 | Mohit  | Delhi   | f
  7 |       4 |       6 |  4 | Mohit  | Delhi   | f
  8 |       4 |      12 |  4 | Mohit  | Delhi   | f
  9 |      14 |      12 | 14 | Naveen | Patiala | t
 10 |      14 |      11 | 14 | Naveen | Patiala | t
 11 |      11 |      11 | 11 | Pavan  | Patna   | t
(11 rows)

blog_post_system=# select * from Likes L right outer join users U on U.id = L.user_id;
 id | user_id | post_id | id |  name   | address  | paid 
----+---------+---------+----+---------+----------+------
  1 |       1 |       1 |  1 | Pankaj  | Patna    | f
  2 |       1 |       2 |  1 | Pankaj  | Patna    | f
  3 |       2 |       1 |  2 | Pankaj  | Patna    | t
  4 |       2 |       5 |  2 | Pankaj  | Patna    | t
  5 |       2 |       6 |  2 | Pankaj  | Patna    | t
  6 |       4 |       6 |  4 | Mohit   | Delhi    | f
  7 |       4 |       6 |  4 | Mohit   | Delhi    | f
  8 |       4 |      12 |  4 | Mohit   | Delhi    | f
  9 |      14 |      12 | 14 | Naveen  | Patiala  | t
 10 |      14 |      11 | 14 | Naveen  | Patiala  | t
 11 |      11 |      11 | 11 | Pavan   | Patna    | t
    |         |         | 17 | Doe     | Goa      | t
    |         |         | 12 | Pavan   | Chhapra  | t
    |         |         | 10 | Bittu   | Patna    | t
    |         |         | 15 | Praveen | Chhapra  | f
    |         |         | 13 | Naveen  | Chhapra  | t
    |         |         |  5 | Rohit   | Hariyana | f
    |         |         |  8 | Motilal | Chhapra  | f
    |         |         |  6 | Gundeep | Patiala  | t
    |         |         | 16 | John    | Goa      | f
    |         |         |  3 | Saurabh | Delhi    | t
    |         |         |  9 | Bittu   | Chhapra  | f
    |         |         |  7 | Manjeet | Patiala  | t
(23 rows)

blog_post_system=# select * from Likes L full outer join users U on U.id = L.user_id;
 id | user_id | post_id | id |  name   | address  | paid 
----+---------+---------+----+---------+----------+------
  1 |       1 |       1 |  1 | Pankaj  | Patna    | f
  2 |       1 |       2 |  1 | Pankaj  | Patna    | f
  3 |       2 |       1 |  2 | Pankaj  | Patna    | t
  4 |       2 |       5 |  2 | Pankaj  | Patna    | t
  5 |       2 |       6 |  2 | Pankaj  | Patna    | t
  6 |       4 |       6 |  4 | Mohit   | Delhi    | f
  7 |       4 |       6 |  4 | Mohit   | Delhi    | f
  8 |       4 |      12 |  4 | Mohit   | Delhi    | f
  9 |      14 |      12 | 14 | Naveen  | Patiala  | t
 10 |      14 |      11 | 14 | Naveen  | Patiala  | t
 11 |      11 |      11 | 11 | Pavan   | Patna    | t
    |         |         | 17 | Doe     | Goa      | t
    |         |         | 12 | Pavan   | Chhapra  | t
    |         |         | 10 | Bittu   | Patna    | t
    |         |         | 15 | Praveen | Chhapra  | f
    |         |         | 13 | Naveen  | Chhapra  | t
    |         |         |  5 | Rohit   | Hariyana | f
    |         |         |  8 | Motilal | Chhapra  | f
    |         |         |  6 | Gundeep | Patiala  | t
    |         |         | 16 | John    | Goa      | f
    |         |         |  3 | Saurabh | Delhi    | t
    |         |         |  9 | Bittu   | Chhapra  | f
    |         |         |  7 | Manjeet | Patiala  | t
(23 rows)

blog_post_system=# select * from users U left outer join Likes L on U.id = L.user_id;
 id |  name   | address  | paid | id | user_id | post_id 
----+---------+----------+------+----+---------+---------
  1 | Pankaj  | Patna    | f    |  1 |       1 |       1
  1 | Pankaj  | Patna    | f    |  2 |       1 |       2
  2 | Pankaj  | Patna    | t    |  3 |       2 |       1
  2 | Pankaj  | Patna    | t    |  4 |       2 |       5
  2 | Pankaj  | Patna    | t    |  5 |       2 |       6
  4 | Mohit   | Delhi    | f    |  6 |       4 |       6
  4 | Mohit   | Delhi    | f    |  7 |       4 |       6
  4 | Mohit   | Delhi    | f    |  8 |       4 |      12
 14 | Naveen  | Patiala  | t    |  9 |      14 |      12
 14 | Naveen  | Patiala  | t    | 10 |      14 |      11
 11 | Pavan   | Patna    | t    | 11 |      11 |      11
 17 | Doe     | Goa      | t    |    |         |        
 12 | Pavan   | Chhapra  | t    |    |         |        
 10 | Bittu   | Patna    | t    |    |         |        
 15 | Praveen | Chhapra  | f    |    |         |        
 13 | Naveen  | Chhapra  | t    |    |         |        
  5 | Rohit   | Hariyana | f    |    |         |        
  8 | Motilal | Chhapra  | f    |    |         |        
  6 | Gundeep | Patiala  | t    |    |         |        
 16 | John    | Goa      | f    |    |         |        
  3 | Saurabh | Delhi    | t    |    |         |        
  9 | Bittu   | Chhapra  | f    |    |         |        
  7 | Manjeet | Patiala  | t    |    |         |        
(23 rows)

blog_post_system=# select * from users U left outer join Likes L on U.id = L.user_id;
 id |  name   | address  | paid | id | user_id | post_id 
----+---------+----------+------+----+---------+---------
  1 | Pankaj  | Patna    | f    |  1 |       1 |       1
  1 | Pankaj  | Patna    | f    |  2 |       1 |       2
  2 | Pankaj  | Patna    | t    |  3 |       2 |       1
  2 | Pankaj  | Patna    | t    |  4 |       2 |       5
  2 | Pankaj  | Patna    | t    |  5 |       2 |       6
  4 | Mohit   | Delhi    | f    |  6 |       4 |       6
  4 | Mohit   | Delhi    | f    |  7 |       4 |       6
  4 | Mohit   | Delhi    | f    |  8 |       4 |      12
 14 | Naveen  | Patiala  | t    |  9 |      14 |      12
 14 | Naveen  | Patiala  | t    | 10 |      14 |      11
 11 | Pavan   | Patna    | t    | 11 |      11 |      11
 17 | Doe     | Goa      | t    |    |         |        
 12 | Pavan   | Chhapra  | t    |    |         |        
 10 | Bittu   | Patna    | t    |    |         |        
 15 | Praveen | Chhapra  | f    |    |         |        
 13 | Naveen  | Chhapra  | t    |    |         |        
  5 | Rohit   | Hariyana | f    |    |         |        
  8 | Motilal | Chhapra  | f    |    |         |        
  6 | Gundeep | Patiala  | t    |    |         |        
 16 | John    | Goa      | f    |    |         |        
  3 | Saurabh | Delhi    | t    |    |         |        
  9 | Bittu   | Chhapra  | f    |    |         |        
  7 | Manjeet | Patiala  | t    |    |         |        
(23 rows)

blog_post_system=# select * from users U left outer join Likes L on U.id = L.user_id;
 id |  name   | address  | paid | id | user_id | post_id 
----+---------+----------+------+----+---------+---------
  1 | Pankaj  | Patna    | f    |  1 |       1 |       1
  1 | Pankaj  | Patna    | f    |  2 |       1 |       2
  2 | Pankaj  | Patna    | t    |  3 |       2 |       1
  2 | Pankaj  | Patna    | t    |  4 |       2 |       5
  2 | Pankaj  | Patna    | t    |  5 |       2 |       6
  4 | Mohit   | Delhi    | f    |  6 |       4 |       6
  4 | Mohit   | Delhi    | f    |  7 |       4 |       6
  4 | Mohit   | Delhi    | f    |  8 |       4 |      12
 14 | Naveen  | Patiala  | t    |  9 |      14 |      12
 14 | Naveen  | Patiala  | t    | 10 |      14 |      11
 11 | Pavan   | Patna    | t    | 11 |      11 |      11
 17 | Doe     | Goa      | t    |    |         |        
 12 | Pavan   | Chhapra  | t    |    |         |        
 10 | Bittu   | Patna    | t    |    |         |        
 15 | Praveen | Chhapra  | f    |    |         |        
 13 | Naveen  | Chhapra  | t    |    |         |        
  5 | Rohit   | Hariyana | f    |    |         |        
  8 | Motilal | Chhapra  | f    |    |         |        
  6 | Gundeep | Patiala  | t    |    |         |        
 16 | John    | Goa      | f    |    |         |        
  3 | Saurabh | Delhi    | t    |    |         |        
  9 | Bittu   | Chhapra  | f    |    |         |        
  7 | Manjeet | Patiala  | t    |    |         |        
(23 rows)

blog_post_system=# select * from Likes L left outer join users U on U.id = L.user_id;
 id | user_id | post_id | id |  name  | address | paid 
----+---------+---------+----+--------+---------+------
  1 |       1 |       1 |  1 | Pankaj | Patna   | f
  2 |       1 |       2 |  1 | Pankaj | Patna   | f
  3 |       2 |       1 |  2 | Pankaj | Patna   | t
  4 |       2 |       5 |  2 | Pankaj | Patna   | t
  5 |       2 |       6 |  2 | Pankaj | Patna   | t
  6 |       4 |       6 |  4 | Mohit  | Delhi   | f
  7 |       4 |       6 |  4 | Mohit  | Delhi   | f
  8 |       4 |      12 |  4 | Mohit  | Delhi   | f
  9 |      14 |      12 | 14 | Naveen | Patiala | t
 10 |      14 |      11 | 14 | Naveen | Patiala | t
 11 |      11 |      11 | 11 | Pavan  | Patna   | t
(11 rows)

blog_post_system=# select * from Likes L join users U on U.id = L.user_id;
 id | user_id | post_id | id |  name  | address | paid 
----+---------+---------+----+--------+---------+------
  1 |       1 |       1 |  1 | Pankaj | Patna   | f
  2 |       1 |       2 |  1 | Pankaj | Patna   | f
  3 |       2 |       1 |  2 | Pankaj | Patna   | t
  4 |       2 |       5 |  2 | Pankaj | Patna   | t
  5 |       2 |       6 |  2 | Pankaj | Patna   | t
  6 |       4 |       6 |  4 | Mohit  | Delhi   | f
  7 |       4 |       6 |  4 | Mohit  | Delhi   | f
  8 |       4 |      12 |  4 | Mohit  | Delhi   | f
  9 |      14 |      12 | 14 | Naveen | Patiala | t
 10 |      14 |      11 | 14 | Naveen | Patiala | t
 11 |      11 |      11 | 11 | Pavan  | Patna   | t
(11 rows)

blog_post_system=# select * from Likes L cross join users U on U.id = L.user_id;
ERROR:  syntax error at or near "on"
LINE 1: select * from Likes L cross join users U on U.id = L.user_id...
                                                 ^
blog_post_system=# select * from Likes L cross join users U;
blog_post_system=# select * from Likes L inner join users U;
ERROR:  syntax error at or near ";"
LINE 1: select * from Likes L inner join users U;
                                                ^
blog_post_system=# select * from Likes L left outer join users U on U.id = L.user_id;
 id | user_id | post_id | id |  name  | address | paid 
----+---------+---------+----+--------+---------+------
  1 |       1 |       1 |  1 | Pankaj | Patna   | f
  2 |       1 |       2 |  1 | Pankaj | Patna   | f
  3 |       2 |       1 |  2 | Pankaj | Patna   | t
  4 |       2 |       5 |  2 | Pankaj | Patna   | t
  5 |       2 |       6 |  2 | Pankaj | Patna   | t
  6 |       4 |       6 |  4 | Mohit  | Delhi   | f
  7 |       4 |       6 |  4 | Mohit  | Delhi   | f
  8 |       4 |      12 |  4 | Mohit  | Delhi   | f
  9 |      14 |      12 | 14 | Naveen | Patiala | t
 10 |      14 |      11 | 14 | Naveen | Patiala | t
 11 |      11 |      11 | 11 | Pavan  | Patna   | t
(11 rows)

blog_post_system=# 
blog_post_system=# select * from Likes L inner join users U on U.id = L.user_id;
 id | user_id | post_id | id |  name  | address | paid 
----+---------+---------+----+--------+---------+------
  1 |       1 |       1 |  1 | Pankaj | Patna   | f
  2 |       1 |       2 |  1 | Pankaj | Patna   | f
  3 |       2 |       1 |  2 | Pankaj | Patna   | t
  4 |       2 |       5 |  2 | Pankaj | Patna   | t
  5 |       2 |       6 |  2 | Pankaj | Patna   | t
  6 |       4 |       6 |  4 | Mohit  | Delhi   | f
  7 |       4 |       6 |  4 | Mohit  | Delhi   | f
  8 |       4 |      12 |  4 | Mohit  | Delhi   | f
  9 |      14 |      12 | 14 | Naveen | Patiala | t
 10 |      14 |      11 | 14 | Naveen | Patiala | t
 11 |      11 |      11 | 11 | Pavan  | Patna   | t
(11 rows)

blog_post_system=# select * from users U inner join likes L on U.id = L.user_id;
 id |  name  | address | paid | id | user_id | post_id 
----+--------+---------+------+----+---------+---------
  1 | Pankaj | Patna   | f    |  1 |       1 |       1
  1 | Pankaj | Patna   | f    |  2 |       1 |       2
  2 | Pankaj | Patna   | t    |  3 |       2 |       1
  2 | Pankaj | Patna   | t    |  4 |       2 |       5
  2 | Pankaj | Patna   | t    |  5 |       2 |       6
  4 | Mohit  | Delhi   | f    |  6 |       4 |       6
  4 | Mohit  | Delhi   | f    |  7 |       4 |       6
  4 | Mohit  | Delhi   | f    |  8 |       4 |      12
 14 | Naveen | Patiala | t    |  9 |      14 |      12
 14 | Naveen | Patiala | t    | 10 |      14 |      11
 11 | Pavan  | Patna   | t    | 11 |      11 |      11
(11 rows)

blog_post_system=# 












=============================================================================














beryl@beryl-Latitude-E5520:~$ su postgres
Password: 
postgres@beryl-Latitude-E5520:/home/beryl$ psql
Password: 
psql (9.5.19)
Type "help" for help.

postgres=# \l
postgres=# \c blog_post_system
You are now connected to database "blog_post_system" as user "postgres".
blog_post_system=# 
blog_post_system=# 
blog_post_system=# \l
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select * from likes;
 id | user_id | post_id 
----+---------+---------
  1 |       1 |       1
  2 |       1 |       2
  3 |       2 |       1
  4 |       2 |       5
  5 |       2 |       6
  6 |       4 |       6
  7 |       4 |       6
  8 |       4 |      12
  9 |      14 |      12
 10 |      14 |      11
 11 |      11 |      11
(11 rows)

blog_post_system=# select * from users;
 id |  name   | address  | paid 
----+---------+----------+------
  1 | Pankaj  | Patna    | f
  2 | Pankaj  | Patna    | t
  3 | Saurabh | Delhi    | t
  4 | Mohit   | Delhi    | f
  5 | Rohit   | Hariyana | f
  6 | Gundeep | Patiala  | t
  7 | Manjeet | Patiala  | t
  8 | Motilal | Chhapra  | f
  9 | Bittu   | Chhapra  | f
 10 | Bittu   | Patna    | t
 11 | Pavan   | Patna    | t
 12 | Pavan   | Chhapra  | t
 13 | Naveen  | Chhapra  | t
 14 | Naveen  | Patiala  | t
 15 | Praveen | Chhapra  | f
 16 | John    | Goa      | f
 17 | Doe     | Goa      | t
(17 rows)

blog_post_system=# select U.id from users U full outer join likes L on U.id = L.user_id;
 id 
----
  1
  1
  2
  2
  2
  4
  4
  4
 14
 14
 11
 17
 12
 10
 15
 13
  5
  8
  6
 16
  3
  9
  7
(23 rows)

blog_post_system=# select * from users U full outer join likes L on U.id = L.user_id;
 id |  name   | address  | paid | id | user_id | post_id 
----+---------+----------+------+----+---------+---------
  1 | Pankaj  | Patna    | f    |  1 |       1 |       1
  1 | Pankaj  | Patna    | f    |  2 |       1 |       2
  2 | Pankaj  | Patna    | t    |  3 |       2 |       1
  2 | Pankaj  | Patna    | t    |  4 |       2 |       5
  2 | Pankaj  | Patna    | t    |  5 |       2 |       6
  4 | Mohit   | Delhi    | f    |  6 |       4 |       6
  4 | Mohit   | Delhi    | f    |  7 |       4 |       6
  4 | Mohit   | Delhi    | f    |  8 |       4 |      12
 14 | Naveen  | Patiala  | t    |  9 |      14 |      12
 14 | Naveen  | Patiala  | t    | 10 |      14 |      11
 11 | Pavan   | Patna    | t    | 11 |      11 |      11
 17 | Doe     | Goa      | t    |    |         |        
 12 | Pavan   | Chhapra  | t    |    |         |        
 10 | Bittu   | Patna    | t    |    |         |        
 15 | Praveen | Chhapra  | f    |    |         |        
 13 | Naveen  | Chhapra  | t    |    |         |        
  5 | Rohit   | Hariyana | f    |    |         |        
  8 | Motilal | Chhapra  | f    |    |         |        
  6 | Gundeep | Patiala  | t    |    |         |        
 16 | John    | Goa      | f    |    |         |        
  3 | Saurabh | Delhi    | t    |    |         |        
  9 | Bittu   | Chhapra  | f    |    |         |        
  7 | Manjeet | Patiala  | t    |    |         |        
(23 rows)

blog_post_system=# select * from users U right outer join likes L on U.id = L.user_id;
 id |  name  | address | paid | id | user_id | post_id 
----+--------+---------+------+----+---------+---------
  1 | Pankaj | Patna   | f    |  1 |       1 |       1
  1 | Pankaj | Patna   | f    |  2 |       1 |       2
  2 | Pankaj | Patna   | t    |  3 |       2 |       1
  2 | Pankaj | Patna   | t    |  4 |       2 |       5
  2 | Pankaj | Patna   | t    |  5 |       2 |       6
  4 | Mohit  | Delhi   | f    |  6 |       4 |       6
  4 | Mohit  | Delhi   | f    |  7 |       4 |       6
  4 | Mohit  | Delhi   | f    |  8 |       4 |      12
 14 | Naveen | Patiala | t    |  9 |      14 |      12
 14 | Naveen | Patiala | t    | 10 |      14 |      11
 11 | Pavan  | Patna   | t    | 11 |      11 |      11
(11 rows)

blog_post_system=# select U.id from users U full outer join likes L on U.id = L.user_id;
 id 
----
  1
  1
  2
  2
  2
  4
  4
  4
 14
 14
 11
 17
 12
 10
 15
 13
  5
  8
  6
 16
  3
  9
  7
(23 rows)

blog_post_system=# select U.id from users U right outer join likes L on U.id = L.user_id;
 id 
----
  1
  1
  2
  2
  2
  4
  4
  4
 14
 14
 11
(11 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select * from users U left outer join posts P on U.id = P.uesr_id inner join likes L on P.id = L.post_id;
ERROR:  column p.uesr_id does not exist
LINE 1: ... * from users U left outer join posts P on U.id = P.uesr_id ...
                                                             ^
HINT:  Perhaps you meant to reference the column "p.user_id".
blog_post_system=# select * from users U left outer join posts P on U.id = P.uesr_id;
ERROR:  column p.uesr_id does not exist
LINE 1: ... * from users U left outer join posts P on U.id = P.uesr_id;
                                                             ^
HINT:  Perhaps you meant to reference the column "p.user_id".
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select * from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id;
 id |  name  | address  | paid | id | user_id |  title   |            content             | category_id | id | user_id | post_id 
----+--------+----------+------+----+---------+----------+--------------------------------+-------------+----+---------+---------
  5 | Rohit  | Hariyana | f    |  1 |       5 | a mango  | Mangoes are sweets.            |           2 |  1 |       1 |       1
  5 | Rohit  | Hariyana | f    |  2 |       5 | a banana | Bananas are sweets and yellow. |           2 |  2 |       1 |       2
  5 | Rohit  | Hariyana | f    |  1 |       5 | a mango  | Mangoes are sweets.            |           2 |  3 |       2 |       1
 10 | Bittu  | Patna    | t    |  5 |      10 | a goods  | Goods are heavy.               |           1 |  4 |       2 |       5
  1 | Pankaj | Patna    | f    |  6 |       1 | a food   | foods are heavy.               |           3 |  5 |       2 |       6
  1 | Pankaj | Patna    | f    |  6 |       1 | a food   | foods are heavy.               |           3 |  6 |       4 |       6
  1 | Pankaj | Patna    | f    |  6 |       1 | a food   | foods are heavy.               |           3 |  7 |       4 |       6
 14 | Naveen | Patiala  | t    | 12 |      14 | a wood   | woods are heavy.               |           4 |  8 |       4 |      12
 14 | Naveen | Patiala  | t    | 12 |      14 | a wood   | woods are heavy.               |           4 |  9 |      14 |      12
 14 | Naveen | Patiala  | t    | 11 |      14 | a cloth  | cloths are red.                |           8 | 10 |      14 |      11
 14 | Naveen | Patiala  | t    | 11 |      14 | a cloth  | cloths are red.                |           8 | 11 |      11 |      11
(11 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select * from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false;
 id |  name  | address  | paid | id | user_id |  title   |            content             | category_id | id | user_id | post_id 
----+--------+----------+------+----+---------+----------+--------------------------------+-------------+----+---------+---------
  5 | Rohit  | Hariyana | f    |  1 |       5 | a mango  | Mangoes are sweets.            |           2 |  1 |       1 |       1
  5 | Rohit  | Hariyana | f    |  2 |       5 | a banana | Bananas are sweets and yellow. |           2 |  2 |       1 |       2
  5 | Rohit  | Hariyana | f    |  1 |       5 | a mango  | Mangoes are sweets.            |           2 |  3 |       2 |       1
  1 | Pankaj | Patna    | f    |  6 |       1 | a food   | foods are heavy.               |           3 |  5 |       2 |       6
  1 | Pankaj | Patna    | f    |  6 |       1 | a food   | foods are heavy.               |           3 |  6 |       4 |       6
  1 | Pankaj | Patna    | f    |  6 |       1 | a food   | foods are heavy.               |           3 |  7 |       4 |       6
(6 rows)

blog_post_system=# select count(P.id) from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false ;
 count 
-------
     6
(1 row)

blog_post_system=# select count(P.id),count(L.id) from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false ;
 count | count 
-------+-------
     6 |     6
(1 row)

blog_post_system=# select count(P.id),count(L.id) from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by U.id;
 count | count 
-------+-------
     3 |     3
     3 |     3
(2 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# select count(P.id),count(L.id) from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = true group by U.id;
 count | count 
-------+-------
     1 |     1
     4 |     4
(2 rows)

blog_post_system=# select count(P.id),count(L.id) from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by U.id;
 count | count 
-------+-------
     3 |     3
     3 |     3
(2 rows)

blog_post_system=# 
blog_post_system=# select count(P.id),count(L.id) from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by P.id;
 count | count 
-------+-------
     1 |     1
     3 |     3
     2 |     2
(3 rows)

blog_post_system=# select * from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by P.id;
ERROR:  column "u.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select * from users U left outer join posts P on U.id = P.us...
               ^
blog_post_system=# select * from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by U.id;
ERROR:  column "p.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select * from users U left outer join posts P on U.id = P.us...
               ^
blog_post_system=# select * from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false;
 id |  name  | address  | paid | id | user_id |  title   |            content             | category_id | id | user_id | post_id 
----+--------+----------+------+----+---------+----------+--------------------------------+-------------+----+---------+---------
  5 | Rohit  | Hariyana | f    |  1 |       5 | a mango  | Mangoes are sweets.            |           2 |  1 |       1 |       1
  5 | Rohit  | Hariyana | f    |  2 |       5 | a banana | Bananas are sweets and yellow. |           2 |  2 |       1 |       2
  5 | Rohit  | Hariyana | f    |  1 |       5 | a mango  | Mangoes are sweets.            |           2 |  3 |       2 |       1
  1 | Pankaj | Patna    | f    |  6 |       1 | a food   | foods are heavy.               |           3 |  5 |       2 |       6
  1 | Pankaj | Patna    | f    |  6 |       1 | a food   | foods are heavy.               |           3 |  6 |       4 |       6
  1 | Pankaj | Patna    | f    |  6 |       1 | a food   | foods are heavy.               |           3 |  7 |       4 |       6
(6 rows)

blog_post_system=# select U.id, U.name from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false;
 id |  name  
----+--------
  5 | Rohit
  5 | Rohit
  5 | Rohit
  1 | Pankaj
  1 | Pankaj
  1 | Pankaj
(6 rows)

blog_post_system=# select U.id, U.name from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by U.id;
 id |  name  
----+--------
  1 | Pankaj
  5 | Rohit
(2 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# \d
             List of relations
 Schema |    Name     |   Type   |  Owner   
--------+-------------+----------+----------
 public | categories  | table    | postgres
 public | comments    | table    | postgres
 public | count_views | view     | postgres
 public | likes       | table    | postgres
 public | pk          | table    | postgres
 public | pk_id_seq   | sequence | postgres
 public | posts       | table    | postgres
 public | users       | table    | postgres
(8 rows)

blog_post_system=# \d pk
                         Table "public.pk"
 Column |  Type   |                    Modifiers                    
--------+---------+-------------------------------------------------
 id     | integer | not null default nextval('pk_id_seq'::regclass)
 roll   | integer | 
Indexes:
    "pk_pkey" PRIMARY KEY, btree (id)

blog_post_system=# select * from pk;
 id | roll 
----+------
(0 rows)

blog_post_system=# insert into pk (roll) values (10)
blog_post_system-# ;
INSERT 0 1
blog_post_system=# select * from pk;
 id | roll 
----+------
 13 |   10
(1 row)

blog_post_system=# 
blog_post_system=# insert into pk (roll) values (11);
INSERT 0 1
blog_post_system=# insert into pk (roll) values (12);
INSERT 0 1
blog_post_system=# select * from pk;
 id | roll 
----+------
 13 |   10
 14 |   11
 15 |   12
(3 rows)

blog_post_system=# alter table pk alter column roll set not null;
ALTER TABLE
blog_post_system=# \d pk
                         Table "public.pk"
 Column |  Type   |                    Modifiers                    
--------+---------+-------------------------------------------------
 id     | integer | not null default nextval('pk_id_seq'::regclass)
 roll   | integer | not null
Indexes:
    "pk_pkey" PRIMARY KEY, btree (id)

blog_post_system=# select * from pk;
 id | roll 
----+------
 13 |   10
 14 |   11
 15 |   12
(3 rows)

blog_post_system=# alter table pk alter column roll drop not null;
ALTER TABLE
blog_post_system=# \d pk
                         Table "public.pk"
 Column |  Type   |                    Modifiers                    
--------+---------+-------------------------------------------------
 id     | integer | not null default nextval('pk_id_seq'::regclass)
 roll   | integer | 
Indexes:
    "pk_pkey" PRIMARY KEY, btree (id)

blog_post_system=# insert into pk (roll) values ();
ERROR:  syntax error at or near ")"
LINE 1: insert into pk (roll) values ();
                                      ^
blog_post_system=# insert into pk (roll) values ('');
ERROR:  invalid input syntax for integer: ""
LINE 1: insert into pk (roll) values ('');
                                      ^
blog_post_system=# insert into pk (id, roll) values ();
ERROR:  syntax error at or near ")"
LINE 1: insert into pk (id, roll) values ();
                                          ^
blog_post_system=# insert into pk (id, roll) values (10);
ERROR:  INSERT has more target columns than expressions
LINE 1: insert into pk (id, roll) values (10);
                            ^
blog_post_system=# insert into pk (id) values ();
ERROR:  syntax error at or near ")"
LINE 1: insert into pk (id) values ();
                                    ^
blog_post_system=# insert into pk (id) values (100);
INSERT 0 1
blog_post_system=# insert into pk (id) values (100);
ERROR:  duplicate key value violates unique constraint "pk_pkey"
DETAIL:  Key (id)=(100) already exists.
blog_post_system=# insert into pk (id) values (101);
INSERT 0 1
blog_post_system=# select * from pk;
 id  | roll 
-----+------
  13 |   10
  14 |   11
  15 |   12
 100 |     
 101 |     
(5 rows)

blog_post_system=# 
blog_post_system=# alter table pk alter column roll set not null;
ERROR:  column "roll" contains null values
blog_post_system=# alter table pk alter column roll set not null;
ERROR:  column "roll" contains null values
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# '
blog_post_system'# '
blog_post_system-# '
blog_post_system'# ;
blog_post_system'# '
blog_post_system-# ;
ERROR:  syntax error at or near "'
'
'
;
'"
LINE 1: '
        ^
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# create table
blog_post_system-# { name serial
blog_post_system-# ;
ERROR:  syntax error at or near "{"
LINE 2: { name serial
        ^
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select count(P.id),count(L.id) from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by U.id;
 count | count 
-------+-------
     3 |     3
     3 |     3
(2 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# select U.id, count(P.id),count(L.id) from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by U.id;
 id | count | count 
----+-------+-------
  1 |     3 |     3
  5 |     3 |     3
(2 rows)

blog_post_system=# select U.id, U.name, count(P.id),count(L.id) from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by U.id;
 id |  name  | count | count 
----+--------+-------+-------
  1 | Pankaj |     3 |     3
  5 | Rohit  |     3 |     3
(2 rows)

blog_post_system=# select U.id, U.name, count(P.id) as Poat_count, count(L.id) as Like_count from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by U.id;
 id |  name  | poat_count | like_count 
----+--------+------------+------------
  1 | Pankaj |          3 |          3
  5 | Rohit  |          3 |          3
(2 rows)

blog_post_system=# select * from posts;
 id | user_id |   title   |            content             | category_id 
----+---------+-----------+--------------------------------+-------------
  5 |      10 | a goods   | Goods are heavy.               |           1
  1 |       5 | a mango   | Mangoes are sweets.            |           2
  2 |       5 | a banana  | Bananas are sweets and yellow. |           2
  3 |      10 | a banana  | Bananas are sweets and yellow. |           2
  4 |      10 | a book    | Books are good.                |           5
  6 |       1 | a food    | foods are heavy.               |           3
  7 |       3 | a food    | foods are light.               |           3
  8 |      14 | a food    | foods are light.               |           3
  9 |      14 | the goods | goods are light.               |           1
 10 |      14 | a food    | foods are good.                |           3
 11 |      14 | a cloth   | cloths are red.                |           8
 12 |      14 | a wood    | woods are heavy.               |           4
 13 |       7 | a food    | foods are light.               |           3
 14 |       7 | a cloth   | cloths are red.                |           8
 15 |       7 | a food    | foods are heavy.               |           3
 16 |       7 | a goods   | Goods are heavy.               |           1
 17 |       7 | a goods   | Goods are heavy.               |           1
(17 rows)

blog_post_system=# select * from likes;
 id | user_id | post_id 
----+---------+---------
  1 |       1 |       1
  2 |       1 |       2
  3 |       2 |       1
  4 |       2 |       5
  5 |       2 |       6
  6 |       4 |       6
  7 |       4 |       6
  8 |       4 |      12
  9 |      14 |      12
 10 |      14 |      11
 11 |      11 |      11
(11 rows)

blog_post_system=# select U.id, U.name, count(P.id) as Poat_count, count(L.id) as Like_count from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by U.id;
 id |  name  | poat_count | like_count 
----+--------+------------+------------
  1 | Pankaj |          3 |          3
  5 | Rohit  |          3 |          3
(2 rows)

blog_post_system=# select * from users;
 id |  name   | address  | paid 
----+---------+----------+------
  1 | Pankaj  | Patna    | f
  2 | Pankaj  | Patna    | t
  3 | Saurabh | Delhi    | t
  4 | Mohit   | Delhi    | f
  5 | Rohit   | Hariyana | f
  6 | Gundeep | Patiala  | t
  7 | Manjeet | Patiala  | t
  8 | Motilal | Chhapra  | f
  9 | Bittu   | Chhapra  | f
 10 | Bittu   | Patna    | t
 11 | Pavan   | Patna    | t
 12 | Pavan   | Chhapra  | t
 13 | Naveen  | Chhapra  | t
 14 | Naveen  | Patiala  | t
 15 | Praveen | Chhapra  | f
 16 | John    | Goa      | f
 17 | Doe     | Goa      | t
(17 rows)

blog_post_system=# select U.id, U.name, count(P.id) as Poat_count, count(L.id) as Like_count from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false;
ERROR:  column "u.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, U.name, count(P.id) as Poat_count, count(L.id) ...
               ^
blog_post_system=# select U.name, count(P.id) as Poat_count, count(L.id) as Like_count from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false;
ERROR:  column "u.name" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.name, count(P.id) as Poat_count, count(L.id) as Lik...
               ^
blog_post_system=# select count(P.id) as Poat_count, count(L.id) as Like_count from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false;
 poat_count | like_count 
------------+------------
          6 |          6
(1 row)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# select U.id, U.name,P.id, L.id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false;
 id |  name  | id | id 
----+--------+----+----
  5 | Rohit  |  1 |  1
  5 | Rohit  |  2 |  2
  5 | Rohit  |  1 |  3
  1 | Pankaj |  6 |  5
  1 | Pankaj |  6 |  6
  1 | Pankaj |  6 |  7
(6 rows)

blog_post_system=# select U.id, U.name,P.id as post_id, L.id as like_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false;
 id |  name  | post_id | like_id 
----+--------+---------+---------
  5 | Rohit  |       1 |       1
  5 | Rohit  |       2 |       2
  5 | Rohit  |       1 |       3
  1 | Pankaj |       6 |       5
  1 | Pankaj |       6 |       6
  1 | Pankaj |       6 |       7
(6 rows)

blog_post_system=# select U.id, U.name, count(U.id) as Poat_count, count(L.id) as Like_count from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false;
ERROR:  column "u.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, U.name, count(U.id) as Poat_count, count(L.id) ...
               ^
blog_post_system=# select U.id, U.name, count(U.id) as Poat_count, count(L.id) as Like_count from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by U.id;
 id |  name  | poat_count | like_count 
----+--------+------------+------------
  1 | Pankaj |          3 |          3
  5 | Rohit  |          3 |          3
(2 rows)

blog_post_system=# select U.id, U.name, count(U.id) as User_count, count(L.id) as Like_count from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by U.id;
 id |  name  | user_count | like_count 
----+--------+------------+------------
  1 | Pankaj |          3 |          3
  5 | Rohit  |          3 |          3
(2 rows)

blog_post_system=# 
blog_post_system=# select distinct U.id, U.name, count(U.id) as User_count, count(L.id) as Like_count from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by U.id;
 id |  name  | user_count | like_count 
----+--------+------------+------------
  1 | Pankaj |          3 |          3
  5 | Rohit  |          3 |          3
(2 rows)

blog_post_system=# select distinct U.id, U.name, count(L.id) as Like_count from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false;
ERROR:  column "u.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select distinct U.id, U.name, count(L.id) as Like_count from...
                        ^
blog_post_system=# select U.id, U.name,P.id as post_id, L.id as like_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false;
 id |  name  | post_id | like_id 
----+--------+---------+---------
  5 | Rohit  |       1 |       1
  5 | Rohit  |       2 |       2
  5 | Rohit  |       1 |       3
  1 | Pankaj |       6 |       5
  1 | Pankaj |       6 |       6
  1 | Pankaj |       6 |       7
(6 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# select U.id, U.name,P.id as post_id, L.id as like_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by P.id;
ERROR:  column "u.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, U.name,P.id as post_id, L.id as like_id from us...
               ^
blog_post_system=# select P.id as post_id, L.id as like_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by P.id;
ERROR:  column "l.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select P.id as post_id, L.id as like_id from users U left ou...
                                ^
blog_post_system=# select P.id as post_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by P.id;
 post_id 
---------
       2
       6
       1
(3 rows)

blog_post_system=# 
blog_post_system=# select P.id as post_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by distinct P.id;
ERROR:  syntax error at or near "distinct"
LINE 1: ...on P.id = L.post_id where U.paid = false group by distinct P...
                                                             ^
blog_post_system=# select P.id as post_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by P.id;
 post_id 
---------
       2
       6
       1
(3 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# select U.id, P.id as post_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by P.id;
ERROR:  column "u.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, P.id as post_id from users U left outer join po...
               ^
blog_post_system=# select P.id as post_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by distinct P.id;
ERROR:  syntax error at or near "distinct"
LINE 1: ...on P.id = L.post_id where U.paid = false group by distinct P...
                                                             ^
blog_post_system=# select P.id as post_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by P.id;
 post_id 
---------
       2
       6
       1
(3 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select L.id, P.id as post_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by P.id;
ERROR:  column "l.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select L.id, P.id as post_id from users U left outer join po...
               ^
blog_post_system=# select P.id as post_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by P.id;
 post_id 
---------
       2
       6
       1
(3 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# select U1.id, U1.name from users U1 join likes L1 on U1.id = L1.id where id in (select P.id as post_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by P.id);
ERROR:  column reference "id" is ambiguous
LINE 1: ...rom users U1 join likes L1 on U1.id = L1.id where id in (sel...
                                                             ^
blog_post_system=# select U1.id, U1.name from users U1 join likes L1 on U1.id = L1.user_id where id in (select P.id as post_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by P.id);
ERROR:  column reference "id" is ambiguous
LINE 1: ...sers U1 join likes L1 on U1.id = L1.user_id where id in (sel...
                                                             ^
blog_post_system=# select U1.id, U1.name from users U1 join likes L1 on U1.id = L1.user_id where U1.id in (select P.id as post_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by P.id);
 id |  name  
----+--------
  1 | Pankaj
  1 | Pankaj
  2 | Pankaj
  2 | Pankaj
  2 | Pankaj
(5 rows)

blog_post_system=# select U1.id, U1.name from users U1 join likes L1 on U1.id = L1.user_id where U1.id in (select U.id as post_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by P.id);
ERROR:  column "u.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: ...s L1 on U1.id = L1.user_id where U1.id in (select U.id as po...
                                                             ^
blog_post_system=# select U1.id, U1.name from users U1 join likes L1 on U1.id = L1.user_id where U1.id in (select P.id as post_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by P.id);
 id |  name  
----+--------
  1 | Pankaj
  1 | Pankaj
  2 | Pankaj
  2 | Pankaj
  2 | Pankaj
(5 rows)

blog_post_system=# select P.id as post_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by P.id;
 post_id 
---------
       2
       6
       1
(3 rows)

blog_post_system=# select U1.id, U1.name from users U1 join likes L1 on U1.id = L1.user_id where U1.id in (select P.id as post_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by P.id);
 id |  name  
----+--------
  1 | Pankaj
  1 | Pankaj
  2 | Pankaj
  2 | Pankaj
  2 | Pankaj
(5 rows)

blog_post_system=# select U1.id, U1.name from users U1 join likes L1 on U1.id = L1.user_id where P1.id in (select P.id as post_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by P.id);
ERROR:  missing FROM-clause entry for table "p1"
LINE 1: ...sers U1 join likes L1 on U1.id = L1.user_id where P1.id in (...
                                                             ^
blog_post_system=# select U1.id, U1.name from users U1 join likes L1 on U1.id = L1.user_id where P1.id in (select P.id as post_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by P.id);
ERROR:  missing FROM-clause entry for table "p1"
LINE 1: ...sers U1 join likes L1 on U1.id = L1.user_id where P1.id in (...
                                                             ^
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# create type as mood Enum ('sad', 'ok', 'happy');
ERROR:  syntax error at or near "as"
LINE 1: create type as mood Enum ('sad', 'ok', 'happy');
                    ^
blog_post_system=# create type mood as Enum ('sad', 'ok', 'happy');
CREATE TYPE
blog_post_system=# 
blog_post_system=# 
blog_post_system=# \d
             List of relations
 Schema |    Name     |   Type   |  Owner   
--------+-------------+----------+----------
 public | categories  | table    | postgres
 public | comments    | table    | postgres
 public | count_views | view     | postgres
 public | likes       | table    | postgres
 public | pk          | table    | postgres
 public | pk_id_seq   | sequence | postgres
 public | posts       | table    | postgres
 public | users       | table    | postgres
(8 rows)

blog_post_system=# create table person (name text, current_mood mood);
CREATE TABLE
blog_post_system=# \d
             List of relations
 Schema |    Name     |   Type   |  Owner   
--------+-------------+----------+----------
 public | categories  | table    | postgres
 public | comments    | table    | postgres
 public | count_views | view     | postgres
 public | likes       | table    | postgres
 public | person      | table    | postgres
 public | pk          | table    | postgres
 public | pk_id_seq   | sequence | postgres
 public | posts       | table    | postgres
 public | users       | table    | postgres
(9 rows)

blog_post_system=# \d person
      Table "public.person"
    Column    | Type | Modifiers 
--------------+------+-----------
 name         | text | 
 current_mood | mood | 

blog_post_system=# insert into person values ('Pankaj', 'happy')
blog_post_system-# ;
INSERT 0 1
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select * from person;
  name  | current_mood 
--------+--------------
 Pankaj | happy
(1 row)

blog_post_system=# insert into person values ('Pankaj', 'kumar')
blog_post_system-# ;
ERROR:  invalid input value for enum mood: "kumar"
LINE 1: insert into person values ('Pankaj', 'kumar')
                                             ^
blog_post_system=# insert into person values ('Pankaj', 'ok')
;
INSERT 0 1
blog_post_system=# select * from person;
  name  | current_mood 
--------+--------------
 Pankaj | happy
 Pankaj | ok
(2 rows)

blog_post_system=# select * from person where current_mood = 'happy';
  name  | current_mood 
--------+--------------
 Pankaj | happy
(1 row)

blog_post_system=# select * from person where current_mood < 'happy';
  name  | current_mood 
--------+--------------
 Pankaj | ok
(1 row)

blog_post_system=# select * from person where current_mood > 'happy';
 name | current_mood 
------+--------------
(0 rows)

blog_post_system=# select * from mood;
ERROR:  relation "mood" does not exist
LINE 1: select * from mood;
                      ^
blog_post_system=# select * from public.mood;
ERROR:  relation "public.mood" does not exist
LINE 1: select * from public.mood;
                      ^
blog_post_system=# select * from ENUM;
ERROR:  relation "enum" does not exist
LINE 1: select * from ENUM;
                      ^
blog_post_system=# select enum from pg_enum;
ERROR:  column "enum" does not exist
LINE 1: select enum from pg_enum;
               ^
blog_post_system=# select mood from pg_enum;
ERROR:  column "mood" does not exist
LINE 1: select mood from pg_enum;
               ^
blog_post_system=# insert into pk (id,roll) (default);
ERROR:  syntax error at or near "default"
LINE 1: insert into pk (id,roll) (default);
                                  ^
blog_post_system=# \d pk;
                         Table "public.pk"
 Column |  Type   |                    Modifiers                    
--------+---------+-------------------------------------------------
 id     | integer | not null default nextval('pk_id_seq'::regclass)
 roll   | integer | 
Indexes:
    "pk_pkey" PRIMARY KEY, btree (id)

blog_post_system=# alter table pk alter column roll set default 'NO';
ERROR:  invalid input syntax for integer: "NO"
blog_post_system=# alter table pk alter column roll set default '5';
ALTER TABLE
blog_post_system=# \d pk;
                         Table "public.pk"
 Column |  Type   |                    Modifiers                    
--------+---------+-------------------------------------------------
 id     | integer | not null default nextval('pk_id_seq'::regclass)
 roll   | integer | default 5
Indexes:
    "pk_pkey" PRIMARY KEY, btree (id)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# insert into pk values (default);
INSERT 0 1
blog_post_system=# insert into pk values (default);
INSERT 0 1
blog_post_system=# select * from pk;
 id  | roll 
-----+------
  13 |   10
  14 |   11
  15 |   12
 100 |     
 101 |     
  16 |    5
  17 |    5
(7 rows)

blog_post_system=# insert into pk values (default);
INSERT 0 1
blog_post_system=# select * from pk;
 id  | roll 
-----+------
  13 |   10
  14 |   11
  15 |   12
 100 |     
 101 |     
  16 |    5
  17 |    5
  18 |    5
(8 rows)

blog_post_system=# alter table pk alter column roll drop default '5';
ERROR:  syntax error at or near "'5'"
LINE 1: alter table pk alter column roll drop default '5';
                                                      ^
blog_post_system=# alter table pk alter column roll drop default ;
ALTER TABLE
blog_post_system=# \d pk;
                         Table "public.pk"
 Column |  Type   |                    Modifiers                    
--------+---------+-------------------------------------------------
 id     | integer | not null default nextval('pk_id_seq'::regclass)
 roll   | integer | 
Indexes:
    "pk_pkey" PRIMARY KEY, btree (id)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# insert into pk values (default);
INSERT 0 1
blog_post_system=# select * from pk;
 id  | roll 
-----+------
  13 |   10
  14 |   11
  15 |   12
 100 |     
 101 |     
  16 |    5
  17 |    5
  18 |    5
  19 |     
(9 rows)

blog_post_system=# insert into pk values (default,6);
INSERT 0 1
blog_post_system=# select * from pk;
 id  | roll 
-----+------
  13 |   10
  14 |   11
  15 |   12
 100 |     
 101 |     
  16 |    5
  17 |    5
  18 |    5
  19 |     
  20 |    6
(10 rows)

blog_post_system=# insert into pk values (6);
INSERT 0 1
blog_post_system=# select * from pk;
 id  | roll 
-----+------
  13 |   10
  14 |   11
  15 |   12
 100 |     
 101 |     
  16 |    5
  17 |    5
  18 |    5
  19 |     
  20 |    6
   6 |     
(11 rows)

blog_post_system=# \d
             List of relations
 Schema |    Name     |   Type   |  Owner   
--------+-------------+----------+----------
 public | categories  | table    | postgres
 public | comments    | table    | postgres
 public | count_views | view     | postgres
 public | likes       | table    | postgres
 public | person      | table    | postgres
 public | pk          | table    | postgres
 public | pk_id_seq   | sequence | postgres
 public | posts       | table    | postgres
 public | users       | table    | postgres
(9 rows)

blog_post_system=# \d pk_id_seq;
          Sequence "public.pk_id_seq"
    Column     |  Type   |        Value        
---------------+---------+---------------------
 sequence_name | name    | pk_id_seq
 last_value    | bigint  | 20
 start_value   | bigint  | 1
 increment_by  | bigint  | 1
 max_value     | bigint  | 9223372036854775807
 min_value     | bigint  | 1
 cache_value   | bigint  | 1
 log_cnt       | bigint  | 28
 is_cycled     | boolean | f
 is_called     | boolean | t
Owned by: public.pk.id

blog_post_system=# select * from pk_id_seq;
 sequence_name | last_value | start_value | increment_by |      max_value      | min_value | cache_value | log_cnt | is_cycled | is_called 
---------------+------------+-------------+--------------+---------------------+-----------+-------------+---------+-----------+-----------
 pk_id_seq     |         20 |           1 |            1 | 9223372036854775807 |         1 |           1 |      28 | f         | t
(1 row)

blog_post_system=# select U1.id, U1.name from users U1 join likes L1 on U1.id = L1.user_id where P1.id in (select P.id as post_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by P.id);
ERROR:  missing FROM-clause entry for table "p1"
LINE 1: ...sers U1 join likes L1 on U1.id = L1.user_id where P1.id in (...
                                                             ^
blog_post_system=# select U1.id, U1.name from users U1 join likes L1 on U1.id = L1.user_id where P1.id in (select P.id as post_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by P.id);
ERROR:  missing FROM-clause entry for table "p1"
LINE 1: ...sers U1 join likes L1 on U1.id = L1.user_id where P1.id in (...
                                                             ^
blog_post_system=# select U1.id, U1.name from users U1 join likes L1 on U1.id = L1.user_id where U1.id in (select P.id as post_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by P.id);
 id |  name  
----+--------
  1 | Pankaj
  1 | Pankaj
  2 | Pankaj
  2 | Pankaj
  2 | Pankaj
(5 rows)

blog_post_system=# select P.id as post_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by P.id;
 post_id 
---------
       2
       6
       1
(3 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# select U.id, P.id as post_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by P.id;
ERROR:  column "u.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, P.id as post_id from users U left outer join po...
               ^
blog_post_system=# select U.id, P.id as post_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by P.id;select U.id, U.name,P.id as post_id, L.id as like_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false;
ERROR:  column "u.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, P.id as post_id from users U left outer join po...
               ^
 id |  name  | post_id | like_id 
----+--------+---------+---------
  5 | Rohit  |       1 |       1
  5 | Rohit  |       2 |       2
  5 | Rohit  |       1 |       3
  1 | Pankaj |       6 |       5
  1 | Pankaj |       6 |       6
  1 | Pankaj |       6 |       7
(6 rows)

blog_post_system=# select U.id, U.name,P.id as post_id, L.id as like_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false;
 id |  name  | post_id | like_id 
----+--------+---------+---------
  5 | Rohit  |       1 |       1
  5 | Rohit  |       2 |       2
  5 | Rohit  |       1 |       3
  1 | Pankaj |       6 |       5
  1 | Pankaj |       6 |       6
  1 | Pankaj |       6 |       7
(6 rows)

blog_post_system=# select U.id, U.name,P.id as post_id, L.id as like_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by (U.id);
ERROR:  column "p.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, U.name,P.id as post_id, L.id as like_id from us...
                            ^
blog_post_system=# select U.id, count(P.id) as post_count from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by (U.id, P.id);
 id | post_count 
----+------------
  1 |          3
  5 |          2
  5 |          1
(3 rows)

blog_post_system=# select ditinct U.id, count(P.id) as post_count from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by (U.id, P.id);
ERROR:  syntax error at or near "."
LINE 1: select ditinct U.id, count(P.id) as post_count from users U ...
                        ^
blog_post_system=# select distinct U.id, count(P.id) as post_count from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by (U.id, P.id);
 id | post_count 
----+------------
  1 |          3
  5 |          1
  5 |          2
(3 rows)

blog_post_system=# select distinct U.id, count(P.id) as post_count from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by (U.id);
 id | post_count 
----+------------
  1 |          3
  5 |          3
(2 rows)

blog_post_system=# select distinct U.id, count(P.id) as post_count from users U left outer join posts P on U.id = P.user_id Left outer join likes L on P.id = L.post_id where U.paid = false group by (U.id);
 id | post_count 
----+------------
  8 |          0
 16 |          0
 15 |          0
  4 |          0
  9 |          0
  1 |          3
  5 |          3
(7 rows)

blog_post_system=# select distinct U.id, count(P.id) as post_count from users U left outer join posts P on U.id = P.user_id Left outer group by (U.id);
ERROR:  syntax error at or near "group"
LINE 1: ...outer join posts P on U.id = P.user_id Left outer group by (...
                                                             ^
blog_post_system=# select distinct U.id, count(P.id) as post_count from users U left outer join posts P on U.id = P.user_id group by (U.id);
 id | post_count 
----+------------
  3 |          1
  8 |          0
 12 |          0
  2 |          0
  6 |          0
 11 |          0
  1 |          1
 17 |          0
  5 |          2
 13 |          0
 10 |          3
 14 |          5
  7 |          5
 16 |          0
 15 |          0
  4 |          0
  9 |          0
(17 rows)

blog_post_system=# select distinct U.id, count(P.id) as post_count from users U join posts P on U.id = P.user_id group by (U.id);
 id | post_count 
----+------------
  3 |          1
  1 |          1
  5 |          2
 10 |          3
 14 |          5
  7 |          5
(6 rows)

blog_post_system=# select distinct U.id, count(P.id) as post_count from users U join posts P on U.id = P.user_id where U.paid= false group by (U.id);
 id | post_count 
----+------------
  5 |          2
  1 |          1
(2 rows)

blog_post_system=# select distinct U.id, P.id, count(P.id) as post_count from users U join posts P on U.id = P.user_id where U.paid= false group by (U.id)  ;
ERROR:  column "p.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select distinct U.id, P.id, count(P.id) as post_count from u...
                              ^
blog_post_system=# select distinct (U.id, P.id), count(P.id) as post_count from users U join posts P on U.id = P.user_id where U.paid= false group by (U.id)  ;
ERROR:  column "p.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select distinct (U.id, P.id), count(P.id) as post_count from...
                               ^
blog_post_system=# select distinct U.id, count(P.id) as post_count from users U join posts P on U.id = P.user_id where U.paid= false group by (U.id)  ;
 id | post_count 
----+------------
  5 |          2
  1 |          1
(2 rows)

blog_post_system=# select distinct U.id, U.name, count(P.id) as post_count from users U join posts P on U.id = P.user_id where U.paid= false group by (U.id)  ;
 id |  name  | post_count 
----+--------+------------
  1 | Pankaj |          1
  5 | Rohit  |          2
(2 rows)

blog_post_system=# select U.id, U.name, count(P.id) as post_count from users U join posts P on U.id = P.user_id where U.paid= false group by (U.id)  ;
 id |  name  | post_count 
----+--------+------------
  1 | Pankaj |          1
  5 | Rohit  |          2
(2 rows)

blog_post_system=# select U.id, U.name,P.id, count(P.id) as post_count from users U join posts P on U.id = P.user_id where U.paid= false group by (U.id)  ;
ERROR:  column "p.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id, U.name,P.id, count(P.id) as post_count from use...
                            ^
blog_post_system=# select U.id, U.name,P.id, count(P.id) as post_count from users U join posts P on U.id = P.user_id where U.paid= false group by (U.id, P.id)  ;
 id |  name  | id | post_count 
----+--------+----+------------
  5 | Rohit  |  2 |          1
  1 | Pankaj |  6 |          1
  5 | Rohit  |  1 |          1
(3 rows)

blog_post_system=# select U.id, U.name,P.id, count(P.id) as post_count from users U join posts P on U.id = P.user_id where U.paid= false group by (U.id, P.id)  ;
 id |  name  | id | post_count 
----+--------+----+------------
  5 | Rohit  |  2 |          1
  1 | Pankaj |  6 |          1
  5 | Rohit  |  1 |          1
(3 rows)

blog_post_system=# select *from posts;
 id | user_id |   title   |            content             | category_id 
----+---------+-----------+--------------------------------+-------------
  5 |      10 | a goods   | Goods are heavy.               |           1
  1 |       5 | a mango   | Mangoes are sweets.            |           2
  2 |       5 | a banana  | Bananas are sweets and yellow. |           2
  3 |      10 | a banana  | Bananas are sweets and yellow. |           2
  4 |      10 | a book    | Books are good.                |           5
  6 |       1 | a food    | foods are heavy.               |           3
  7 |       3 | a food    | foods are light.               |           3
  8 |      14 | a food    | foods are light.               |           3
  9 |      14 | the goods | goods are light.               |           1
 10 |      14 | a food    | foods are good.                |           3
 11 |      14 | a cloth   | cloths are red.                |           8
 12 |      14 | a wood    | woods are heavy.               |           4
 13 |       7 | a food    | foods are light.               |           3
 14 |       7 | a cloth   | cloths are red.                |           8
 15 |       7 | a food    | foods are heavy.               |           3
 16 |       7 | a goods   | Goods are heavy.               |           1
 17 |       7 | a goods   | Goods are heavy.               |           1
(17 rows)

blog_post_system=#  select P.id as post_id from users U left outer join posts P on U.id = P.user_id inner join likes L on P.id = L.post_id where U.paid = false group by P.id;
 post_id 
---------
       2
       6
       1
(3 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# select * from likes;
 id | user_id | post_id 
----+---------+---------
  1 |       1 |       1
  2 |       1 |       2
  3 |       2 |       1
  4 |       2 |       5
  5 |       2 |       6
  6 |       4 |       6
  7 |       4 |       6
  8 |       4 |      12
  9 |      14 |      12
 10 |      14 |      11
 11 |      11 |      11
(11 rows)

blog_post_system=# select * from users U join posts P; 
ERROR:  syntax error at or near ";"
LINE 1: select * from users U join posts P;
                                          ^
blog_post_system=# select * from users U full outer join posts P join likes L on U.id = P.user_id and U.id = L.user_id; 
ERROR:  syntax error at or near ";"
LINE 1: ...sts P join likes L on U.id = P.user_id and U.id = L.user_id;
                                                                      ^
blog_post_system=# select * from users U full outer join posts P on U.id = P.user_id; 
 id |  name   | address  | paid | id | user_id |   title   |            content             | category_id 
----+---------+----------+------+----+---------+-----------+--------------------------------+-------------
 10 | Bittu   | Patna    | t    |  5 |      10 | a goods   | Goods are heavy.               |           1
  5 | Rohit   | Hariyana | f    |  1 |       5 | a mango   | Mangoes are sweets.            |           2
  5 | Rohit   | Hariyana | f    |  2 |       5 | a banana  | Bananas are sweets and yellow. |           2
 10 | Bittu   | Patna    | t    |  3 |      10 | a banana  | Bananas are sweets and yellow. |           2
 10 | Bittu   | Patna    | t    |  4 |      10 | a book    | Books are good.                |           5
  1 | Pankaj  | Patna    | f    |  6 |       1 | a food    | foods are heavy.               |           3
  3 | Saurabh | Delhi    | t    |  7 |       3 | a food    | foods are light.               |           3
 14 | Naveen  | Patiala  | t    |  8 |      14 | a food    | foods are light.               |           3
 14 | Naveen  | Patiala  | t    |  9 |      14 | the goods | goods are light.               |           1
 14 | Naveen  | Patiala  | t    | 10 |      14 | a food    | foods are good.                |           3
 14 | Naveen  | Patiala  | t    | 11 |      14 | a cloth   | cloths are red.                |           8
 14 | Naveen  | Patiala  | t    | 12 |      14 | a wood    | woods are heavy.               |           4
  7 | Manjeet | Patiala  | t    | 13 |       7 | a food    | foods are light.               |           3
  7 | Manjeet | Patiala  | t    | 14 |       7 | a cloth   | cloths are red.                |           8
  7 | Manjeet | Patiala  | t    | 15 |       7 | a food    | foods are heavy.               |           3
  7 | Manjeet | Patiala  | t    | 16 |       7 | a goods   | Goods are heavy.               |           1
  7 | Manjeet | Patiala  | t    | 17 |       7 | a goods   | Goods are heavy.               |           1
 11 | Pavan   | Patna    | t    |    |         |           |                                |            
 17 | Doe     | Goa      | t    |    |         |           |                                |            
 12 | Pavan   | Chhapra  | t    |    |         |           |                                |            
  2 | Pankaj  | Patna    | t    |    |         |           |                                |            
 15 | Praveen | Chhapra  | f    |    |         |           |                                |            
 13 | Naveen  | Chhapra  | t    |    |         |           |                                |            
  8 | Motilal | Chhapra  | f    |    |         |           |                                |            
  6 | Gundeep | Patiala  | t    |    |         |           |                                |            
 16 | John    | Goa      | f    |    |         |           |                                |            
  4 | Mohit   | Delhi    | f    |    |         |           |                                |            
  9 | Bittu   | Chhapra  | f    |    |         |           |                                |            
(28 rows)

blog_post_system=# select * from users U full outer join posts P on U.id = P.user_id join Likes L on U.id = L.user_id; 
 id |  name  | address | paid | id | user_id |   title   |     content      | category_id | id | user_id | post_id 
----+--------+---------+------+----+---------+-----------+------------------+-------------+----+---------+---------
  1 | Pankaj | Patna   | f    |  6 |       1 | a food    | foods are heavy. |           3 |  1 |       1 |       1
  1 | Pankaj | Patna   | f    |  6 |       1 | a food    | foods are heavy. |           3 |  2 |       1 |       2
  2 | Pankaj | Patna   | t    |    |         |           |                  |             |  3 |       2 |       1
  2 | Pankaj | Patna   | t    |    |         |           |                  |             |  4 |       2 |       5
  2 | Pankaj | Patna   | t    |    |         |           |                  |             |  5 |       2 |       6
  4 | Mohit  | Delhi   | f    |    |         |           |                  |             |  6 |       4 |       6
  4 | Mohit  | Delhi   | f    |    |         |           |                  |             |  7 |       4 |       6
  4 | Mohit  | Delhi   | f    |    |         |           |                  |             |  8 |       4 |      12
 14 | Naveen | Patiala | t    | 12 |      14 | a wood    | woods are heavy. |           4 |  9 |      14 |      12
 14 | Naveen | Patiala | t    | 11 |      14 | a cloth   | cloths are red.  |           8 |  9 |      14 |      12
 14 | Naveen | Patiala | t    | 10 |      14 | a food    | foods are good.  |           3 |  9 |      14 |      12
 14 | Naveen | Patiala | t    |  9 |      14 | the goods | goods are light. |           1 |  9 |      14 |      12
 14 | Naveen | Patiala | t    |  8 |      14 | a food    | foods are light. |           3 |  9 |      14 |      12
 14 | Naveen | Patiala | t    | 12 |      14 | a wood    | woods are heavy. |           4 | 10 |      14 |      11
 14 | Naveen | Patiala | t    | 11 |      14 | a cloth   | cloths are red.  |           8 | 10 |      14 |      11
 14 | Naveen | Patiala | t    | 10 |      14 | a food    | foods are good.  |           3 | 10 |      14 |      11
 14 | Naveen | Patiala | t    |  9 |      14 | the goods | goods are light. |           1 | 10 |      14 |      11
 14 | Naveen | Patiala | t    |  8 |      14 | a food    | foods are light. |           3 | 10 |      14 |      11
 11 | Pavan  | Patna   | t    |    |         |           |                  |             | 11 |      11 |      11
(19 rows)

blog_post_system=# select * from users U full outer join posts P on U.id = P.user_id join Likes L on U.id = L.user_id and U.id = P.user_id; 
 id |  name  | address | paid | id | user_id |   title   |     content      | category_id | id | user_id | post_id 
----+--------+---------+------+----+---------+-----------+------------------+-------------+----+---------+---------
  1 | Pankaj | Patna   | f    |  6 |       1 | a food    | foods are heavy. |           3 |  1 |       1 |       1
  1 | Pankaj | Patna   | f    |  6 |       1 | a food    | foods are heavy. |           3 |  2 |       1 |       2
 14 | Naveen | Patiala | t    | 12 |      14 | a wood    | woods are heavy. |           4 |  9 |      14 |      12
 14 | Naveen | Patiala | t    | 11 |      14 | a cloth   | cloths are red.  |           8 |  9 |      14 |      12
 14 | Naveen | Patiala | t    | 10 |      14 | a food    | foods are good.  |           3 |  9 |      14 |      12
 14 | Naveen | Patiala | t    |  9 |      14 | the goods | goods are light. |           1 |  9 |      14 |      12
 14 | Naveen | Patiala | t    |  8 |      14 | a food    | foods are light. |           3 |  9 |      14 |      12
 14 | Naveen | Patiala | t    | 12 |      14 | a wood    | woods are heavy. |           4 | 10 |      14 |      11
 14 | Naveen | Patiala | t    | 11 |      14 | a cloth   | cloths are red.  |           8 | 10 |      14 |      11
 14 | Naveen | Patiala | t    | 10 |      14 | a food    | foods are good.  |           3 | 10 |      14 |      11
 14 | Naveen | Patiala | t    |  9 |      14 | the goods | goods are light. |           1 | 10 |      14 |      11
 14 | Naveen | Patiala | t    |  8 |      14 | a food    | foods are light. |           3 | 10 |      14 |      11
(12 rows)

blog_post_system=# select * from users U full outer join posts P on U.id = P.user_id join Likes L on U.id = L.user_id and L.id = P.user_id; 
 id |  name  | address | paid | id | user_id | title  |     content      | category_id | id | user_id | post_id 
----+--------+---------+------+----+---------+--------+------------------+-------------+----+---------+---------
  1 | Pankaj | Patna   | f    |  6 |       1 | a food | foods are heavy. |           3 |  1 |       1 |       1
(1 row)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select * from users U full outer join posts P on U.id = P.user_id join Likes L on U.id = L.user_id; 
 id |  name  | address | paid | id | user_id |   title   |     content      | category_id | id | user_id | post_id 
----+--------+---------+------+----+---------+-----------+------------------+-------------+----+---------+---------
  1 | Pankaj | Patna   | f    |  6 |       1 | a food    | foods are heavy. |           3 |  1 |       1 |       1
  1 | Pankaj | Patna   | f    |  6 |       1 | a food    | foods are heavy. |           3 |  2 |       1 |       2
  2 | Pankaj | Patna   | t    |    |         |           |                  |             |  3 |       2 |       1
  2 | Pankaj | Patna   | t    |    |         |           |                  |             |  4 |       2 |       5
  2 | Pankaj | Patna   | t    |    |         |           |                  |             |  5 |       2 |       6
  4 | Mohit  | Delhi   | f    |    |         |           |                  |             |  6 |       4 |       6
  4 | Mohit  | Delhi   | f    |    |         |           |                  |             |  7 |       4 |       6
  4 | Mohit  | Delhi   | f    |    |         |           |                  |             |  8 |       4 |      12
 14 | Naveen | Patiala | t    | 12 |      14 | a wood    | woods are heavy. |           4 |  9 |      14 |      12
 14 | Naveen | Patiala | t    | 11 |      14 | a cloth   | cloths are red.  |           8 |  9 |      14 |      12
 14 | Naveen | Patiala | t    | 10 |      14 | a food    | foods are good.  |           3 |  9 |      14 |      12
 14 | Naveen | Patiala | t    |  9 |      14 | the goods | goods are light. |           1 |  9 |      14 |      12
 14 | Naveen | Patiala | t    |  8 |      14 | a food    | foods are light. |           3 |  9 |      14 |      12
 14 | Naveen | Patiala | t    | 12 |      14 | a wood    | woods are heavy. |           4 | 10 |      14 |      11
 14 | Naveen | Patiala | t    | 11 |      14 | a cloth   | cloths are red.  |           8 | 10 |      14 |      11
 14 | Naveen | Patiala | t    | 10 |      14 | a food    | foods are good.  |           3 | 10 |      14 |      11
 14 | Naveen | Patiala | t    |  9 |      14 | the goods | goods are light. |           1 | 10 |      14 |      11
 14 | Naveen | Patiala | t    |  8 |      14 | a food    | foods are light. |           3 | 10 |      14 |      11
 11 | Pavan  | Patna   | t    |    |         |           |                  |             | 11 |      11 |      11
(19 rows)

blog_post_system=# select * from users U full outer join posts P on U.id = P.user_id join Likes L on U.id = L.user_id;
 id |  name  | address | paid | id | user_id |   title   |     content      | category_id | id | user_id | post_id 
----+--------+---------+------+----+---------+-----------+------------------+-------------+----+---------+---------
  1 | Pankaj | Patna   | f    |  6 |       1 | a food    | foods are heavy. |           3 |  1 |       1 |       1
  1 | Pankaj | Patna   | f    |  6 |       1 | a food    | foods are heavy. |           3 |  2 |       1 |       2
  2 | Pankaj | Patna   | t    |    |         |           |                  |             |  3 |       2 |       1
  2 | Pankaj | Patna   | t    |    |         |           |                  |             |  4 |       2 |       5
  2 | Pankaj | Patna   | t    |    |         |           |                  |             |  5 |       2 |       6
  4 | Mohit  | Delhi   | f    |    |         |           |                  |             |  6 |       4 |       6
  4 | Mohit  | Delhi   | f    |    |         |           |                  |             |  7 |       4 |       6
  4 | Mohit  | Delhi   | f    |    |         |           |                  |             |  8 |       4 |      12
 14 | Naveen | Patiala | t    | 12 |      14 | a wood    | woods are heavy. |           4 |  9 |      14 |      12
 14 | Naveen | Patiala | t    | 11 |      14 | a cloth   | cloths are red.  |           8 |  9 |      14 |      12
 14 | Naveen | Patiala | t    | 10 |      14 | a food    | foods are good.  |           3 |  9 |      14 |      12
 14 | Naveen | Patiala | t    |  9 |      14 | the goods | goods are light. |           1 |  9 |      14 |      12
 14 | Naveen | Patiala | t    |  8 |      14 | a food    | foods are light. |           3 |  9 |      14 |      12
 14 | Naveen | Patiala | t    | 12 |      14 | a wood    | woods are heavy. |           4 | 10 |      14 |      11
 14 | Naveen | Patiala | t    | 11 |      14 | a cloth   | cloths are red.  |           8 | 10 |      14 |      11
 14 | Naveen | Patiala | t    | 10 |      14 | a food    | foods are good.  |           3 | 10 |      14 |      11
 14 | Naveen | Patiala | t    |  9 |      14 | the goods | goods are light. |           1 | 10 |      14 |      11
 14 | Naveen | Patiala | t    |  8 |      14 | a food    | foods are light. |           3 | 10 |      14 |      11
 11 | Pavan  | Patna   | t    |    |         |           |                  |             | 11 |      11 |      11
(19 rows)

blog_post_system=# select count(L.id) from users U full outer join posts P on U.id = P.user_id join Likes L on U.id = L.user_id;
 count 
-------
    19
(1 row)

blog_post_system=# select count(L.id) from users U full outer join posts P on U.id = P.user_id join Likes L on U.id = L.user_id group by P.id;
 count 
-------
     7
     2
     2
     2
     2
     2
     2
(7 rows)

blog_post_system=# select P.id, count(L.id) from users U full outer join posts P on U.id = P.user_id join Likes L on U.id = L.user_id group by P.id;
 id | count 
----+-------
    |     7
 11 |     2
 12 |     2
 10 |     2
  8 |     2
  6 |     2
  9 |     2
(7 rows)

blog_post_system=# select P.id, count(L.id) from users U full outer join posts P on U.id = P.user_id join Likes L on U.id = L.user_id group by P.id = 6;
ERROR:  column "p.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select P.id, count(L.id) from users U full outer join posts ...
               ^
blog_post_system=# select P.id, count(L.id) from users U full outer join posts P on U.id = P.user_id join Likes L on U.id = L.user_id group by P.id;
 id | count 
----+-------
    |     7
 11 |     2
 12 |     2
 10 |     2
  8 |     2
  6 |     2
  9 |     2
(7 rows)

blog_post_system=# select count(id) from (select P.id, count(L.id) from users U full outer join posts P on U.id = P.user_id join Likes L on U.id = L.user_id group by P.id);
ERROR:  subquery in FROM must have an alias
LINE 1: select count(id) from (select P.id, count(L.id) from users U...
                              ^
HINT:  For example, FROM (SELECT ...) [AS] foo.
blog_post_system=# select count(id) from (select P.id, count(L.id) from users U full outer join posts P on U.id = P.user_id join Likes L on U.id = L.user_id group by P.id) as S;
 count 
-------
     6
(1 row)

blog_post_system=# select count(S.id) from (select P.id, count(L.id) from users U full outer join posts P on U.id = P.user_id join Likes L on U.id = L.user_id group by P.id) as S;
 count 
-------
     6
(1 row)

blog_post_system=# select P.id, count(L.id) from users U full outer join posts P on U.id = P.user_id join Likes L on U.id = L.user_id group by P.id;
 id | count 
----+-------
    |     7
 11 |     2
 12 |     2
 10 |     2
  8 |     2
  6 |     2
  9 |     2
(7 rows)

blog_post_system=# select P.id, count(L.id) from users U join posts P on U.id = P.user_id join Likes L on U.id = L.user_id group by P.id;
 id | count 
----+-------
 11 |     2
 12 |     2
 10 |     2
  8 |     2
  6 |     2
  9 |     2
(6 rows)

blog_post_system=# select count(S.id) from (select P.id, count(L.id) from users U full outer join posts P on U.id = P.user_id join Likes L on U.id = L.user_id group by P.id) as S;
 count 
-------
     6
(1 row)

blog_post_system=# select count(S.id) from (select P.id, count(L.id) from users U join posts P on U.id = P.user_id join Likes L on U.id = L.user_id group by P.id) as S;
 count 
-------
     6
(1 row)

blog_post_system=# select n.nspname as enum_schema,  
blog_post_system-#        t.typname as enum_name,  
blog_post_system-#        e.enumlabel as enum_value
blog_post_system-# from pg_type t 
blog_post_system-#    join pg_enum e on t.oid = e.enumtypid  
blog_post_system-# join pg_catalog.pg_namespace n ON n.oid = t.typnamespace;
 enum_schema | enum_name | enum_value 
-------------+-----------+------------
 public      | mood      | sad
 public      | mood      | ok
 public      | mood      | happy
(3 rows)

blog_post_system=# select n.nspname as enum_schema,  
       t.typname as enum_name,  
       e.enumlabel as enum_value
from pg_type t 
   join pg_enum e on t.oid = e.enumtypid  
join pg_catalog.pg_namespace n ON n.oid = t.typnamespace;
 enum_schema | enum_name | enum_value 
-------------+-----------+------------
 public      | mood      | sad
 public      | mood      | ok
 public      | mood      | happy
(3 rows)

blog_post_system=# select n.nspname as enum_schema,  
       t.typname as enum_name,  
       e.enumlabel as enum_value
from pg_type t 
   join pg_enum e on t.oid = e.enumtypid  
join pg_catalog.pg_namespace n ON n.oid = t.typnamespace;
 enum_schema | enum_name | enum_value 
-------------+-----------+------------
 public      | mood      | sad
 public      | mood      | ok
 public      | mood      | happy
(3 rows)

blog_post_system=# select n.nspname as enum_schema,  
       t.typname as enum_name,  
       e.enumlabel as enum_value
from pg_type t 
   join pg_enum e on t.oid = e.enumtypid  
join pg_catalog.pg_namespace n ON n.oid = t.typnamespace;
 enum_schema | enum_name | enum_value 
-------------+-----------+------------
 public      | mood      | sad
 public      | mood      | ok
 public      | mood      | happy
(3 rows)

blog_post_system=# select n.nspname as enum_schema,  
blog_post_system-#        t.typname as enum_name,  
blog_post_system-#        e.enumlabel as enum_value
blog_post_system-# from pg_type t 
blog_post_system-#    join pg_enum e on t.oid = e.enumtypid  
blog_post_system-#    join pg_catalog.pg_namespace n ON n.oid = t.typnamespace
blog_post_system-# ;
 enum_schema | enum_name | enum_value 
-------------+-----------+------------
 public      | mood      | sad
 public      | mood      | ok
 public      | mood      | happy
(3 rows)

blog_post_system=# select n.nspname as enum_schema,  
       t.typname as enum_name,  
       e.enumlabel as enum_value
from pg_type t 
   join pg_enum e on t.oid = e.enumtypid  
   join pg_catalog.pg_namespace n ON n.oid = t.typnamespace
;
 enum_schema | enum_name | enum_value 
-------------+-----------+------------
 public      | mood      | sad
 public      | mood      | ok
 public      | mood      | happy
(3 rows)

blog_post_system=# 
blog_post_system=# CREATE TYPE mood AS ENUM ('sad', 'ok', 'happy');
ERROR:  type "mood" already exists
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select n.nspname as enum_schema,  
blog_post_system-#        t.typname as enum_name,  
blog_post_system-#        e.enumlabel as enum_value
blog_post_system-# from pg_type t 
blog_post_system-#    join pg_enum e on t.oid = e.enumtypid  
blog_post_system-#    join pg_catalog.pg_namespace n ON n.oid = t.typnamespace
blog_post_system-# ;
 enum_schema | enum_name | enum_value 
-------------+-----------+------------
 public      | mood      | sad
 public      | mood      | ok
 public      | mood      | happy
(3 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select n.nspname as enum_schema,  
       t.typname as enum_name,  
       e.enumlabel as enum_value
from pg_type T 
   join pg_enum e on t.oid = e.enumtypid  
   join pg_catalog.pg_namespace n ON n.oid = t.typnamespace
;
 enum_schema | enum_name | enum_value 
-------------+-----------+------------
 public      | mood      | sad
 public      | mood      | ok
 public      | mood      | happy
(3 rows)

blog_post_system=# select n.nspname as enum_schema,  
       t.typname as enum_name,  
       e.enumlabel as enum_value
from pg_type Tabk 
   join pg_enum e on t.oid = e.enumtypid  
   join pg_catalog.pg_namespace n ON n.oid = t.typnamespace
;
ERROR:  missing FROM-clause entry for table "t"
LINE 5:    join pg_enum e on t.oid = e.enumtypid  
                             ^
blog_post_system=# select n.nspname as enum_schema,  
       t.typname as enum_name,  
       e.enumlabel as enum_value
from pg_type Tabk 
   join pg_enum e on t.oid = e.enumtypid  
   join pg_catalog.pg_namespace n ON n.oid = t.typnamespace
;
ERROR:  missing FROM-clause entry for table "t"
LINE 5:    join pg_enum e on t.oid = e.enumtypid  
                             ^
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select n.nspname as enum_schema,  
blog_post_system-#        t.typname as enum_name,  
blog_post_system-#        e.enumlabel as enum_value
blog_post_system-# from pg_type t 
blog_post_system-#    join pg_enum e on t.oid = e.enumtypid  
blog_post_system-#    join pg_catalog.pg_namespace n ON n.oid = t.typnamespace
blog_post_system-# ;
 enum_schema | enum_name | enum_value 
-------------+-----------+------------
 public      | mood      | sad
 public      | mood      | ok
 public      | mood      | happy
(3 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select * from pg_enum;
 enumtypid | enumsortorder | enumlabel 
-----------+---------------+-----------
    157592 |             1 | sad
    157592 |             2 | ok
    157592 |             3 | happy
(3 rows)

blog_post_system=# select * from pg_type;
blog_post_system=# select * from pg_enum;
 enumtypid | enumsortorder | enumlabel 
-----------+---------------+-----------
    157592 |             1 | sad
    157592 |             2 | ok
    157592 |             3 | happy
(3 rows)

blog_post_system=# select typname from pg_enum;
ERROR:  column "typname" does not exist
LINE 1: select typname from pg_enum;
               ^
blog_post_system=# select typname from pg_type;
blog_post_system=# select * from pg_catelog;
ERROR:  relation "pg_catelog" does not exist
LINE 1: select * from pg_catelog;
                      ^
blog_post_system=# select * from pg_catalog;
ERROR:  relation "pg_catalog" does not exist
LINE 1: select * from pg_catalog;
                      ^
blog_post_system=# select * from pg_catalog.pg_namespace;
      nspname       | nspowner |               nspacl                
--------------------+----------+-------------------------------------
 pg_toast           |       10 | 
 pg_temp_1          |       10 | 
 pg_toast_temp_1    |       10 | 
 pg_catalog         |       10 | {postgres=UC/postgres,=U/postgres}
 public             |       10 | {postgres=UC/postgres,=UC/postgres}
 information_schema |       10 | {postgres=UC/postgres,=U/postgres}
(6 rows)

blog_post_system=# \d
             List of relations
 Schema |    Name     |   Type   |  Owner   
--------+-------------+----------+----------
 public | categories  | table    | postgres
 public | comments    | table    | postgres
 public | count_views | view     | postgres
 public | likes       | table    | postgres
 public | person      | table    | postgres
 public | pk          | table    | postgres
 public | pk_id_seq   | sequence | postgres
 public | posts       | table    | postgres
 public | users       | table    | postgres
(9 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select count(S.id) from (select P.id, count(L.id) from users U join posts P on U.id = P.user_id join Likes L on U.id = L.user_id group by P.id) as S;
 count 
-------
     6
(1 row)

blog_post_system=# delect * from users where id in select count(S.id) from (select P.id, count(L.id) from users U join posts P on U.id = P.user_id join Likes L on U.id = L.user_id group by P.id) as S;
ERROR:  syntax error at or near "delect"
LINE 1: delect * from users where id in select count(S.id) from (sel...
        ^
blog_post_system=# select * from users where id in select count(S.id) from (select P.id, count(L.id) from users U join posts P on U.id = P.user_id join Likes L on U.id = L.user_id group by P.id) as S;
ERROR:  syntax error at or near "select"
LINE 1: select * from users where id in select count(S.id) from (sel...
                                        ^
blog_post_system=# select P.id, count(L.id) from users U join posts P on U.id = P.user_id join Likes L on U.id = L.user_id group by P.id;
 id | count 
----+-------
 11 |     2
 12 |     2
 10 |     2
  8 |     2
  6 |     2
  9 |     2
(6 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# select * from user where id in (select P.id, count(L.id) from users U join posts P on U.id = P.user_id join Likes L on U.id = L.user_id group by P.id);
ERROR:  column "id" does not exist
LINE 1: select * from user where id in (select P.id, count(L.id) fro...
                                 ^
blog_post_system=# select * from users where id in (select P.id, count(L.id) from users U join posts P on U.id = P.user_id join Likes L on U.id = L.user_id group by P.id);
ERROR:  subquery has too many columns
LINE 1: select * from users where id in (select P.id, count(L.id) fr...
                                     ^
blog_post_system=# 
blog_post_system=# select * from users where id in (select P.id from users U join posts P on U.id = P.user_id join Likes L on U.id = L.user_id group by P.id);
 id |  name   | address | paid 
----+---------+---------+------
  6 | Gundeep | Patiala | t
  8 | Motilal | Chhapra | f
  9 | Bittu   | Chhapra | f
 10 | Bittu   | Patna   | t
 11 | Pavan   | Patna   | t
 12 | Pavan   | Chhapra | t
(6 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select U.id, U.name, P.id, P.title, P.content from users U join posts P on U.id = P.user_id join Likes L on U.id = L.user_id ;
 id |  name  | id |   title   |     content      
----+--------+----+-----------+------------------
  1 | Pankaj |  6 | a food    | foods are heavy.
  1 | Pankaj |  6 | a food    | foods are heavy.
 14 | Naveen | 12 | a wood    | woods are heavy.
 14 | Naveen | 11 | a cloth   | cloths are red.
 14 | Naveen | 10 | a food    | foods are good.
 14 | Naveen |  9 | the goods | goods are light.
 14 | Naveen |  8 | a food    | foods are light.
 14 | Naveen | 12 | a wood    | woods are heavy.
 14 | Naveen | 11 | a cloth   | cloths are red.
 14 | Naveen | 10 | a food    | foods are good.
 14 | Naveen |  9 | the goods | goods are light.
 14 | Naveen |  8 | a food    | foods are light.
(12 rows)

blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content from users U join posts P on U.id = P.user_id join Likes L on U.id = L.user_id ;
 user_id | user_name | post_id |   title   |     content      
---------+-----------+---------+-----------+------------------
       1 | Pankaj    |       6 | a food    | foods are heavy.
       1 | Pankaj    |       6 | a food    | foods are heavy.
      14 | Naveen    |      12 | a wood    | woods are heavy.
      14 | Naveen    |      11 | a cloth   | cloths are red.
      14 | Naveen    |      10 | a food    | foods are good.
      14 | Naveen    |       9 | the goods | goods are light.
      14 | Naveen    |       8 | a food    | foods are light.
      14 | Naveen    |      12 | a wood    | woods are heavy.
      14 | Naveen    |      11 | a cloth   | cloths are red.
      14 | Naveen    |      10 | a food    | foods are good.
      14 | Naveen    |       9 | the goods | goods are light.
      14 | Naveen    |       8 | a food    | foods are light.
(12 rows)

blog_post_system=# select * from likes;
 id | user_id | post_id 
----+---------+---------
  1 |       1 |       1
  2 |       1 |       2
  3 |       2 |       1
  4 |       2 |       5
  5 |       2 |       6
  6 |       4 |       6
  7 |       4 |       6
  8 |       4 |      12
  9 |      14 |      12
 10 |      14 |      11
 11 |      11 |      11
(11 rows)

blog_post_system=# select * from user U join likes L on U.id = L.user_id;
ERROR:  column u.id does not exist
LINE 1: select * from user U join likes L on U.id = L.user_id;
                                             ^
HINT:  Perhaps you meant to reference the column "l.id".
blog_post_system=# select * from users U join likes L on U.id = L.user_id;
 id |  name  | address | paid | id | user_id | post_id 
----+--------+---------+------+----+---------+---------
  1 | Pankaj | Patna   | f    |  1 |       1 |       1
  1 | Pankaj | Patna   | f    |  2 |       1 |       2
  2 | Pankaj | Patna   | t    |  3 |       2 |       1
  2 | Pankaj | Patna   | t    |  4 |       2 |       5
  2 | Pankaj | Patna   | t    |  5 |       2 |       6
  4 | Mohit  | Delhi   | f    |  6 |       4 |       6
  4 | Mohit  | Delhi   | f    |  7 |       4 |       6
  4 | Mohit  | Delhi   | f    |  8 |       4 |      12
 14 | Naveen | Patiala | t    |  9 |      14 |      12
 14 | Naveen | Patiala | t    | 10 |      14 |      11
 11 | Pavan  | Patna   | t    | 11 |      11 |      11
(11 rows)

blog_post_system=# select * from users U left outer join likes L on U.id = L.user_id;
 id |  name   | address  | paid | id | user_id | post_id 
----+---------+----------+------+----+---------+---------
  1 | Pankaj  | Patna    | f    |  1 |       1 |       1
  1 | Pankaj  | Patna    | f    |  2 |       1 |       2
  2 | Pankaj  | Patna    | t    |  3 |       2 |       1
  2 | Pankaj  | Patna    | t    |  4 |       2 |       5
  2 | Pankaj  | Patna    | t    |  5 |       2 |       6
  4 | Mohit   | Delhi    | f    |  6 |       4 |       6
  4 | Mohit   | Delhi    | f    |  7 |       4 |       6
  4 | Mohit   | Delhi    | f    |  8 |       4 |      12
 14 | Naveen  | Patiala  | t    |  9 |      14 |      12
 14 | Naveen  | Patiala  | t    | 10 |      14 |      11
 11 | Pavan   | Patna    | t    | 11 |      11 |      11
 17 | Doe     | Goa      | t    |    |         |        
 12 | Pavan   | Chhapra  | t    |    |         |        
 10 | Bittu   | Patna    | t    |    |         |        
 15 | Praveen | Chhapra  | f    |    |         |        
 13 | Naveen  | Chhapra  | t    |    |         |        
  5 | Rohit   | Hariyana | f    |    |         |        
  8 | Motilal | Chhapra  | f    |    |         |        
  6 | Gundeep | Patiala  | t    |    |         |        
 16 | John    | Goa      | f    |    |         |        
  3 | Saurabh | Delhi    | t    |    |         |        
  9 | Bittu   | Chhapra  | f    |    |         |        
  7 | Manjeet | Patiala  | t    |    |         |        
(23 rows)

blog_post_system=# select * from users U join likes L on U.id = L.user_id;
 id |  name  | address | paid | id | user_id | post_id 
----+--------+---------+------+----+---------+---------
  1 | Pankaj | Patna   | f    |  1 |       1 |       1
  1 | Pankaj | Patna   | f    |  2 |       1 |       2
  2 | Pankaj | Patna   | t    |  3 |       2 |       1
  2 | Pankaj | Patna   | t    |  4 |       2 |       5
  2 | Pankaj | Patna   | t    |  5 |       2 |       6
  4 | Mohit  | Delhi   | f    |  6 |       4 |       6
  4 | Mohit  | Delhi   | f    |  7 |       4 |       6
  4 | Mohit  | Delhi   | f    |  8 |       4 |      12
 14 | Naveen | Patiala | t    |  9 |      14 |      12
 14 | Naveen | Patiala | t    | 10 |      14 |      11
 11 | Pavan  | Patna   | t    | 11 |      11 |      11
(11 rows)

blog_post_system=# select * from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id;
 id |  name  | address | paid | id | user_id | post_id | id | user_id |  title   |            content             | category_id 
----+--------+---------+------+----+---------+---------+----+---------+----------+--------------------------------+-------------
  1 | Pankaj | Patna   | f    |  1 |       1 |       1 |  1 |       5 | a mango  | Mangoes are sweets.            |           2
  1 | Pankaj | Patna   | f    |  2 |       1 |       2 |  2 |       5 | a banana | Bananas are sweets and yellow. |           2
  2 | Pankaj | Patna   | t    |  3 |       2 |       1 |  1 |       5 | a mango  | Mangoes are sweets.            |           2
  2 | Pankaj | Patna   | t    |  4 |       2 |       5 |  5 |      10 | a goods  | Goods are heavy.               |           1
  2 | Pankaj | Patna   | t    |  5 |       2 |       6 |  6 |       1 | a food   | foods are heavy.               |           3
  4 | Mohit  | Delhi   | f    |  6 |       4 |       6 |  6 |       1 | a food   | foods are heavy.               |           3
  4 | Mohit  | Delhi   | f    |  7 |       4 |       6 |  6 |       1 | a food   | foods are heavy.               |           3
  4 | Mohit  | Delhi   | f    |  8 |       4 |      12 | 12 |      14 | a wood   | woods are heavy.               |           4
 14 | Naveen | Patiala | t    |  9 |      14 |      12 | 12 |      14 | a wood   | woods are heavy.               |           4
 14 | Naveen | Patiala | t    | 10 |      14 |      11 | 11 |      14 | a cloth  | cloths are red.                |           8
 11 | Pavan  | Patna   | t    | 11 |      11 |      11 | 11 |      14 | a cloth  | cloths are red.                |           8
(11 rows)

blog_post_system=# select * from users U join likes L on U.id = L.user_id left outer join posts P on P.id = L.post_id;
 id |  name  | address | paid | id | user_id | post_id | id | user_id |  title   |            content             | category_id 
----+--------+---------+------+----+---------+---------+----+---------+----------+--------------------------------+-------------
  1 | Pankaj | Patna   | f    |  1 |       1 |       1 |  1 |       5 | a mango  | Mangoes are sweets.            |           2
  1 | Pankaj | Patna   | f    |  2 |       1 |       2 |  2 |       5 | a banana | Bananas are sweets and yellow. |           2
  2 | Pankaj | Patna   | t    |  3 |       2 |       1 |  1 |       5 | a mango  | Mangoes are sweets.            |           2
  2 | Pankaj | Patna   | t    |  4 |       2 |       5 |  5 |      10 | a goods  | Goods are heavy.               |           1
  2 | Pankaj | Patna   | t    |  5 |       2 |       6 |  6 |       1 | a food   | foods are heavy.               |           3
  4 | Mohit  | Delhi   | f    |  6 |       4 |       6 |  6 |       1 | a food   | foods are heavy.               |           3
  4 | Mohit  | Delhi   | f    |  7 |       4 |       6 |  6 |       1 | a food   | foods are heavy.               |           3
  4 | Mohit  | Delhi   | f    |  8 |       4 |      12 | 12 |      14 | a wood   | woods are heavy.               |           4
 14 | Naveen | Patiala | t    |  9 |      14 |      12 | 12 |      14 | a wood   | woods are heavy.               |           4
 14 | Naveen | Patiala | t    | 10 |      14 |      11 | 11 |      14 | a cloth  | cloths are red.                |           8
 11 | Pavan  | Patna   | t    | 11 |      11 |      11 | 11 |      14 | a cloth  | cloths are red.                |           8
(11 rows)

blog_post_system=# select * from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id;
 id |  name  | address | paid | id | user_id | post_id | id | user_id |  title   |            content             | category_id 
----+--------+---------+------+----+---------+---------+----+---------+----------+--------------------------------+-------------
  1 | Pankaj | Patna   | f    |  1 |       1 |       1 |  1 |       5 | a mango  | Mangoes are sweets.            |           2
  1 | Pankaj | Patna   | f    |  2 |       1 |       2 |  2 |       5 | a banana | Bananas are sweets and yellow. |           2
  2 | Pankaj | Patna   | t    |  3 |       2 |       1 |  1 |       5 | a mango  | Mangoes are sweets.            |           2
  2 | Pankaj | Patna   | t    |  4 |       2 |       5 |  5 |      10 | a goods  | Goods are heavy.               |           1
  2 | Pankaj | Patna   | t    |  5 |       2 |       6 |  6 |       1 | a food   | foods are heavy.               |           3
  4 | Mohit  | Delhi   | f    |  6 |       4 |       6 |  6 |       1 | a food   | foods are heavy.               |           3
  4 | Mohit  | Delhi   | f    |  7 |       4 |       6 |  6 |       1 | a food   | foods are heavy.               |           3
  4 | Mohit  | Delhi   | f    |  8 |       4 |      12 | 12 |      14 | a wood   | woods are heavy.               |           4
 14 | Naveen | Patiala | t    |  9 |      14 |      12 | 12 |      14 | a wood   | woods are heavy.               |           4
 14 | Naveen | Patiala | t    | 10 |      14 |      11 | 11 |      14 | a cloth  | cloths are red.                |           8
 11 | Pavan  | Patna   | t    | 11 |      11 |      11 | 11 |      14 | a cloth  | cloths are red.                |           8
(11 rows)

blog_post_system=# select * from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id where U.paid = false;
 id |  name  | address | paid | id | user_id | post_id | id | user_id |  title   |            content             | category_id 
----+--------+---------+------+----+---------+---------+----+---------+----------+--------------------------------+-------------
  1 | Pankaj | Patna   | f    |  1 |       1 |       1 |  1 |       5 | a mango  | Mangoes are sweets.            |           2
  1 | Pankaj | Patna   | f    |  2 |       1 |       2 |  2 |       5 | a banana | Bananas are sweets and yellow. |           2
  4 | Mohit  | Delhi   | f    |  6 |       4 |       6 |  6 |       1 | a food   | foods are heavy.               |           3
  4 | Mohit  | Delhi   | f    |  7 |       4 |       6 |  6 |       1 | a food   | foods are heavy.               |           3
  4 | Mohit  | Delhi   | f    |  8 |       4 |      12 | 12 |      14 | a wood   | woods are heavy.               |           4
(5 rows)

blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id where U.paid = false;
 user_id | user_name | post_id |  title   |            content             
---------+-----------+---------+----------+--------------------------------
       1 | Pankaj    |       1 | a mango  | Mangoes are sweets.
       1 | Pankaj    |       2 | a banana | Bananas are sweets and yellow.
       4 | Mohit     |       6 | a food   | foods are heavy.
       4 | Mohit     |       6 | a food   | foods are heavy.
       4 | Mohit     |      12 | a wood   | woods are heavy.
(5 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id where U.paid = false group by U.id;
ERROR:  column "p.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select U.id as user_id, U.name as user_name, P.id as post_id...
                                                     ^
blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id where U.paid = false;
 user_id | user_name | post_id |  title   |            content             
---------+-----------+---------+----------+--------------------------------
       1 | Pankaj    |       1 | a mango  | Mangoes are sweets.
       1 | Pankaj    |       2 | a banana | Bananas are sweets and yellow.
       4 | Mohit     |       6 | a food   | foods are heavy.
       4 | Mohit     |       6 | a food   | foods are heavy.
       4 | Mohit     |      12 | a wood   | woods are heavy.
(5 rows)

blog_post_system=# select * from users;
 id |  name   | address  | paid 
----+---------+----------+------
  1 | Pankaj  | Patna    | f
  2 | Pankaj  | Patna    | t
  3 | Saurabh | Delhi    | t
  4 | Mohit   | Delhi    | f
  5 | Rohit   | Hariyana | f
  6 | Gundeep | Patiala  | t
  7 | Manjeet | Patiala  | t
  8 | Motilal | Chhapra  | f
  9 | Bittu   | Chhapra  | f
 10 | Bittu   | Patna    | t
 11 | Pavan   | Patna    | t
 12 | Pavan   | Chhapra  | t
 13 | Naveen  | Chhapra  | t
 14 | Naveen  | Patiala  | t
 15 | Praveen | Chhapra  | f
 16 | John    | Goa      | f
 17 | Doe     | Goa      | t
(17 rows)

blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id where U.paid = false;
 user_id | user_name | post_id |  title   |            content             
---------+-----------+---------+----------+--------------------------------
       1 | Pankaj    |       1 | a mango  | Mangoes are sweets.
       1 | Pankaj    |       2 | a banana | Bananas are sweets and yellow.
       4 | Mohit     |       6 | a food   | foods are heavy.
       4 | Mohit     |       6 | a food   | foods are heavy.
       4 | Mohit     |      12 | a wood   | woods are heavy.
(5 rows)

blog_post_system=# 
blog_post_system=# select * from comments;
 id | user_id | post_id | enable |          content           
----+---------+---------+--------+----------------------------
  1 |       1 |       1 | t      | Empty
  2 |       1 |       3 | f      | This mangoes are not sweet
  3 |       3 |       5 | t      | This goods are light
  4 |      12 |      15 | t      | foods are good
  5 |      12 |      14 | f      | cloths are old
  6 |      12 |      11 | t      | foods are not good
  7 |      12 |       5 | t      | mangoes are not good
(7 rows)

blog_post_system=# select * from likes;
 id | user_id | post_id 
----+---------+---------
  1 |       1 |       1
  2 |       1 |       2
  3 |       2 |       1
  4 |       2 |       5
  5 |       2 |       6
  6 |       4 |       6
  7 |       4 |       6
  8 |       4 |      12
  9 |      14 |      12
 10 |      14 |      11
 11 |      11 |      11
(11 rows)

blog_post_system=# update likes set post_id = 7 where id = 6;
UPDATE 1
blog_post_system=# select * from likes;
 id | user_id | post_id 
----+---------+---------
  1 |       1 |       1
  2 |       1 |       2
  3 |       2 |       1
  4 |       2 |       5
  5 |       2 |       6
  7 |       4 |       6
  8 |       4 |      12
  9 |      14 |      12
 10 |      14 |      11
 11 |      11 |      11
  6 |       4 |       7
(11 rows)

blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id where U.paid = false;
 user_id | user_name | post_id |  title   |            content             
---------+-----------+---------+----------+--------------------------------
       1 | Pankaj    |       1 | a mango  | Mangoes are sweets.
       1 | Pankaj    |       2 | a banana | Bananas are sweets and yellow.
       4 | Mohit     |       6 | a food   | foods are heavy.
       4 | Mohit     |      12 | a wood   | woods are heavy.
       4 | Mohit     |       7 | a food   | foods are light.
(5 rows)

blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id join comments C on U.id = C.user_id where U.paid = false;
 user_id | user_name | post_id |  title   |            content             
---------+-----------+---------+----------+--------------------------------
       1 | Pankaj    |       1 | a mango  | Mangoes are sweets.
       1 | Pankaj    |       1 | a mango  | Mangoes are sweets.
       1 | Pankaj    |       2 | a banana | Bananas are sweets and yellow.
       1 | Pankaj    |       2 | a banana | Bananas are sweets and yellow.
(4 rows)

blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content as post_content, C.content as comment_content from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id join comments C on U.id = C.user_id where U.paid = false;
 user_id | user_name | post_id |  title   |          post_content          |      comment_content       
---------+-----------+---------+----------+--------------------------------+----------------------------
       1 | Pankaj    |       1 | a mango  | Mangoes are sweets.            | This mangoes are not sweet
       1 | Pankaj    |       1 | a mango  | Mangoes are sweets.            | Empty
       1 | Pankaj    |       2 | a banana | Bananas are sweets and yellow. | This mangoes are not sweet
       1 | Pankaj    |       2 | a banana | Bananas are sweets and yellow. | Empty
(4 rows)

blog_post_system=# insert into comments values (8, 4, 6, default, 'good foods');
INSERT 0 1
blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content as post_content, C.content as comment_content from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id join comments C on U.id = C.user_id where U.paid = false;
 user_id | user_name | post_id |  title   |          post_content          |      comment_content       
---------+-----------+---------+----------+--------------------------------+----------------------------
       1 | Pankaj    |       1 | a mango  | Mangoes are sweets.            | This mangoes are not sweet
       1 | Pankaj    |       1 | a mango  | Mangoes are sweets.            | Empty
       1 | Pankaj    |       2 | a banana | Bananas are sweets and yellow. | This mangoes are not sweet
       1 | Pankaj    |       2 | a banana | Bananas are sweets and yellow. | Empty
       4 | Mohit     |       6 | a food   | foods are heavy.               | good foods
       4 | Mohit     |      12 | a wood   | woods are heavy.               | good foods
       4 | Mohit     |       7 | a food   | foods are light.               | good foods
(7 rows)

blog_post_system=# select * from comments;
 id | user_id | post_id | enable |          content           
----+---------+---------+--------+----------------------------
  1 |       1 |       1 | t      | Empty
  2 |       1 |       3 | f      | This mangoes are not sweet
  3 |       3 |       5 | t      | This goods are light
  4 |      12 |      15 | t      | foods are good
  5 |      12 |      14 | f      | cloths are old
  6 |      12 |      11 | t      | foods are not good
  7 |      12 |       5 | t      | mangoes are not good
  8 |       4 |       6 | t      | good foods
(8 rows)

blog_post_system=# insert into comments values (9, 4, 12, default, 'good wood');
INSERT 0 1
blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content as post_content, C.content as comment_content from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id join comments C on U.id = C.user_id where U.paid = false;
 user_id | user_name | post_id |  title   |          post_content          |      comment_content       
---------+-----------+---------+----------+--------------------------------+----------------------------
       1 | Pankaj    |       1 | a mango  | Mangoes are sweets.            | This mangoes are not sweet
       1 | Pankaj    |       1 | a mango  | Mangoes are sweets.            | Empty
       1 | Pankaj    |       2 | a banana | Bananas are sweets and yellow. | This mangoes are not sweet
       1 | Pankaj    |       2 | a banana | Bananas are sweets and yellow. | Empty
       4 | Mohit     |       6 | a food   | foods are heavy.               | good wood
       4 | Mohit     |       6 | a food   | foods are heavy.               | good foods
       4 | Mohit     |      12 | a wood   | woods are heavy.               | good wood
       4 | Mohit     |      12 | a wood   | woods are heavy.               | good foods
       4 | Mohit     |       7 | a food   | foods are light.               | good wood
       4 | Mohit     |       7 | a food   | foods are light.               | good foods
(10 rows)

blog_post_system=# select distinct U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content as post_content, C.content as comment_content from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id join comments C on U.id = C.user_id where U.paid = false;
 user_id | user_name | post_id |  title   |          post_content          |      comment_content       
---------+-----------+---------+----------+--------------------------------+----------------------------
       1 | Pankaj    |       2 | a banana | Bananas are sweets and yellow. | Empty
       4 | Mohit     |       6 | a food   | foods are heavy.               | good foods
       4 | Mohit     |       6 | a food   | foods are heavy.               | good wood
       1 | Pankaj    |       1 | a mango  | Mangoes are sweets.            | This mangoes are not sweet
       1 | Pankaj    |       1 | a mango  | Mangoes are sweets.            | Empty
       4 | Mohit     |       7 | a food   | foods are light.               | good foods
       4 | Mohit     |      12 | a wood   | woods are heavy.               | good foods
       1 | Pankaj    |       2 | a banana | Bananas are sweets and yellow. | This mangoes are not sweet
       4 | Mohit     |      12 | a wood   | woods are heavy.               | good wood
       4 | Mohit     |       7 | a food   | foods are light.               | good wood
(10 rows)

blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content as post_content, C.content as comment_content from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id join comments C on U.id = C.user_id where U.paid = false;
 user_id | user_name | post_id |  title   |          post_content          |      comment_content       
---------+-----------+---------+----------+--------------------------------+----------------------------
       1 | Pankaj    |       1 | a mango  | Mangoes are sweets.            | This mangoes are not sweet
       1 | Pankaj    |       1 | a mango  | Mangoes are sweets.            | Empty
       1 | Pankaj    |       2 | a banana | Bananas are sweets and yellow. | This mangoes are not sweet
       1 | Pankaj    |       2 | a banana | Bananas are sweets and yellow. | Empty
       4 | Mohit     |       6 | a food   | foods are heavy.               | good wood
       4 | Mohit     |       6 | a food   | foods are heavy.               | good foods
       4 | Mohit     |      12 | a wood   | woods are heavy.               | good wood
       4 | Mohit     |      12 | a wood   | woods are heavy.               | good foods
       4 | Mohit     |       7 | a food   | foods are light.               | good wood
       4 | Mohit     |       7 | a food   | foods are light.               | good foods
(10 rows)

blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content as post_content, C.content as comment_content from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id join comments C on P.id = C.post_id where U.paid = false;
 user_id | user_name | post_id |  title  |    post_content     | comment_content 
---------+-----------+---------+---------+---------------------+-----------------
       1 | Pankaj    |       1 | a mango | Mangoes are sweets. | Empty
       4 | Mohit     |       6 | a food  | foods are heavy.    | good foods
       4 | Mohit     |      12 | a wood  | woods are heavy.    | good wood
(3 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id where U.paid = false;
 user_id | user_name | post_id |  title   |            content             
---------+-----------+---------+----------+--------------------------------
       1 | Pankaj    |       1 | a mango  | Mangoes are sweets.
       1 | Pankaj    |       2 | a banana | Bananas are sweets and yellow.
       4 | Mohit     |       6 | a food   | foods are heavy.
       4 | Mohit     |      12 | a wood   | woods are heavy.
       4 | Mohit     |       7 | a food   | foods are light.
(5 rows)

blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content as post_content, C.content as comment_content from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id join comments C on P.id = C.post_id where U.paid = false;
 user_id | user_name | post_id |  title  |    post_content     | comment_content 
---------+-----------+---------+---------+---------------------+-----------------
       1 | Pankaj    |       1 | a mango | Mangoes are sweets. | Empty
       4 | Mohit     |       6 | a food  | foods are heavy.    | good foods
       4 | Mohit     |      12 | a wood  | woods are heavy.    | good wood
(3 rows)

blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content as post_content, C.content as comment_content from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id join comments C on U.id = C.user_id where U.paid = false;
 user_id | user_name | post_id |  title   |          post_content          |      comment_content       
---------+-----------+---------+----------+--------------------------------+----------------------------
       1 | Pankaj    |       1 | a mango  | Mangoes are sweets.            | This mangoes are not sweet
       1 | Pankaj    |       1 | a mango  | Mangoes are sweets.            | Empty
       1 | Pankaj    |       2 | a banana | Bananas are sweets and yellow. | This mangoes are not sweet
       1 | Pankaj    |       2 | a banana | Bananas are sweets and yellow. | Empty
       4 | Mohit     |       6 | a food   | foods are heavy.               | good wood
       4 | Mohit     |       6 | a food   | foods are heavy.               | good foods
       4 | Mohit     |      12 | a wood   | woods are heavy.               | good wood
       4 | Mohit     |      12 | a wood   | woods are heavy.               | good foods
       4 | Mohit     |       7 | a food   | foods are light.               | good wood
       4 | Mohit     |       7 | a food   | foods are light.               | good foods
(10 rows)

blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content as post_content, C.content as comment_content from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id join comments C on U.id = C.user_id where U.paid = false and L.user_id = C.user_id;
 user_id | user_name | post_id |  title   |          post_content          |      comment_content       
---------+-----------+---------+----------+--------------------------------+----------------------------
       1 | Pankaj    |       1 | a mango  | Mangoes are sweets.            | This mangoes are not sweet
       1 | Pankaj    |       1 | a mango  | Mangoes are sweets.            | Empty
       1 | Pankaj    |       2 | a banana | Bananas are sweets and yellow. | This mangoes are not sweet
       1 | Pankaj    |       2 | a banana | Bananas are sweets and yellow. | Empty
       4 | Mohit     |       6 | a food   | foods are heavy.               | good wood
       4 | Mohit     |       6 | a food   | foods are heavy.               | good foods
       4 | Mohit     |      12 | a wood   | woods are heavy.               | good wood
       4 | Mohit     |      12 | a wood   | woods are heavy.               | good foods
       4 | Mohit     |       7 | a food   | foods are light.               | good wood
       4 | Mohit     |       7 | a food   | foods are light.               | good foods
(10 rows)

blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id where U.paid = false;
 user_id | user_name | post_id |  title   |            content             
---------+-----------+---------+----------+--------------------------------
       1 | Pankaj    |       1 | a mango  | Mangoes are sweets.
       1 | Pankaj    |       2 | a banana | Bananas are sweets and yellow.
       4 | Mohit     |       6 | a food   | foods are heavy.
       4 | Mohit     |      12 | a wood   | woods are heavy.
       4 | Mohit     |       7 | a food   | foods are light.
(5 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content, L.id from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id where U.paid = false;
 user_id | user_name | post_id |  title   |            content             | id 
---------+-----------+---------+----------+--------------------------------+----
       1 | Pankaj    |       1 | a mango  | Mangoes are sweets.            |  1
       1 | Pankaj    |       2 | a banana | Bananas are sweets and yellow. |  2
       4 | Mohit     |       6 | a food   | foods are heavy.               |  7
       4 | Mohit     |      12 | a wood   | woods are heavy.               |  8
       4 | Mohit     |       7 | a food   | foods are light.               |  6
(5 rows)

blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content, L.post_id from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id where U.paid = false;
 user_id | user_name | post_id |  title   |            content             | post_id 
---------+-----------+---------+----------+--------------------------------+---------
       1 | Pankaj    |       1 | a mango  | Mangoes are sweets.            |       1
       1 | Pankaj    |       2 | a banana | Bananas are sweets and yellow. |       2
       4 | Mohit     |       6 | a food   | foods are heavy.               |       6
       4 | Mohit     |      12 | a wood   | woods are heavy.               |      12
       4 | Mohit     |       7 | a food   | foods are light.               |       7
(5 rows)

blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content, L.post_id from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id join comments C on C.post_id = P.post  where U.paid = false;
ERROR:  column p.post does not exist
LINE 1: ...n P.id = L.post_id join comments C on C.post_id = P.post  wh...
                                                             ^
blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content, L.post_id from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id join comments C on C.post_id = P.post_id  where U.paid = false;
ERROR:  column p.post_id does not exist
LINE 1: ...n P.id = L.post_id join comments C on C.post_id = P.post_id ...
                                                             ^
HINT:  Perhaps you meant to reference the column "l.post_id" or the column "c.post_id".
blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content, L.post_id from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id join comments C on C.post_id = P.post_id  where U.paid = false;
ERROR:  column p.post_id does not exist
LINE 1: ...n P.id = L.post_id join comments C on C.post_id = P.post_id ...
                                                             ^
HINT:  Perhaps you meant to reference the column "l.post_id" or the column "c.post_id".
blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content, L.post_id from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id join comments C on C.post_id = L.post_id  where U.paid = false;
 user_id | user_name | post_id |  title  |       content       | post_id 
---------+-----------+---------+---------+---------------------+---------
       1 | Pankaj    |       1 | a mango | Mangoes are sweets. |       1
       4 | Mohit     |       6 | a food  | foods are heavy.    |       6
       4 | Mohit     |      12 | a wood  | woods are heavy.    |      12
(3 rows)

blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content, C.content as comment_content from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id join comments C on C.post_id = L.post_id  where U.paid = false;
 user_id | user_name | post_id |  title  |       content       | comment_content 
---------+-----------+---------+---------+---------------------+-----------------
       1 | Pankaj    |       1 | a mango | Mangoes are sweets. | Empty
       4 | Mohit     |       6 | a food  | foods are heavy.    | good foods
       4 | Mohit     |      12 | a wood  | woods are heavy.    | good wood
(3 rows)

blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content, C.content as comment_content from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id join comments C on C.post_id = P.id  where U.paid = false;
 user_id | user_name | post_id |  title  |       content       | comment_content 
---------+-----------+---------+---------+---------------------+-----------------
       1 | Pankaj    |       1 | a mango | Mangoes are sweets. | Empty
       4 | Mohit     |       6 | a food  | foods are heavy.    | good foods
       4 | Mohit     |      12 | a wood  | woods are heavy.    | good wood
(3 rows)

blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content, C.content as comment_content from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id join comments C on p.id = C.post_id  where U.paid = false;
 user_id | user_name | post_id |  title  |       content       | comment_content 
---------+-----------+---------+---------+---------------------+-----------------
       1 | Pankaj    |       1 | a mango | Mangoes are sweets. | Empty
       4 | Mohit     |       6 | a food  | foods are heavy.    | good foods
       4 | Mohit     |      12 | a wood  | woods are heavy.    | good wood
(3 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content, C.content as comment_content from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id join comments C on p.id = C.post_id and  where U.paid = false;
ERROR:  syntax error at or near "where"
LINE 1: ....post_id join comments C on p.id = C.post_id and  where U.pa...
                                                             ^
blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content, C.content as comment_content from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id join comments C on p.id = C.post_id where U.paid = false;
 user_id | user_name | post_id |  title  |       content       | comment_content 
---------+-----------+---------+---------+---------------------+-----------------
       1 | Pankaj    |       1 | a mango | Mangoes are sweets. | Empty
       4 | Mohit     |       6 | a food  | foods are heavy.    | good foods
       4 | Mohit     |      12 | a wood  | woods are heavy.    | good wood
(3 rows)

blog_post_system=# 
blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content, C.content as comment_content from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id join comments C on P.id = C.post_id where U.paid = false;
 user_id | user_name | post_id |  title  |       content       | comment_content 
---------+-----------+---------+---------+---------------------+-----------------
       1 | Pankaj    |       1 | a mango | Mangoes are sweets. | Empty
       4 | Mohit     |       6 | a food  | foods are heavy.    | good foods
       4 | Mohit     |      12 | a wood  | woods are heavy.    | good wood
(3 rows)

blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content, C.content as comment_content from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id join comments C on P.id = C.post_id and U.id = C.user_id where U.paid = false;
 user_id | user_name | post_id |  title  |       content       | comment_content 
---------+-----------+---------+---------+---------------------+-----------------
       1 | Pankaj    |       1 | a mango | Mangoes are sweets. | Empty
       4 | Mohit     |       6 | a food  | foods are heavy.    | good foods
       4 | Mohit     |      12 | a wood  | woods are heavy.    | good wood
(3 rows)

blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content, C.content as comment_content from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id join comments C on U.id = C.user_id where U.paid = false;
 user_id | user_name | post_id |  title   |            content             |      comment_content       
---------+-----------+---------+----------+--------------------------------+----------------------------
       1 | Pankaj    |       1 | a mango  | Mangoes are sweets.            | This mangoes are not sweet
       1 | Pankaj    |       1 | a mango  | Mangoes are sweets.            | Empty
       1 | Pankaj    |       2 | a banana | Bananas are sweets and yellow. | This mangoes are not sweet
       1 | Pankaj    |       2 | a banana | Bananas are sweets and yellow. | Empty
       4 | Mohit     |       6 | a food   | foods are heavy.               | good wood
       4 | Mohit     |       6 | a food   | foods are heavy.               | good foods
       4 | Mohit     |      12 | a wood   | woods are heavy.               | good wood
       4 | Mohit     |      12 | a wood   | woods are heavy.               | good foods
       4 | Mohit     |       7 | a food   | foods are light.               | good wood
       4 | Mohit     |       7 | a food   | foods are light.               | good foods
(10 rows)

blog_post_system=# select * from comments;
 id | user_id | post_id | enable |          content           
----+---------+---------+--------+----------------------------
  1 |       1 |       1 | t      | Empty
  2 |       1 |       3 | f      | This mangoes are not sweet
  3 |       3 |       5 | t      | This goods are light
  4 |      12 |      15 | t      | foods are good
  5 |      12 |      14 | f      | cloths are old
  6 |      12 |      11 | t      | foods are not good
  7 |      12 |       5 | t      | mangoes are not good
  8 |       4 |       6 | t      | good foods
  9 |       4 |      12 | t      | good wood
(9 rows)

blog_post_system=# select U.id as user_id, U.name as user_name, P.id as post_id, P.title, P.content, C.content as comment_content from users U join likes L on U.id = L.user_id join posts P on P.id = L.post_id join comments C on P.id = C.post_id and U.id = C.user_id where U.paid = false;
 user_id | user_name | post_id |  title  |       content       | comment_content 
---------+-----------+---------+---------+---------------------+-----------------
       1 | Pankaj    |       1 | a mango | Mangoes are sweets. | Empty
       4 | Mohit     |       6 | a food  | foods are heavy.    | good foods
       4 | Mohit     |      12 | a wood  | woods are heavy.    | good wood
(3 rows)

blog_post_system=# 















=========================================================================================
=========================library_managment_system========================================





 
blog_post_system=# create database library_managment_system
blog_post_system-# ;
CREATE DATABASE
blog_post_system=# 
blog_post_system=# 
blog_post_system=# \c library_managment_system
You are now connected to database "library_managment_system" as user "postgres".
library_managment_system=# 
library_managment_system=# 
library_managment_system=# \d
No relations found.
library_managment_system=# 
library_managment_system=# 
library_managment_system=# create table books (id serial primary key, name varchar not null, rental_price int not null, available boolean default true, category_id int not null, foreign key ')
library_managment_system'# ;
library_managment_system'# '
library_managment_system(# 0
library_managment_system(# )
library_managment_system-# ;
ERROR:  syntax error at or near "')
;
'"
LINE 1: ...olean default true, category_id int not null, foreign key ')
                                                                     ^
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# create table categories (id serial primary key, name varchar not null, amount int not null);
CREATE TABLE
library_managment_system=# create table books (id serial primary key, category_id int not null, name varchar not null, author varchar not null, publisher varchar not null,  rental_price int not null, available boolean default true, category_id int not null, foreign key (category) references categories(id);
library_managment_system(# \q
postgres@beryl-Latitude-E5520:/home/beryl$ psql library_managment_system
Password: 
psql (9.5.19)
Type "help" for help.

library_managment_system=# 
library_managment_system=# 
library_managment_system=# create table books (id serial primary key, category_id int not null, name varchar not null, author varchar not null, publisher varchar not null,  rental_price int not null, available boolean default true, category_id int not null, foreign key (category) references categories(id);
library_managment_system(# )
library_managment_system-# ;
ERROR:  syntax error at or near ";"
LINE 1: ... not null, foreign key (category) references categories(id);
                                                                      ^
library_managment_system=# create table books (id serial primary key, category_id int not null, name varchar not null, author varchar not null, publisher varchar not null,  rental_price int not null, available boolean default true, category_id int not null, foreign key (category) references categories(id));
ERROR:  column "category_id" specified more than once
library_managment_system=# create table books (id serial primary key, category_id int not null, name varchar not null, author varchar not null, publisher varchar not null,  rental_price int not null, available boolean default true, foreign key (category_id) references categories(id));
CREATE TABLE
library_managment_system=# 
library_managment_system=# 
library_managment_system=# create table students (id serial primary key, name varchar not null, address varchar not null, registration_date date not null);
CREATE TABLE
library_managment_system=# create table issue (id serial primary key, student_id int not null, date date not null, foreign key (student_id) references )
library_managment_system-# ^C
library_managment_system=# \dt
           List of relations
 Schema |    Name    | Type  |  Owner   
--------+------------+-------+----------
 public | books      | table | postgres
 public | categories | table | postgres
 public | students   | table | postgres
(3 rows)

library_managment_system=# \dt students 
          List of relations
 Schema |   Name   | Type  |  Owner   
--------+----------+-------+----------
 public | students | table | postgres
(1 row)

library_managment_system=# \d students 
                                    Table "public.students"
      Column       |       Type        |                       Modifiers                       
-------------------+-------------------+-------------------------------------------------------
 id                | integer           | not null default nextval('students_id_seq'::regclass)
 name              | character varying | not null
 address           | character varying | not null
 registration_date | date              | not null
Indexes:
    "students_pkey" PRIMARY KEY, btree (id)

library_managment_system=# create table issue (id serial primary key, student_id int not null, date date not null, foreign key (student_id) references students(id));
CREATE TABLE
library_managment_system=# 
library_managment_system=# 
library_managment_system=# create table issue_books (id serial primary key, issue_id int not null, book_id int not null, foreign key(issue_id) references issue(id), foreign key (book_id) references books(id));
CREATE TABLE
library_managment_system=# create table return (id serial primary key, student_id int not null, date date not null, foreign key (student_id) references students(id));
CREATE TABLE
library_managment_system=# create table return_books (id serial primary key, return_id int not null, book_id int not null, foreign key(issue_id) references issue(id), foreign key (book_id) references books(id));
ERROR:  column "issue_id" referenced in foreign key constraint does not exist
library_managment_system=# create table return_books (id serial primary key, return_id int not null, book_id int not null, foreign key(return_id) references issue(id), foreign key (book_id) references books(id));
CREATE TABLE
library_managment_system=# 
library_managment_system=# 
library_managment_system=# \dt
            List of relations
 Schema |     Name     | Type  |  Owner   
--------+--------------+-------+----------
 public | books        | table | postgres
 public | categories   | table | postgres
 public | issue        | table | postgres
 public | issue_books  | table | postgres
 public | return       | table | postgres
 public | return_books | table | postgres
 public | students     | table | postgres
(7 rows)

library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# create table employees (id serial primary key, name varchar not null, salary money not null, address varchar not null, contact bigint not null);
CREATE TABLE
library_managment_system=# 
library_managment_system=# \d
                 List of relations
 Schema |        Name         |   Type   |  Owner   
--------+---------------------+----------+----------
 public | books               | table    | postgres
 public | books_id_seq        | sequence | postgres
 public | categories          | table    | postgres
 public | categories_id_seq   | sequence | postgres
 public | employees           | table    | postgres
 public | employees_id_seq    | sequence | postgres
 public | issue               | table    | postgres
 public | issue_books         | table    | postgres
 public | issue_books_id_seq  | sequence | postgres
 public | issue_id_seq        | sequence | postgres
 public | return              | table    | postgres
 public | return_books        | table    | postgres
 public | return_books_id_seq | sequence | postgres
 public | return_id_seq       | sequence | postgres
 public | students            | table    | postgres
 public | students_id_seq     | sequence | postgres
(16 rows)

library_managment_system=# \d employees;
                               Table "public.employees"
 Column  |       Type        |                       Modifiers                        
---------+-------------------+--------------------------------------------------------
 id      | integer           | not null default nextval('employees_id_seq'::regclass)
 name    | character varying | not null
 salary  | money             | not null
 address | character varying | not null
 contact | bigint            | not null
Indexes:
    "employees_pkey" PRIMARY KEY, btree (id)

library_managment_system=# insert into employees values (1, 'Pankaj', 50000, 'Delhi', 7009147259);
INSERT 0 1
library_managment_system=# select * from employees;
 id |  name  |   salary   | address |  contact   
----+--------+------------+---------+------------
  1 | Pankaj | ₹50,000.00 | Delhi   | 7009147259
(1 row)

library_managment_system=# select salary from employees;
   salary   
------------
 ₹50,000.00
(1 row)

library_managment_system=# select sum(salary) from employees;
    sum     
------------
 ₹50,000.00
(1 row)

library_managment_system=# insert into employees values (2, 'Pankaj', 50000, 'Delhi', 7009147259);
INSERT 0 1
library_managment_system=# select sum(salary) from employees;
     sum     
-------------
 ₹100,000.00
(1 row)

library_managment_system=# select avg(salary) from employees;
ERROR:  function avg(money) does not exist
LINE 1: select avg(salary) from employees;
               ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
library_managment_system=# select avg(salary::numeric) from employees;
        avg         
--------------------
 50000.000000000000
(1 row)

library_managment_system=# select avg(regexp_replace(salary::text, '[₹,]', '', 'g')::numeric) from employees;
        avg         
--------------------
 50000.000000000000
(1 row)

library_managment_system=# 
library_managment_system=# \c blog_post_system
You are now connected to database "blog_post_system" as user "postgres".
blog_post_system=# 
blog_post_system=# 
blog_post_system=# \c library_managment_system
You are now connected to database "library_managment_system" as user "postgres".
library_managment_system=# 
library_managment_system=# 
library_managment_system=# alter table issue_books add column employee_id int not null;
ALTER TABLE
library_managment_system=# alter table issue_books add foreign key (employee_id) references employees(id);
ALTER TABLE
library_managment_system=# alter table return_books add column employee_id int not null;
ALTER TABLE
library_managment_system=# alter table return_books add foreign key (employee_id) references employees(id);
ALTER TABLE
library_managment_system=# \d
                 List of relations
 Schema |        Name         |   Type   |  Owner   
--------+---------------------+----------+----------
 public | books               | table    | postgres
 public | books_id_seq        | sequence | postgres
 public | categories          | table    | postgres
 public | categories_id_seq   | sequence | postgres
 public | employees           | table    | postgres
 public | employees_id_seq    | sequence | postgres
 public | issue               | table    | postgres
 public | issue_books         | table    | postgres
 public | issue_books_id_seq  | sequence | postgres
 public | issue_id_seq        | sequence | postgres
 public | return              | table    | postgres
 public | return_books        | table    | postgres
 public | return_books_id_seq | sequence | postgres
 public | return_id_seq       | sequence | postgres
 public | students            | table    | postgres
 public | students_id_seq     | sequence | postgres
(16 rows)

library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# \c blog_post_system
You are now connected to database "blog_post_system" as user "postgres".
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select count(P.id) from users U join posts P group by U.id;
ERROR:  syntax error at or near "group"
LINE 1: select count(P.id) from users U join posts P group by U.id;
                                                     ^
blog_post_system=# select count(P.id) from users U join posts P on U.id = P.user_id group by U.id;
 count 
-------
     3
     2
     1
     1
     5
     5
(6 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# select U.id as user_id, count(P.id) as post_count from users U join posts P on U.id = P.user_id group by U.id;
 user_id | post_count 
---------+------------
      10 |          3
       5 |          2
       1 |          1
       3 |          1
      14 |          5
       7 |          5
(6 rows)

blog_post_system=# select U.id as user_id, count(P.id) as post_count from users U join posts P on U.id = P.user_id group by U.id where U.paid = false; 
ERROR:  syntax error at or near "where"
LINE 1: ... U join posts P on U.id = P.user_id group by U.id where U.pa...
                                                             ^
blog_post_system=# select U.id as user_id, count(P.id) as post_count from users U join posts P on U.id = P.user_id where U.paid = false group by U.id; 
 user_id | post_count 
---------+------------
       1 |          1
       5 |          2
(2 rows)

blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# 
blog_post_system=# select P.id from users U1 join posts P1 on U1.id = P1.user_id where U.id in (select U.id as user_id, count(P.id) as post_count from users U join posts P on U.id = P.user_id where U.paid = false group by U.id;);
ERROR:  syntax error at or near ";"
LINE 1: ... P on U.id = P.user_id where U.paid = false group by U.id;);
                                                                    ^
blog_post_system=# select P.id from users U1 join posts P1 on U1.id = P1.user_id where U.id in (select U.id as user_id, count(P.id) as post_count from users U join posts P on U.id = P.user_id where U.paid = false group by U.id);
ERROR:  missing FROM-clause entry for table "p"
LINE 1: select P.id from users U1 join posts P1 on U1.id = P1.user_i...
               ^
blog_post_system=# select P.id from users U1 join posts P1 on U1.id = P1.user_id where U1.id in (select U.id as user_id, count(P.id) as post_count from users U join posts P on U.id = P.user_id where U.paid = false group by U.id);
ERROR:  missing FROM-clause entry for table "p"
LINE 1: select P.id from users U1 join posts P1 on U1.id = P1.user_i...
               ^
blog_post_system=# select P.id from users U1 join posts P1 on U1.id = P1.user_id where U1.id in (1,5,8);
ERROR:  missing FROM-clause entry for table "p"
LINE 1: select P.id from users U1 join posts P1 on U1.id = P1.user_i...
               ^
blog_post_system=# select P1.id from users U1 join posts P1 on U1.id = P1.user_id where U1.id in (1,5,8);
 id 
----
  1
  2
  6
(3 rows)

blog_post_system=# select P1.id from users U1 join posts P1 on U1.id = P1.user_id where U1.id in (select U.id as user_id, count(P.id) as post_count from users U join posts P on U.id = P.user_id where U.paid = false group by U.id);
ERROR:  subquery has too many columns
LINE 1: ...1 join posts P1 on U1.id = P1.user_id where U1.id in (select...
                                                             ^
blog_post_system=# select P1.id from users U1 join posts P1 on U1.id = P1.user_id where U1.id in (select U.id from users U join posts P on U.id = P.user_id where U.paid = false group by U.id);
 id 
----
  1
  2
  6
(3 rows)

blog_post_system=# select * from posts;
 id | user_id |   title   |            content             | category_id 
----+---------+-----------+--------------------------------+-------------
  5 |      10 | a goods   | Goods are heavy.               |           1
  1 |       5 | a mango   | Mangoes are sweets.            |           2
  2 |       5 | a banana  | Bananas are sweets and yellow. |           2
  3 |      10 | a banana  | Bananas are sweets and yellow. |           2
  4 |      10 | a book    | Books are good.                |           5
  6 |       1 | a food    | foods are heavy.               |           3
  7 |       3 | a food    | foods are light.               |           3
  8 |      14 | a food    | foods are light.               |           3
  9 |      14 | the goods | goods are light.               |           1
 10 |      14 | a food    | foods are good.                |           3
 11 |      14 | a cloth   | cloths are red.                |           8
 12 |      14 | a wood    | woods are heavy.               |           4
 13 |       7 | a food    | foods are light.               |           3
 14 |       7 | a cloth   | cloths are red.                |           8
 15 |       7 | a food    | foods are heavy.               |           3
 16 |       7 | a goods   | Goods are heavy.               |           1
 17 |       7 | a goods   | Goods are heavy.               |           1
(17 rows)

blog_post_system=# select U1.id P1.id from users U1 join posts P1 on U1.id = P1.user_id where U1.id in (select U.id from users U join posts P on U.id = P.user_id where U.paid = false group by U.id);
ERROR:  syntax error at or near "."
LINE 1: select U1.id P1.id from users U1 join posts P1 on U1.id = P1...
                       ^
blog_post_system=# select U1.id, P1.id from users U1 join posts P1 on U1.id = P1.user_id where U1.id in (select U.id from users U join posts P on U.id = P.user_id where U.paid = false group by U.id);
 id | id 
----+----
  5 |  1
  5 |  2
  1 |  6
(3 rows)

blog_post_system=# select U1.id as user_id, P1.id as post_id from users U1 join posts P1 on U1.id = P1.user_id where U1.id in (select U.id from users U join posts P on U.id = P.user_id where U.paid = false group by U.id);
 user_id | post_id 
---------+---------
       5 |       1
       5 |       2
       1 |       6
(3 rows)

blog_post_system=# 
blog_post_system=# select P1.id from users U1 join posts P1 on U1.id = P1.user_id where U1.id in (select U.id from users U join posts P on U.id = P.user_id where U.paid = false group by U.id);
 id 
----
  1
  2
  6
(3 rows)

blog_post_system=# select count(L2.id) from likes L2 left outer join posts P2 on P2.id = L2.post_id where P2.id in (select P1.id from users U1 join posts P1 on U1.id = P1.user_id where U1.id in (select U.id from users U join posts P on U.id = P.user_id where U.paid = false group by U.id) order by ())
blog_post_system-# 
blog_post_system-# ;
ERROR:  syntax error at or near ")"
LINE 1: ...= P.user_id where U.paid = false group by U.id) order by ())
                                                                     ^
blog_post_system=# 
blog_post_system=# 
blog_post_system=# \c library_managment_system
You are now connected to database "library_managment_system" as user "postgres".
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# \d
                 List of relations
 Schema |        Name         |   Type   |  Owner   
--------+---------------------+----------+----------
 public | books               | table    | postgres
 public | books_id_seq        | sequence | postgres
 public | categories          | table    | postgres
 public | categories_id_seq   | sequence | postgres
 public | employees           | table    | postgres
 public | employees_id_seq    | sequence | postgres
 public | issue               | table    | postgres
 public | issue_books         | table    | postgres
 public | issue_books_id_seq  | sequence | postgres
 public | issue_id_seq        | sequence | postgres
 public | return              | table    | postgres
 public | return_books        | table    | postgres
 public | return_books_id_seq | sequence | postgres
 public | return_id_seq       | sequence | postgres
 public | students            | table    | postgres
 public | students_id_seq     | sequence | postgres
(16 rows)

library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# \d books
                                 Table "public.books"
    Column    |       Type        |                     Modifiers                      
--------------+-------------------+----------------------------------------------------
 id           | integer           | not null default nextval('books_id_seq'::regclass)
 category_id  | integer           | not null
 name         | character varying | not null
 author       | character varying | not null
 publisher    | character varying | not null
 rental_price | integer           | not null
 available    | boolean           | default true
Indexes:
    "books_pkey" PRIMARY KEY, btree (id)
Foreign-key constraints:
    "books_category_id_fkey" FOREIGN KEY (category_id) REFERENCES categories(id)
Referenced by:
    TABLE "issue_books" CONSTRAINT "issue_books_book_id_fkey" FOREIGN KEY (book_id) REFERENCES books(id)
    TABLE "return_books" CONSTRAINT "return_books_book_id_fkey" FOREIGN KEY (book_id) REFERENCES books(id)

library_managment_system=# \d employees
                               Table "public.employees"
 Column  |       Type        |                       Modifiers                        
---------+-------------------+--------------------------------------------------------
 id      | integer           | not null default nextval('employees_id_seq'::regclass)
 name    | character varying | not null
 salary  | money             | not null
 address | character varying | not null
 contact | bigint            | not null
Indexes:
    "employees_pkey" PRIMARY KEY, btree (id)
Referenced by:
    TABLE "issue_books" CONSTRAINT "issue_books_employee_id_fkey" FOREIGN KEY (employee_id) REFERENCES employees(id)
    TABLE "return_books" CONSTRAINT "return_books_employee_id_fkey" FOREIGN KEY (employee_id) REFERENCES employees(id)

library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# insert into categories values (default, 'Art & Music');
ERROR:  null value in column "amount" violates not-null constraint
DETAIL:  Failing row contains (1, Art & Music, null).
library_managment_system=# \d categories;
                              Table "public.categories"
 Column |       Type        |                        Modifiers                        
--------+-------------------+---------------------------------------------------------
 id     | integer           | not null default nextval('categories_id_seq'::regclass)
 name   | character varying | not null
 amount | integer           | not null
Indexes:
    "categories_pkey" PRIMARY KEY, btree (id)
Referenced by:
    TABLE "books" CONSTRAINT "books_category_id_fkey" FOREIGN KEY (category_id) REFERENCES categories(id)

library_managment_system=# insert into categories values (default, 'Art & Music', 100);
INSERT 0 1
library_managment_system=# select * from categories;
 id |    name     | amount 
----+-------------+--------
  2 | Art & Music |    100
(1 row)

library_managment_system=# insert into categories values (default, 'Cooking', 50);
INSERT 0 1
library_managment_system=# select * from categories;
 id |    name     | amount 
----+-------------+--------
  2 | Art & Music |    100
  3 | Cooking     |     50
(2 rows)

library_managment_system=# insert into categories values (default, 'Kids', 70);
INSERT 0 1
library_managment_system=# insert into categories values (default, 'Computers', 20);
INSERT 0 1
library_managment_system=# insert into categories values (default, 'Hobbies', 10);
INSERT 0 1
library_managment_system=# insert into categories values (default, 'Health', 15);
INSERT 0 1
library_managment_system=# insert into categories values (default, 'History', 25);
INSERT 0 1
library_managment_system=# insert into categories values (default, 'Medical', 50);
INSERT 0 1
library_managment_system=# insert into categories values (default, 'Entertainment', 55);
INSERT 0 1
library_managment_system=# insert into categories values (default, 'Religion', 30);
INSERT 0 1
library_managment_system=# insert into categories values (default, 'Sports', 40);
INSERT 0 1
library_managment_system=# insert into categories values (default, 'Romance', 40);
INSERT 0 1
library_managment_system=# insert into categories values (default, 'Travel', 45);
INSERT 0 1
library_managment_system=# insert into categories values (default, 'Social Sciences', 100);
INSERT 0 1
library_managment_system=# select * from categories;
 id |      name       | amount 
----+-----------------+--------
  2 | Art & Music     |    100
  3 | Cooking         |     50
  4 | Kids            |     70
  5 | Computers       |     20
  6 | Hobbies         |     10
  7 | Health          |     15
  8 | History         |     25
  9 | Medical         |     50
 10 | Entertainment   |     55
 11 | Religion        |     30
 12 | Sports          |     40
 13 | Romance         |     40
 14 | Travel          |     45
 15 | Social Sciences |    100
(14 rows)

library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# \d books
                                 Table "public.books"
    Column    |       Type        |                     Modifiers                      
--------------+-------------------+----------------------------------------------------
 id           | integer           | not null default nextval('books_id_seq'::regclass)
 category_id  | integer           | not null
 name         | character varying | not null
 author       | character varying | not null
 publisher    | character varying | not null
 rental_price | integer           | not null
 available    | boolean           | default true
Indexes:
    "books_pkey" PRIMARY KEY, btree (id)
Foreign-key constraints:
    "books_category_id_fkey" FOREIGN KEY (category_id) REFERENCES categories(id)
Referenced by:
    TABLE "issue_books" CONSTRAINT "issue_books_book_id_fkey" FOREIGN KEY (book_id) REFERENCES books(id)
    TABLE "return_books" CONSTRAINT "return_books_book_id_fkey" FOREIGN KEY (book_id) REFERENCES books(id)

library_managment_system=# insert into books values (default, 6, 'Printing', 'H.L', 'P.R', default);
ERROR:  null value in column "rental_price" violates not-null constraint
DETAIL:  Failing row contains (1, 6, Printing, H.L, P.R, null, t).
library_managment_system=# alter table books alter column rental_price type money;
ALTER TABLE
library_managment_system=# \d books
                                 Table "public.books"
    Column    |       Type        |                     Modifiers                      
--------------+-------------------+----------------------------------------------------
 id           | integer           | not null default nextval('books_id_seq'::regclass)
 category_id  | integer           | not null
 name         | character varying | not null
 author       | character varying | not null
 publisher    | character varying | not null
 rental_price | money             | not null
 available    | boolean           | default true
Indexes:
    "books_pkey" PRIMARY KEY, btree (id)
Foreign-key constraints:
    "books_category_id_fkey" FOREIGN KEY (category_id) REFERENCES categories(id)
Referenced by:
    TABLE "issue_books" CONSTRAINT "issue_books_book_id_fkey" FOREIGN KEY (book_id) REFERENCES books(id)
    TABLE "return_books" CONSTRAINT "return_books_book_id_fkey" FOREIGN KEY (book_id) REFERENCES books(id)

library_managment_system=# insert into books values (default, 6, 'Printing', 'H.L', 'P.R', 120, default);
INSERT 0 1
library_managment_system=# insert into books values (default, 6, 'Building', 'H.G.L', 'I.R', 240, default);
INSERT 0 1
library_managment_system=# insert into books values (default, 6, 'Animation', 'J.K.H', 'S.E', 500, default);
INSERT 0 1
library_managment_system=# insert into books values (default, 6, 'Blogging', 'J.H', 'L.K', 300, false);
INSERT 0 1
library_managment_system=# insert into books values (default, 6, 'Coloring', 'H.M', 'L.K.D', 200, false);
INSERT 0 1
library_managment_system=# select * from books;
 id | category_id |   name    | author | publisher | rental_price | available 
----+-------------+-----------+--------+-----------+--------------+-----------
  2 |           6 | Printing  | H.L    | P.R       |      ₹120.00 | t
  3 |           6 | Building  | H.G.L  | I.R       |      ₹240.00 | t
  4 |           6 | Animation | J.K.H  | S.E       |      ₹500.00 | t
  5 |           6 | Blogging  | J.H    | L.K       |      ₹300.00 | f
  6 |           6 | Coloring  | H.M    | L.K.D     |      ₹200.00 | f
(5 rows)

library_managment_system=# insert into books values (default, 5, 'Let Us C', 'E.R.U', 'A.S.D', 330, false);
INSERT 0 1
library_managment_system=# insert into books values (default, 5, 'Data Structures', 'P.U.T', 'A.S.D', 330, false);
INSERT 0 1
library_managment_system=# insert into books values (default, 5, 'Python', 'P.T', 'A.S', 500, default);
INSERT 0 1
library_managment_system=# insert into books values (default, 5, 'Java', 'C.P', 'O.P', 400, default);
INSERT 0 1
library_managment_system=# 
library_managment_system=# insert into books values (default, 5, 'Perl', 'P.M.N', 'O.G', 250, default);
INSERT 0 1
library_managment_system=# insert into books values (default, 10, 'Goddess of Light', 'N.K', 'G.P', 135, default);
INSERT 0 1
library_managment_system=# insert into books values (default, 10, 'Nights at the Cuzco', 'J.N.K', 'G.H.Y', 145, default);
INSERT 0 1
library_managment_system=# insert into books values (default, 2, 'An Animal Dance Book', 'R.T', 'P.K', 145, default);
INSERT 0 1
library_managment_system=# alter table categories drop column ammount;
ERROR:  column "ammount" of relation "categories" does not exist
library_managment_system=# alter table categories drop column amount;
ALTER TABLE
library_managment_system=# 
library_managment_system=# select * from categories;
 id |      name       
----+-----------------
  2 | Art & Music
  3 | Cooking
  4 | Kids
  5 | Computers
  6 | Hobbies
  7 | Health
  8 | History
  9 | Medical
 10 | Entertainment
 11 | Religion
 12 | Sports
 13 | Romance
 14 | Travel
 15 | Social Sciences
(14 rows)

library_managment_system=# insert into books values (default, 3, 'Indian Cooking', 'D.S', 'S.K', 145, default);
INSERT 0 1
library_managment_system=# insert into books values (default, 3, 'American Cooking', 'H.D.S', 'S.S', 245, default);
INSERT 0 1
library_managment_system=# insert into books values (default, 8, 'The Source of Social Power', 'J.K.S', 'G.S.S', 278, default);
INSERT 0 1
library_managment_system=# insert into books values (default, 8, 'Plagues and Peoples', 'J.S', 'G.S', 200, default);
INSERT 0 1
library_managment_system=# insert into books values (default, 8, 'The Contours of American', 'U.S', 'L.S', 200, default);
INSERT 0 1
library_managment_system=# 
library_managment_system=# 
library_managment_system=# select * from books;
 id | category_id |            name            | author | publisher | rental_price | available 
----+-------------+----------------------------+--------+-----------+--------------+-----------
  2 |           6 | Printing                   | H.L    | P.R       |      ₹120.00 | t
  3 |           6 | Building                   | H.G.L  | I.R       |      ₹240.00 | t
  4 |           6 | Animation                  | J.K.H  | S.E       |      ₹500.00 | t
  5 |           6 | Blogging                   | J.H    | L.K       |      ₹300.00 | f
  6 |           6 | Coloring                   | H.M    | L.K.D     |      ₹200.00 | f
  7 |           5 | Let Us C                   | E.R.U  | A.S.D     |      ₹330.00 | f
  8 |           5 | Data Structures            | P.U.T  | A.S.D     |      ₹330.00 | f
  9 |           5 | Python                     | P.T    | A.S       |      ₹500.00 | t
 10 |           5 | Java                       | C.P    | O.P       |      ₹400.00 | t
 11 |           5 | Perl                       | P.M.N  | O.G       |      ₹250.00 | t
 12 |          10 | Goddess of Light           | N.K    | G.P       |      ₹135.00 | t
 13 |          10 | Nights at the Cuzco        | J.N.K  | G.H.Y     |      ₹145.00 | t
 14 |           2 | An Animal Dance Book       | R.T    | P.K       |      ₹145.00 | t
 15 |           3 | Indian Cooking             | D.S    | S.K       |      ₹145.00 | t
 16 |           3 | American Cooking           | H.D.S  | S.S       |      ₹245.00 | t
 17 |           8 | The Source of Social Power | J.K.S  | G.S.S     |      ₹278.00 | t
 18 |           8 | Plagues and Peoples        | J.S    | G.S       |      ₹200.00 | t
 19 |           8 | The Contours of American   | U.S    | L.S       |      ₹200.00 | t
(18 rows)

library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# \d employees;
                               Table "public.employees"
 Column  |       Type        |                       Modifiers                        
---------+-------------------+--------------------------------------------------------
 id      | integer           | not null default nextval('employees_id_seq'::regclass)
 name    | character varying | not null
 salary  | money             | not null
 address | character varying | not null
 contact | bigint            | not null
Indexes:
    "employees_pkey" PRIMARY KEY, btree (id)
Referenced by:
    TABLE "issue_books" CONSTRAINT "issue_books_employee_id_fkey" FOREIGN KEY (employee_id) REFERENCES employees(id)
    TABLE "return_books" CONSTRAINT "return_books_employee_id_fkey" FOREIGN KEY (employee_id) REFERENCES employees(id)

library_managment_system=# select * from employees;
 id |  name  |   salary   | address |  contact   
----+--------+------------+---------+------------
  1 | Pankaj | ₹50,000.00 | Delhi   | 7009147259
  2 | Pankaj | ₹50,000.00 | Delhi   | 7009147259
(2 rows)

library_managment_system=# insert into employees values (default, 'Pavan', 15000, 'Patna', 1489657423);
ERROR:  duplicate key value violates unique constraint "employees_pkey"
DETAIL:  Key (id)=(1) already exists.
library_managment_system=# insert into employees values (default, 'Pavan', 15000, 'Patna', 1489657423);
ERROR:  duplicate key value violates unique constraint "employees_pkey"
DETAIL:  Key (id)=(2) already exists.
library_managment_system=# insert into employees values (default, 'Pavan', 15000, 'Patna', 1489657423);
INSERT 0 1
library_managment_system=# insert into employees values (default, 'Naveen', 35000, 'Pune', 5698741256);
INSERT 0 1
library_managment_system=# insert into employees values (default, 'Praveen', 35000, 'Chandighar', 9857444452);
INSERT 0 1
library_managment_system=# insert into employees values (default, 'Sonu', 25000, 'Haidrabad', 9857444452);
INSERT 0 1
library_managment_system=# select * from employees;
 id |  name   |   salary   |  address   |  contact   
----+---------+------------+------------+------------
  1 | Pankaj  | ₹50,000.00 | Delhi      | 7009147259
  2 | Pankaj  | ₹50,000.00 | Delhi      | 7009147259
  3 | Pavan   | ₹15,000.00 | Patna      | 1489657423
  4 | Naveen  | ₹35,000.00 | Pune       | 5698741256
  5 | Praveen | ₹35,000.00 | Chandighar | 9857444452
  6 | Sonu    | ₹25,000.00 | Haidrabad  | 9857444452
(6 rows)

library_managment_system=# \d issue;
                           Table "public.issue"
   Column   |  Type   |                     Modifiers                      
------------+---------+----------------------------------------------------
 id         | integer | not null default nextval('issue_id_seq'::regclass)
 student_id | integer | not null
 date       | date    | not null
Indexes:
    "issue_pkey" PRIMARY KEY, btree (id)
Foreign-key constraints:
    "issue_student_id_fkey" FOREIGN KEY (student_id) REFERENCES students(id)
Referenced by:
    TABLE "issue_books" CONSTRAINT "issue_books_issue_id_fkey" FOREIGN KEY (issue_id) REFERENCES issue(id)
    TABLE "return_books" CONSTRAINT "return_books_return_id_fkey" FOREIGN KEY (return_id) REFERENCES issue(id)

library_managment_system=# \d students;
                                    Table "public.students"
      Column       |       Type        |                       Modifiers                       
-------------------+-------------------+-------------------------------------------------------
 id                | integer           | not null default nextval('students_id_seq'::regclass)
 name              | character varying | not null
 address           | character varying | not null
 registration_date | date              | not null
Indexes:
    "students_pkey" PRIMARY KEY, btree (id)
Referenced by:
    TABLE "issue" CONSTRAINT "issue_student_id_fkey" FOREIGN KEY (student_id) REFERENCES students(id)
    TABLE "return" CONSTRAINT "return_student_id_fkey" FOREIGN KEY (student_id) REFERENCES students(id)

library_managment_system=# insert into students values (default, 'Chhavi', 'Merath', 2018-11-18);
ERROR:  column "registration_date" is of type date but expression is of type integer
LINE 1: ...nto students values (default, 'Chhavi', 'Merath', 2018-11-18...
                                                             ^
HINT:  You will need to rewrite or cast the expression.
library_managment_system=# insert into students values (default, 'Chhavi', 'Merath', '2018-11-18');
INSERT 0 1
library_managment_system=# 
library_managment_system=# selct * from students;
ERROR:  syntax error at or near "selct"
LINE 1: selct * from students;
        ^
library_managment_system=# select * from students;
 id |  name  | address | registration_date 
----+--------+---------+-------------------
  1 | Chhavi | Merath  | 2018-11-18
(1 row)

library_managment_system=# insert into students values (default, 'Saurabh', 'Delhi', '2017-05-28');
INSERT 0 1
library_managment_system=# insert into students values (default, 'Ashutosh', 'Patna', '2019-07-29');
INSERT 0 1
library_managment_system=# insert into students values (default, 'Amandeep', 'Patiala', '2020-01-01');
INSERT 0 1
library_managment_system=# insert into students values (default, 'Aman', 'Patna', '2015-08-17');
INSERT 0 1
library_managment_system=# insert into students values (default, 'Aman', 'Agra', '2015-08-17');
INSERT 0 1
library_managment_system=# insert into students values (default, 'Gaurabh', 'Haridwar', '2012-12-12');
INSERT 0 1
library_managment_system=# insert into students values (default, 'Avdhesh', 'Gagiabad', '2013-02-12');
INSERT 0 1
library_managment_system=# select * from students;
 id |   name   | address  | registration_date 
----+----------+----------+-------------------
  1 | Chhavi   | Merath   | 2018-11-18
  2 | Saurabh  | Delhi    | 2017-05-28
  3 | Ashutosh | Patna    | 2019-07-29
  4 | Amandeep | Patiala  | 2020-01-01
  5 | Aman     | Patna    | 2015-08-17
  6 | Aman     | Agra     | 2015-08-17
  7 | Gaurabh  | Haridwar | 2012-12-12
  8 | Avdhesh  | Gagiabad | 2013-02-12
(8 rows)

library_managment_system=# insert into students values (default, 'Abhishek', 'Pune', '2012-12-12');
INSERT 0 1
library_managment_system=# insert into students values (default, 'Sandeep', 'Faridabad', '2018-11-22');
INSERT 0 1
library_managment_system=# insert into students values (default, 'Sandeep', 'Faridabad', '2018-11-22');
INSERT 0 1
library_managment_system=# select * from students;
 id |   name   |  address  | registration_date 
----+----------+-----------+-------------------
  1 | Chhavi   | Merath    | 2018-11-18
  2 | Saurabh  | Delhi     | 2017-05-28
  3 | Ashutosh | Patna     | 2019-07-29
  4 | Amandeep | Patiala   | 2020-01-01
  5 | Aman     | Patna     | 2015-08-17
  6 | Aman     | Agra      | 2015-08-17
  7 | Gaurabh  | Haridwar  | 2012-12-12
  8 | Avdhesh  | Gagiabad  | 2013-02-12
  9 | Abhishek | Pune      | 2012-12-12
 10 | Sandeep  | Faridabad | 2018-11-22
 11 | Sandeep  | Faridabad | 2018-11-22
(11 rows)

library_managment_system=# 
library_managment_system=# select* from issue;
 id | student_id | date 
----+------------+------
(0 rows)

library_managment_system=# insert into issue values (default, 2, '2020-01-20');
INSERT 0 1
library_managment_system=# insert into issue values (default, 2, '2020-01-22');
INSERT 0 1
library_managment_system=# insert into issue values (default, 5, '2020-01-21');
INSERT 0 1
library_managment_system=# insert into issue values (default, 5, '2020-02-01');
INSERT 0 1
library_managment_system=# insert into issue values (default, 10, '2020-02-02');
INSERT 0 1
library_managment_system=# insert into issue values (default, 11, '2020-02-03');
INSERT 0 1
library_managment_system=# insert into issue values (default, 9, '2020-02-03');
INSERT 0 1
library_managment_system=# select* from issue;
 id | student_id |    date    
----+------------+------------
  1 |          2 | 2020-01-20
  2 |          2 | 2020-01-22
  3 |          5 | 2020-01-21
  4 |          5 | 2020-02-01
  5 |         10 | 2020-02-02
  6 |         11 | 2020-02-03
  7 |          9 | 2020-02-03
(7 rows)

library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# 
library_managment_system=# \d issue_books
                            Table "public.issue_books"
   Column    |  Type   |                        Modifiers                         
-------------+---------+----------------------------------------------------------
 id          | integer | not null default nextval('issue_books_id_seq'::regclass)
 issue_id    | integer | not null
 book_id     | integer | not null
 employee_id | integer | not null
Indexes:
    "issue_books_pkey" PRIMARY KEY, btree (id)
Foreign-key constraints:
    "issue_books_book_id_fkey" FOREIGN KEY (book_id) REFERENCES books(id)
    "issue_books_employee_id_fkey" FOREIGN KEY (employee_id) REFERENCES employees(id)
    "issue_books_issue_id_fkey" FOREIGN KEY (issue_id) REFERENCES issue(id)

library_managment_system=# insert into issue_books values (default, 1, 5);
ERROR:  null value in column "employee_id" violates not-null constraint
DETAIL:  Failing row contains (1, 1, 5, null).
library_managment_system=# insert into issue_books values (default, 1, 5, 5);
INSERT 0 1
library_managment_system=# insert into issue_books values (default, 1, 6, 5);
INSERT 0 1
library_managment_system=# insert into issue_books values (default, 1, 10, 1);
INSERT 0 1
library_managment_system=# insert into issue_books values (default, 1, 17, 6);
INSERT 0 1
library_managment_system=# 
library_managment_system=# insert into issue_books values (default, 3, 17, 6);
INSERT 0 1
library_managment_system=# insert into issue_books values (default, 3, 10, 6);
INSERT 0 1
library_managment_system=# insert into issue_books values (default, 3, 14, 7);
ERROR:  insert or update on table "issue_books" violates foreign key constraint "issue_books_employee_id_fkey"
DETAIL:  Key (employee_id)=(7) is not present in table "employees".
library_managment_system=# insert into issue_books values (default, 3, 14, 1);
INSERT 0 1
library_managment_system=# select from issue_books;
--
(7 rows)

library_managment_system=# select * from issue_books;
 id | issue_id | book_id | employee_id 
----+----------+---------+-------------
  2 |        1 |       5 |           5
  3 |        1 |       6 |           5
  4 |        1 |      10 |           1
  5 |        1 |      17 |           6
  6 |        3 |      17 |           6
  7 |        3 |      10 |           6
  9 |        3 |      14 |           1
(7 rows)

library_managment_system=# \l
library_managment_system=# 
